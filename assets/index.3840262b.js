var Yn=Object.defineProperty,Xn=Object.defineProperties;var Zn=Object.getOwnPropertyDescriptors;var Tt=Object.getOwnPropertySymbols;var Ge=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable;var We=(r,t,e)=>t in r?Yn(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,I=(r,t)=>{for(var e in t||(t={}))Ge.call(t,e)&&We(r,e,t[e]);if(Tt)for(var e of Tt(t))ze.call(t,e)&&We(r,e,t[e]);return r},T=(r,t)=>Xn(r,Zn(t));var pt=(r,t)=>{var e={};for(var n in r)Ge.call(r,n)&&t.indexOf(n)<0&&(e[n]=r[n]);if(r!=null&&Tt)for(var n of Tt(r))t.indexOf(n)<0&&ze.call(r,n)&&(e[n]=r[n]);return e};const Qn=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function e(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=e(o);fetch(o.href,i)}};Qn();var H=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},z={},xr={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=t;function t(e){var n,o=e.Symbol;if(typeof o=="function")if(o.observable)n=o.observable;else{n=o.for("https://github.com/benlesh/symbol-observable");try{o.observable=n}catch{}}else n="@@observable";return n}})(xr);var to=xr,qe=Object.prototype.toString,Dr=function(t){var e=qe.call(t),n=e==="[object Arguments]";return n||(n=e!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&qe.call(t.callee)==="[object Function]"),n},Mr;if(!Object.keys){var kt=Object.prototype.hasOwnProperty,Ve=Object.prototype.toString,eo=Dr,He=Object.prototype.propertyIsEnumerable,ro=!He.call({toString:null},"toString"),no=He.call(function(){},"prototype"),xt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],re=function(r){var t=r.constructor;return t&&t.prototype===r},oo={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},io=function(){if(typeof window=="undefined")return!1;for(var r in window)try{if(!oo["$"+r]&&kt.call(window,r)&&window[r]!==null&&typeof window[r]=="object")try{re(window[r])}catch{return!0}}catch{return!0}return!1}(),so=function(r){if(typeof window=="undefined"||!io)return re(r);try{return re(r)}catch{return!1}};Mr=function(t){var e=t!==null&&typeof t=="object",n=Ve.call(t)==="[object Function]",o=eo(t),i=e&&Ve.call(t)==="[object String]",s=[];if(!e&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var a=no&&n;if(i&&t.length>0&&!kt.call(t,0))for(var u=0;u<t.length;++u)s.push(String(u));if(o&&t.length>0)for(var c=0;c<t.length;++c)s.push(String(c));else for(var p in t)!(a&&p==="prototype")&&kt.call(t,p)&&s.push(String(p));if(ro)for(var h=so(t),y=0;y<xt.length;++y)!(h&&xt[y]==="constructor")&&kt.call(t,xt[y])&&s.push(xt[y]);return s}}var ao=Mr,uo=Array.prototype.slice,co=Dr,Je=Object.keys,Ft=Je?function(t){return Je(t)}:ao,Ke=Object.keys;Ft.shim=function(){if(Object.keys){var t=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);t||(Object.keys=function(n){return co(n)?Ke(uo.call(n)):Ke(n)})}else Object.keys=Ft;return Object.keys||Ft};var fo=Ft,lo=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),n=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var o=42;t[e]=o;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var i=Object.getOwnPropertySymbols(t);if(i.length!==1||i[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(t,e);if(s.value!==o||s.enumerable!==!0)return!1}return!0},Ye=typeof Symbol!="undefined"&&Symbol,po=lo,ho=function(){return typeof Ye!="function"||typeof Symbol!="function"||typeof Ye("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:po()},Xe={foo:{}},yo=Object,mo=function(){return{__proto__:Xe}.foo===Xe.foo&&!({__proto__:null}instanceof yo)},vo="Function.prototype.bind called on incompatible ",ne=Array.prototype.slice,_o=Object.prototype.toString,go="[object Function]",bo=function(t){var e=this;if(typeof e!="function"||_o.call(e)!==go)throw new TypeError(vo+e);for(var n=ne.call(arguments,1),o,i=function(){if(this instanceof o){var p=e.apply(this,n.concat(ne.call(arguments)));return Object(p)===p?p:this}else return e.apply(t,n.concat(ne.call(arguments)))},s=Math.max(0,e.length-n.length),a=[],u=0;u<s;u++)a.push("$"+u);if(o=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(i),e.prototype){var c=function(){};c.prototype=e.prototype,o.prototype=new c,c.prototype=null}return o},wo=bo,Fr=Function.prototype.bind||wo,So=Fr,$o=So.call(Function.call,Object.prototype.hasOwnProperty),N,bt=SyntaxError,Lr=Function,_t=TypeError,oe=function(r){try{return Lr('"use strict"; return ('+r+").constructor;")()}catch{}},at=Object.getOwnPropertyDescriptor;if(at)try{at({},"")}catch{at=null}var ie=function(){throw new _t},Oo=at?function(){try{return arguments.callee,ie}catch{try{return at(arguments,"callee").get}catch{return ie}}}():ie,ht=ho(),Ao=mo(),M=Object.getPrototypeOf||(Ao?function(r){return r.__proto__}:null),mt={},Eo=typeof Uint8Array=="undefined"||!M?N:M(Uint8Array),ut={"%AggregateError%":typeof AggregateError=="undefined"?N:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?N:ArrayBuffer,"%ArrayIteratorPrototype%":ht&&M?M([][Symbol.iterator]()):N,"%AsyncFromSyncIteratorPrototype%":N,"%AsyncFunction%":mt,"%AsyncGenerator%":mt,"%AsyncGeneratorFunction%":mt,"%AsyncIteratorPrototype%":mt,"%Atomics%":typeof Atomics=="undefined"?N:Atomics,"%BigInt%":typeof BigInt=="undefined"?N:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?N:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?N:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?N:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?N:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?N:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?N:FinalizationRegistry,"%Function%":Lr,"%GeneratorFunction%":mt,"%Int8Array%":typeof Int8Array=="undefined"?N:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?N:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?N:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":ht&&M?M(M([][Symbol.iterator]())):N,"%JSON%":typeof JSON=="object"?JSON:N,"%Map%":typeof Map=="undefined"?N:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!ht||!M?N:M(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?N:Promise,"%Proxy%":typeof Proxy=="undefined"?N:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?N:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?N:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!ht||!M?N:M(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?N:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":ht&&M?M(""[Symbol.iterator]()):N,"%Symbol%":ht?Symbol:N,"%SyntaxError%":bt,"%ThrowTypeError%":Oo,"%TypedArray%":Eo,"%TypeError%":_t,"%Uint8Array%":typeof Uint8Array=="undefined"?N:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?N:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?N:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?N:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?N:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?N:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?N:WeakSet};if(M)try{null.error}catch(r){var Po=M(M(r));ut["%Error.prototype%"]=Po}var No=function r(t){var e;if(t==="%AsyncFunction%")e=oe("async function () {}");else if(t==="%GeneratorFunction%")e=oe("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=oe("async function* () {}");else if(t==="%AsyncGenerator%"){var n=r("%AsyncGeneratorFunction%");n&&(e=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var o=r("%AsyncGenerator%");o&&M&&(e=M(o.prototype))}return ut[t]=e,e},Ze={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},It=Fr,Gt=$o,Co=It.call(Function.call,Array.prototype.concat),Io=It.call(Function.apply,Array.prototype.splice),Qe=It.call(Function.call,String.prototype.replace),zt=It.call(Function.call,String.prototype.slice),jo=It.call(Function.call,RegExp.prototype.exec),To=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,ko=/\\(\\)?/g,xo=function(t){var e=zt(t,0,1),n=zt(t,-1);if(e==="%"&&n!=="%")throw new bt("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&e!=="%")throw new bt("invalid intrinsic syntax, expected opening `%`");var o=[];return Qe(t,To,function(i,s,a,u){o[o.length]=a?Qe(u,ko,"$1"):s||i}),o},Do=function(t,e){var n=t,o;if(Gt(Ze,n)&&(o=Ze[n],n="%"+o[0]+"%"),Gt(ut,n)){var i=ut[n];if(i===mt&&(i=No(n)),typeof i=="undefined"&&!e)throw new _t("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:o,name:n,value:i}}throw new bt("intrinsic "+t+" does not exist!")},Mo=function(t,e){if(typeof t!="string"||t.length===0)throw new _t("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new _t('"allowMissing" argument must be a boolean');if(jo(/^%?[^%]*%?$/,t)===null)throw new bt("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=xo(t),o=n.length>0?n[0]:"",i=Do("%"+o+"%",e),s=i.name,a=i.value,u=!1,c=i.alias;c&&(o=c[0],Io(n,Co([0,1],c)));for(var p=1,h=!0;p<n.length;p+=1){var y=n[p],d=zt(y,0,1),l=zt(y,-1);if((d==='"'||d==="'"||d==="`"||l==='"'||l==="'"||l==="`")&&d!==l)throw new bt("property names with quotes must have matching quotes");if((y==="constructor"||!h)&&(u=!0),o+="."+y,s="%"+o+"%",Gt(ut,s))a=ut[s];else if(a!=null){if(!(y in a)){if(!e)throw new _t("base intrinsic for "+t+" exists, but the property is not available.");return}if(at&&p+1>=n.length){var f=at(a,y);h=!!f,h&&"get"in f&&!("originalValue"in f.get)?a=f.get:a=a[y]}else h=Gt(a,y),a=a[y];h&&!u&&(ut[s]=a)}}return a},Fo=Mo,ge=Fo("%Object.defineProperty%",!0),be=function(){if(ge)try{return ge({},"a",{value:1}),!0}catch{return!1}return!1};be.hasArrayLengthDefineBug=function(){if(!be())return null;try{return ge([],"length",{value:1}).length!==1}catch{return!0}};var Lo=be,Ro=fo,Bo=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",Uo=Object.prototype.toString,Wo=Array.prototype.concat,Rr=Object.defineProperty,Go=function(r){return typeof r=="function"&&Uo.call(r)==="[object Function]"},zo=Lo(),Br=Rr&&zo,qo=function(r,t,e,n){if(t in r){if(n===!0){if(r[t]===e)return}else if(!Go(n)||!n())return}Br?Rr(r,t,{configurable:!0,enumerable:!1,value:e,writable:!0}):r[t]=e},Ur=function(r,t){var e=arguments.length>2?arguments[2]:{},n=Ro(t);Bo&&(n=Wo.call(n,Object.getOwnPropertySymbols(t)));for(var o=0;o<n.length;o+=1)qo(r,n[o],t[n[o]],e[n[o]])};Ur.supportsDescriptors=!!Br;var Wr=Ur,Nt={exports:{}};typeof self!="undefined"?Nt.exports=self:typeof window!="undefined"?Nt.exports=window:Nt.exports=Function("return this")();var Vo=Nt.exports,Gr=function(){return typeof H!="object"||!H||H.Math!==Math||H.Array!==Array?Vo:H},Ho=Wr,Jo=Gr,Ko=function(){var t=Jo();if(Ho.supportsDescriptors){var e=Object.getOwnPropertyDescriptor(t,"globalThis");(!e||e.configurable&&(e.enumerable||!e.writable||globalThis!==t))&&Object.defineProperty(t,"globalThis",{configurable:!0,enumerable:!1,value:t,writable:!0})}else(typeof globalThis!="object"||globalThis!==t)&&(t.globalThis=t);return t},Yo=Wr,Xo=Nt.exports,zr=Gr,Zo=Ko,Qo=zr(),qr=function(){return Qo};Yo(qr,{getPolyfill:zr,implementation:Xo,shim:Zo});var ti=qr,ei=H&&H.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(z,"__esModule",{value:!0});z.NO_IL=je=z.NO=z.MemoryStream=K=z.Stream=void 0;var ri=to,ni=ti,Dt=ri.default(ni.getPolyfill()),_={},je=z.NO=_;function R(){}function Lt(r){for(var t=r.length,e=Array(t),n=0;n<t;++n)e[n]=r[n];return e}function oi(r,t){return function(n){return r(n)&&t(n)}}function Te(r,t,e){try{return r.f(t)}catch(n){return e._e(n),_}}var it={_n:R,_e:R,_c:R};z.NO_IL=it;function tr(r){r._start=function(e){e.next=e._n,e.error=e._e,e.complete=e._c,this.start(e)},r._stop=r.stop}var ii=function(){function r(t,e){this._stream=t,this._listener=e}return r.prototype.unsubscribe=function(){this._stream._remove(this._listener)},r}(),si=function(){function r(t){this._listener=t}return r.prototype.next=function(t){this._listener._n(t)},r.prototype.error=function(t){this._listener._e(t)},r.prototype.complete=function(){this._listener._c()},r}(),ai=function(){function r(t){this.type="fromObservable",this.ins=t,this.active=!1}return r.prototype._start=function(t){this.out=t,this.active=!0,this._sub=this.ins.subscribe(new si(t)),this.active||this._sub.unsubscribe()},r.prototype._stop=function(){this._sub&&this._sub.unsubscribe(),this.active=!1},r}(),ui=function(){function r(t){this.type="merge",this.insArr=t,this.out=_,this.ac=0}return r.prototype._start=function(t){this.out=t;var e=this.insArr,n=e.length;this.ac=n;for(var o=0;o<n;o++)e[o]._add(this)},r.prototype._stop=function(){for(var t=this.insArr,e=t.length,n=0;n<e;n++)t[n]._remove(this);this.out=_},r.prototype._n=function(t){var e=this.out;e!==_&&e._n(t)},r.prototype._e=function(t){var e=this.out;e!==_&&e._e(t)},r.prototype._c=function(){if(--this.ac<=0){var t=this.out;if(t===_)return;t._c()}},r}(),ci=function(){function r(t,e,n){this.i=t,this.out=e,this.p=n,n.ils.push(this)}return r.prototype._n=function(t){var e=this.p,n=this.out;if(n!==_&&e.up(t,this.i)){var o=Lt(e.vals);n._n(o)}},r.prototype._e=function(t){var e=this.out;e!==_&&e._e(t)},r.prototype._c=function(){var t=this.p;t.out!==_&&--t.Nc===0&&t.out._c()},r}(),fi=function(){function r(t){this.type="combine",this.insArr=t,this.out=_,this.ils=[],this.Nc=this.Nn=0,this.vals=[]}return r.prototype.up=function(t,e){var n=this.vals[e],o=this.Nn?n===_?--this.Nn:this.Nn:0;return this.vals[e]=t,o===0},r.prototype._start=function(t){this.out=t;var e=this.insArr,n=this.Nc=this.Nn=e.length,o=this.vals=new Array(n);if(n===0)t._n([]),t._c();else for(var i=0;i<n;i++)o[i]=_,e[i]._add(new ci(i,t,this))},r.prototype._stop=function(){for(var t=this.insArr,e=t.length,n=this.ils,o=0;o<e;o++)t[o]._remove(n[o]);this.out=_,this.ils=[],this.vals=[]},r}(),li=function(){function r(t){this.type="fromArray",this.a=t}return r.prototype._start=function(t){for(var e=this.a,n=0,o=e.length;n<o;n++)t._n(e[n]);t._c()},r.prototype._stop=function(){},r}(),pi=function(){function r(t){this.type="fromPromise",this.on=!1,this.p=t}return r.prototype._start=function(t){var e=this;this.on=!0,this.p.then(function(n){e.on&&(t._n(n),t._c())},function(n){t._e(n)}).then(R,function(n){setTimeout(function(){throw n})})},r.prototype._stop=function(){this.on=!1},r}(),hi=function(){function r(t){this.type="periodic",this.period=t,this.intervalID=-1,this.i=0}return r.prototype._start=function(t){var e=this;function n(){t._n(e.i++)}this.intervalID=setInterval(n,this.period)},r.prototype._stop=function(){this.intervalID!==-1&&clearInterval(this.intervalID),this.intervalID=-1,this.i=0},r}(),di=function(){function r(t,e){this.type="debug",this.ins=t,this.out=_,this.s=R,this.l="",typeof e=="string"?this.l=e:typeof e=="function"&&(this.s=e)}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=_},r.prototype._n=function(t){var e=this.out;if(e!==_){var n=this.s,o=this.l;if(n!==R)try{n(t)}catch(i){e._e(i)}else o?console.log(o+":",t):console.log(t);e._n(t)}},r.prototype._e=function(t){var e=this.out;e!==_&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==_&&t._c()},r}(),yi=function(){function r(t,e){this.type="drop",this.ins=e,this.out=_,this.max=t,this.dropped=0}return r.prototype._start=function(t){this.out=t,this.dropped=0,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=_},r.prototype._n=function(t){var e=this.out;e!==_&&this.dropped++>=this.max&&e._n(t)},r.prototype._e=function(t){var e=this.out;e!==_&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==_&&t._c()},r}(),mi=function(){function r(t,e){this.out=t,this.op=e}return r.prototype._n=function(){this.op.end()},r.prototype._e=function(t){this.out._e(t)},r.prototype._c=function(){this.op.end()},r}(),vi=function(){function r(t,e){this.type="endWhen",this.ins=e,this.out=_,this.o=t,this.oil=it}return r.prototype._start=function(t){this.out=t,this.o._add(this.oil=new mi(t,this)),this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.o._remove(this.oil),this.out=_,this.oil=it},r.prototype.end=function(){var t=this.out;t!==_&&t._c()},r.prototype._n=function(t){var e=this.out;e!==_&&e._n(t)},r.prototype._e=function(t){var e=this.out;e!==_&&e._e(t)},r.prototype._c=function(){this.end()},r}(),se=function(){function r(t,e){this.type="filter",this.ins=e,this.out=_,this.f=t}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=_},r.prototype._n=function(t){var e=this.out;if(e!==_){var n=Te(this,t,e);n===_||!n||e._n(t)}},r.prototype._e=function(t){var e=this.out;e!==_&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==_&&t._c()},r}(),_i=function(){function r(t,e){this.out=t,this.op=e}return r.prototype._n=function(t){this.out._n(t)},r.prototype._e=function(t){this.out._e(t)},r.prototype._c=function(){this.op.inner=_,this.op.less()},r}(),gi=function(){function r(t){this.type="flatten",this.ins=t,this.out=_,this.open=!0,this.inner=_,this.il=it}return r.prototype._start=function(t){this.out=t,this.open=!0,this.inner=_,this.il=it,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.inner!==_&&this.inner._remove(this.il),this.out=_,this.open=!0,this.inner=_,this.il=it},r.prototype.less=function(){var t=this.out;t!==_&&!this.open&&this.inner===_&&t._c()},r.prototype._n=function(t){var e=this.out;if(e!==_){var n=this,o=n.inner,i=n.il;o!==_&&i!==it&&o._remove(i),(this.inner=t)._add(this.il=new _i(e,this))}},r.prototype._e=function(t){var e=this.out;e!==_&&e._e(t)},r.prototype._c=function(){this.open=!1,this.less()},r}(),bi=function(){function r(t,e,n){var o=this;this.type="fold",this.ins=n,this.out=_,this.f=function(i){return t(o.acc,i)},this.acc=this.seed=e}return r.prototype._start=function(t){this.out=t,this.acc=this.seed,t._n(this.acc),this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=_,this.acc=this.seed},r.prototype._n=function(t){var e=this.out;if(e!==_){var n=Te(this,t,e);n!==_&&e._n(this.acc=n)}},r.prototype._e=function(t){var e=this.out;e!==_&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==_&&t._c()},r}(),wi=function(){function r(t){this.type="last",this.ins=t,this.out=_,this.has=!1,this.val=_}return r.prototype._start=function(t){this.out=t,this.has=!1,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=_,this.val=_},r.prototype._n=function(t){this.has=!0,this.val=t},r.prototype._e=function(t){var e=this.out;e!==_&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==_&&(this.has?(t._n(this.val),t._c()):t._e(new Error("last() failed because input stream completed")))},r}(),Si=function(){function r(t,e){this.type="map",this.ins=e,this.out=_,this.f=t}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=_},r.prototype._n=function(t){var e=this.out;if(e!==_){var n=Te(this,t,e);n!==_&&e._n(n)}},r.prototype._e=function(t){var e=this.out;e!==_&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==_&&t._c()},r}(),$i=function(){function r(t){this.type="remember",this.ins=t,this.out=_}return r.prototype._start=function(t){this.out=t,this.ins._add(t)},r.prototype._stop=function(){this.ins._remove(this.out),this.out=_},r}(),Oi=function(){function r(t,e){this.type="replaceError",this.ins=e,this.out=_,this.f=t}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=_},r.prototype._n=function(t){var e=this.out;e!==_&&e._n(t)},r.prototype._e=function(t){var e=this.out;if(e!==_)try{this.ins._remove(this),(this.ins=this.f(t))._add(this)}catch(n){e._e(n)}},r.prototype._c=function(){var t=this.out;t!==_&&t._c()},r}(),Ai=function(){function r(t,e){this.type="startWith",this.ins=t,this.out=_,this.val=e}return r.prototype._start=function(t){this.out=t,this.out._n(this.val),this.ins._add(t)},r.prototype._stop=function(){this.ins._remove(this.out),this.out=_},r}(),Ei=function(){function r(t,e){this.type="take",this.ins=e,this.out=_,this.max=t,this.taken=0}return r.prototype._start=function(t){this.out=t,this.taken=0,this.max<=0?t._c():this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=_},r.prototype._n=function(t){var e=this.out;if(e!==_){var n=++this.taken;n<this.max?e._n(t):n===this.max&&(e._n(t),e._c())}},r.prototype._e=function(t){var e=this.out;e!==_&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==_&&t._c()},r}(),ke=function(){function r(t){this._prod=t||_,this._ils=[],this._stopID=_,this._dl=_,this._d=!1,this._target=null,this._err=_}return r.prototype._n=function(t){var e=this._ils,n=e.length;if(this._d&&this._dl._n(t),n==1)e[0]._n(t);else{if(n==0)return;for(var o=Lt(e),i=0;i<n;i++)o[i]._n(t)}},r.prototype._e=function(t){if(this._err===_){this._err=t;var e=this._ils,n=e.length;if(this._x(),this._d&&this._dl._e(t),n==1)e[0]._e(t);else{if(n==0)return;for(var o=Lt(e),i=0;i<n;i++)o[i]._e(t)}if(!this._d&&n==0)throw this._err}},r.prototype._c=function(){var t=this._ils,e=t.length;if(this._x(),this._d&&this._dl._c(),e==1)t[0]._c();else{if(e==0)return;for(var n=Lt(t),o=0;o<e;o++)n[o]._c()}},r.prototype._x=function(){this._ils.length!==0&&(this._prod!==_&&this._prod._stop(),this._err=_,this._ils=[])},r.prototype._stopNow=function(){this._prod._stop(),this._err=_,this._stopID=_},r.prototype._add=function(t){var e=this._target;if(e)return e._add(t);var n=this._ils;if(n.push(t),!(n.length>1))if(this._stopID!==_)clearTimeout(this._stopID),this._stopID=_;else{var o=this._prod;o!==_&&o._start(this)}},r.prototype._remove=function(t){var e=this,n=this._target;if(n)return n._remove(t);var o=this._ils,i=o.indexOf(t);i>-1&&(o.splice(i,1),this._prod!==_&&o.length<=0?(this._err=_,this._stopID=setTimeout(function(){return e._stopNow()})):o.length===1&&this._pruneCycles())},r.prototype._pruneCycles=function(){this._hasNoSinks(this,[])&&this._remove(this._ils[0])},r.prototype._hasNoSinks=function(t,e){if(e.indexOf(t)!==-1)return!0;if(t.out===this)return!0;if(t.out&&t.out!==_)return this._hasNoSinks(t.out,e.concat(t));if(t._ils){for(var n=0,o=t._ils.length;n<o;n++)if(!this._hasNoSinks(t._ils[n],e.concat(t)))return!1;return!0}else return!1},r.prototype.ctor=function(){return this instanceof X?X:r},r.prototype.addListener=function(t){t._n=t.next||R,t._e=t.error||R,t._c=t.complete||R,this._add(t)},r.prototype.removeListener=function(t){this._remove(t)},r.prototype.subscribe=function(t){return this.addListener(t),new ii(this,t)},r.prototype[Dt]=function(){return this},r.create=function(t){if(t){if(typeof t.start!="function"||typeof t.stop!="function")throw new Error("producer requires both start and stop functions");tr(t)}return new r(t)},r.createWithMemory=function(t){return t&&tr(t),new X(t)},r.never=function(){return new r({_start:R,_stop:R})},r.empty=function(){return new r({_start:function(t){t._c()},_stop:R})},r.throw=function(t){return new r({_start:function(e){e._e(t)},_stop:R})},r.from=function(t){if(typeof t[Dt]=="function")return r.fromObservable(t);if(typeof t.then=="function")return r.fromPromise(t);if(Array.isArray(t))return r.fromArray(t);throw new TypeError("Type of input to from() must be an Array, Promise, or Observable")},r.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r.fromArray(t)},r.fromArray=function(t){return new r(new li(t))},r.fromPromise=function(t){return new r(new pi(t))},r.fromObservable=function(t){if(t.endWhen!==void 0)return t;var e=typeof t[Dt]=="function"?t[Dt]():t;return new r(new ai(e))},r.periodic=function(t){return new r(new hi(t))},r.prototype._map=function(t){return new(this.ctor())(new Si(t,this))},r.prototype.map=function(t){return this._map(t)},r.prototype.mapTo=function(t){var e=this.map(function(){return t}),n=e._prod;return n.type="mapTo",e},r.prototype.filter=function(t){var e=this._prod;return e instanceof se?new r(new se(oi(e.f,t),e.ins)):new r(new se(t,this))},r.prototype.take=function(t){return new(this.ctor())(new Ei(t,this))},r.prototype.drop=function(t){return new r(new yi(t,this))},r.prototype.last=function(){return new r(new wi(this))},r.prototype.startWith=function(t){return new X(new Ai(this,t))},r.prototype.endWhen=function(t){return new(this.ctor())(new vi(t,this))},r.prototype.fold=function(t,e){return new X(new bi(t,e,this))},r.prototype.replaceError=function(t){return new(this.ctor())(new Oi(t,this))},r.prototype.flatten=function(){return new r(new gi(this))},r.prototype.compose=function(t){return t(this)},r.prototype.remember=function(){return new X(new $i(this))},r.prototype.debug=function(t){return new(this.ctor())(new di(this,t))},r.prototype.imitate=function(t){if(t instanceof X)throw new Error("A MemoryStream was given to imitate(), but it only supports a Stream. Read more about this restriction here: https://github.com/staltz/xstream#faq");this._target=t;for(var e=this._ils,n=e.length,o=0;o<n;o++)t._add(e[o]);this._ils=[]},r.prototype.shamefullySendNext=function(t){this._n(t)},r.prototype.shamefullySendError=function(t){this._e(t)},r.prototype.shamefullySendComplete=function(){this._c()},r.prototype.setDebugListener=function(t){t?(this._d=!0,t._n=t.next||R,t._e=t.error||R,t._c=t.complete||R,this._dl=t):(this._d=!1,this._dl=_)},r.merge=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new r(new ui(e))},r.combine=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new r(new fi(e))},r}(),K=z.Stream=ke,X=function(r){ei(t,r);function t(e){var n=r.call(this,e)||this;return n._has=!1,n}return t.prototype._n=function(e){this._v=e,this._has=!0,r.prototype._n.call(this,e)},t.prototype._add=function(e){var n=this._target;if(n)return n._add(e);var o=this._ils;if(o.push(e),o.length>1){this._has&&e._n(this._v);return}if(this._stopID!==_)this._has&&e._n(this._v),clearTimeout(this._stopID),this._stopID=_;else if(this._has)e._n(this._v);else{var i=this._prod;i!==_&&i._start(this)}},t.prototype._stopNow=function(){this._has=!1,r.prototype._stopNow.call(this)},t.prototype._x=function(){this._has=!1,r.prototype._x.call(this)},t.prototype.map=function(e){return this._map(e)},t.prototype.mapTo=function(e){return r.prototype.mapTo.call(this,e)},t.prototype.take=function(e){return r.prototype.take.call(this,e)},t.prototype.endWhen=function(e){return r.prototype.endWhen.call(this,e)},t.prototype.replaceError=function(e){return r.prototype.replaceError.call(this,e)},t.prototype.remember=function(){return this},t.prototype.debug=function(e){return r.prototype.debug.call(this,e)},t}(ke);z.MemoryStream=X;var Pi=ke,$=z.default=Pi,xe={};Object.defineProperty(xe,"__esModule",{value:!0});function Vr(){var r;return typeof window!="undefined"?r=window:typeof H!="undefined"?r=H:r=this,r.Cyclejs=r.Cyclejs||{},r=r.Cyclejs,r.adaptStream=r.adaptStream||function(t){return t},r}function Ni(r){Vr().adaptStream=r}xe.setAdapt=Ni;function Ci(r){return Vr().adaptStream(r)}var q=xe.adapt=Ci;function Ii(r,t){if(typeof r!="function")throw new Error("First argument given to isolate() must be a 'dataflowComponent' function");if(t===null)throw new Error("Second argument given to isolate() must not be null")}function ji(r,t,e){var n={};return Object.keys(r).forEach(function(o){if(typeof t=="string"){n[o]=t;return}var i=t[o];if(typeof i!="undefined"){n[o]=i;return}var s=t["*"];if(typeof s!="undefined"){n[o]=s;return}n[o]=e}),n}function Ti(r,t){var e={};for(var n in r){var o=r[n];r.hasOwnProperty(n)&&o&&t[n]!==null&&typeof o.isolateSource=="function"?e[n]=o.isolateSource(o,t[n]):r.hasOwnProperty(n)&&(e[n]=r[n])}return e}function ki(r,t,e){var n={};for(var o in t){var i=r[o],s=t[o];t.hasOwnProperty(o)&&i&&e[o]!==null&&typeof i.isolateSink=="function"?n[o]=q(i.isolateSink($.fromObservable(s),e[o])):t.hasOwnProperty(o)&&(n[o]=t[o])}return n}var Hr=0;function er(){return"cycle"+ ++Hr}function rt(r,t){t===void 0&&(t=er()),Ii(r,t);var e=typeof t=="object"?er():"",n=typeof t=="string"||typeof t=="object"?t:t.toString();return function(i){for(var s=[],a=1;a<arguments.length;a++)s[a-1]=arguments[a];var u=ji(i,n,e),c=Ti(i,u),p=r.apply(void 0,[c].concat(s)),h=ki(i,p,u);return h}}rt.reset=function(){return Hr=0};var Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.DropRepeatsOperator=void 0;var xi=z,ae={},Jr=function(){function r(t,e){this.ins=t,this.type="dropRepeats",this.out=null,this.v=ae,this.isEq=e||function(n,o){return n===o}}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=null,this.v=ae},r.prototype._n=function(t){var e=this.out;if(!!e){var n=this.v;n!==ae&&this.isEq(t,n)||(this.v=t,e._n(t))}},r.prototype._e=function(t){var e=this.out;!e||e._e(t)},r.prototype._c=function(){var t=this.out;!t||t._c()},r}();Zt.DropRepeatsOperator=Jr;function Di(r){return r===void 0&&(r=void 0),function(e){return new xi.Stream(new Jr(e,r))}}var Mi=Zt.default=Di,we=globalThis&&globalThis.__assign||function(){return we=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},we.apply(this,arguments)};function Fi(r,t,e){if(e===r[t])return r;var n=parseInt(t);return typeof e=="undefined"?r.filter(function(o,i){return i!==n}):r.map(function(o,i){return i===n?e:o})}function Kr(r){return typeof r=="string"||typeof r=="number"?function(e){if(typeof e!="undefined")return e[r]}:r.get}function Li(r){return typeof r=="string"||typeof r=="number"?function(e,n){var o,i;return Array.isArray(e)?Fi(e,r,n):typeof e=="undefined"?(o={},o[r]=n,o):we({},e,(i={},i[r]=n,i))}:r.set}function Ri(r,t){return r.select(t)}function Bi(r,t){var e=Kr(t),n=Li(t);return r.map(function(o){return function(s){var a=e(s),u=o(a);return a===u?s:n(s,u)}})}var At=function(){function r(t,e){this.isolateSource=Ri,this.isolateSink=Bi,this._stream=t.filter(function(n){return typeof n!="undefined"}).compose(Mi()).remember(),this._name=e,this.stream=q(this._stream),this._stream._isCycleSource=e}return r.prototype.select=function(t){var e=Kr(t);return new r(this._stream.map(e),this._name)},r}(),Ui=function(){function r(t,e,n){this.ins=n,this.out=t,this.p=e}return r.prototype._n=function(t){this.p;var e=this.out;e!==null&&e._n(t)},r.prototype._e=function(t){var e=this.out;e!==null&&e._e(t)},r.prototype._c=function(){},r}(),Wi=function(){function r(t,e){this.type="pickMerge",this.ins=e,this.out=null,this.sel=t,this.ils=new Map,this.inst=null}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this);var t=this.ils;t.forEach(function(e,n){e.ins._remove(e),e.ins=null,e.out=null,t.delete(n)}),t.clear(),this.out=null,this.ils=new Map,this.inst=null},r.prototype._n=function(t){this.inst=t;for(var e=t.arr,n=this.ils,o=this.out,i=this.sel,s=e.length,a=0;a<s;++a){var u=e[a],c=u._key,p=$.fromObservable(u[i]||$.never());n.has(c)||(n.set(c,new Ui(o,this,p)),p._add(n.get(c)))}n.forEach(function(h,y){(!t.dict.has(y)||!t.dict.get(y))&&(h.ins._remove(h),h.ins=null,h.out=null,n.delete(y))})},r.prototype._e=function(t){var e=this.out;e!==null&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==null&&t._c()},r}();function Gi(r){return function(e){return new K(new Wi(r,e))}}var zi=function(){function r(t,e,n,o){this.key=t,this.out=e,this.p=n,this.val=je,this.ins=o}return r.prototype._n=function(t){this.p;var e=this.out;this.val=t,e!==null&&this.p.up()},r.prototype._e=function(t){var e=this.out;e!==null&&e._e(t)},r.prototype._c=function(){},r}(),qi=function(){function r(t,e){this.type="combine",this.ins=e,this.sel=t,this.out=null,this.ils=new Map,this.inst=null}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this);var t=this.ils;t.forEach(function(e){e.ins._remove(e),e.ins=null,e.out=null,e.val=null}),t.clear(),this.out=null,this.ils=new Map,this.inst=null},r.prototype.up=function(){for(var t=this.inst.arr,e=t.length,n=this.ils,o=Array(e),i=0;i<e;++i){var s=t[i],a=s._key;if(!n.has(a))return;var u=n.get(a).val;if(u===je)return;o[i]=u}this.out._n(o)},r.prototype._n=function(t){this.inst=t;var e=t.arr,n=this.ils,o=this.out,i=this.sel,s=t.dict,a=e.length,u=!1;if(n.forEach(function(d,l){s.has(l)||(d.ins._remove(d),d.ins=null,d.out=null,d.val=null,n.delete(l),u=!0)}),a===0){o._n([]);return}for(var c=0;c<a;++c){var p=e[c],h=p._key;if(!p[i])throw new Error("pickCombine found an undefined child sink stream");var y=$.fromObservable(p[i]);n.has(h)||(n.set(h,new zi(h,o,this,y)),y._add(n.get(h)))}u&&this.up()},r.prototype._e=function(t){var e=this.out;e!==null&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==null&&t._c()},r}();function Vi(r){return function(e){return new K(new qi(r,e))}}var qt=globalThis&&globalThis.__assign||function(){return qt=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},qt.apply(this,arguments)},Hi=function(){function r(t){this._instances$=t}return r.prototype.pickMerge=function(t){return q(this._instances$.compose(Gi(t)))},r.prototype.pickCombine=function(t){return q(this._instances$.compose(Vi(t)))},r}();function Ji(r){return{"*":null}}function Ki(r,t){return{get:function(e){if(typeof e!="undefined"){for(var n=0,o=e.length;n<o;++n)if(""+r(e[n],n)===t)return e[n];return}},set:function(e,n){return typeof e=="undefined"?[n]:typeof n=="undefined"?e.filter(function(o,i){return""+r(o,i)!==t}):e.map(function(o,i){return""+r(o,i)===t?n:o})}}}var Yi={get:function(r){return r},set:function(r,t){return t}};function Xi(r){return function(e){var n=r.channel||"state",o=r.itemKey,i=r.itemScope||Ji,s=$.fromObservable(e[n].stream),a=s.fold(function(u,c){var p,h,y,d,l=u.dict;if(Array.isArray(c)){for(var f=Array(c.length),m=new Set,v=0,b=c.length;v<b;++v){var w=""+(o?o(c[v],v):v);if(m.add(w),l.has(w))f[v]=l.get(w);else{var S=o?Ki(o,w):""+v,O=i(w),A=typeof O=="string"?(p={"*":O},p[n]=S,p):qt({},O,(h={},h[n]=S,h)),E=r.itemFactory?r.itemFactory(c[v],v):r.item,P=rt(E,A)(e);l.set(w,P),f[v]=P}f[v]._key=w}return l.forEach(function(j,x){m.has(x)||l.delete(x)}),m.clear(),{dict:l,arr:f}}else{l.clear();var w=""+(o?o(c,0):"this"),S=Yi,O=i(w),A=typeof O=="string"?(y={"*":O},y[n]=S,y):qt({},O,(d={},d[n]=S,d)),E=r.itemFactory?r.itemFactory(c,0):r.item,P=rt(E,A)(e);return l.set(w,P),{dict:l,arr:[P]}}},{dict:new Map,arr:[]});return r.collectSinks(new Hi(a))}}var Yr={};Object.defineProperty(Yr,"__esModule",{value:!0});var Zi=z,Qi=function(){function r(t){this.streams=t,this.type="concat",this.out=null,this.i=0}return r.prototype._start=function(t){this.out=t,this.streams[this.i]._add(this)},r.prototype._stop=function(){var t=this.streams;this.i<t.length&&t[this.i]._remove(this),this.i=0,this.out=null},r.prototype._n=function(t){var e=this.out;!e||e._n(t)},r.prototype._e=function(t){var e=this.out;!e||e._e(t)},r.prototype._c=function(){var t=this.out;if(!!t){var e=this.streams;e[this.i]._remove(this),++this.i<e.length?e[this.i]._add(this):t._c()}},r}();function ts(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return new Zi.Stream(new Qi(r))}var Xr=Yr.default=ts,Zr={};Object.defineProperty(Zr,"__esModule",{value:!0});function es(){return typeof queueMicrotask!="undefined"?queueMicrotask:typeof setImmediate!="undefined"?setImmediate:typeof process!="undefined"?process.nextTick:setTimeout}var Qr=Zr.default=es,ue=Qr();function rs(r,t){return t===void 0&&(t="state"),function(n){var o=$.create(),i=o.fold(function(c,p){return p(c)},void 0).drop(1),s=n;s[t]=new At(i,t);var a=r(s);if(a[t]){var u=Xr($.fromObservable(a[t]),$.never());u.subscribe({next:function(c){return ue(function(){return o._n(c)})},error:function(c){return ue(function(){return o._e(c)})},complete:function(){return ue(function(){return o._c()})}})}return a}}function ns(){var r;return typeof window!="undefined"?r=window:typeof global!="undefined"?r=global:r=this,r.Cyclejs=r.Cyclejs||{},r=r.Cyclejs,r.adaptStream=r.adaptStream||function(t){return t},r}function os(r){return ns().adaptStream(r)}function is(r){var t={};for(var e in r)r.hasOwnProperty(e)&&(t[e]=$.create());return t}function ss(r,t){var e={};for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n](t[n],n),e[n]&&typeof e[n]=="object"&&(e[n]._isCycleSource=n));return e}function as(r){for(var t in r)r.hasOwnProperty(t)&&r[t]&&typeof r[t].shamefullySendNext=="function"&&(r[t]=os(r[t]));return r}function us(r,t){var e=Qr(),n=Object.keys(r).filter(function(a){return!!t[a]}),o={},i={};n.forEach(function(a){o[a]={_n:[],_e:[]},i[a]={next:function(u){return o[a]._n.push(u)},error:function(u){return o[a]._e.push(u)},complete:function(){}}});var s=n.map(function(a){return $.fromObservable(r[a]).subscribe(i[a])});return n.forEach(function(a){var u=t[a],c=function(h){e(function(){return u._n(h)})},p=function(h){e(function(){(console.error||console.log)(h),u._e(h)})};o[a]._n.forEach(c),o[a]._e.forEach(p),i[a].next=c,i[a].error=p,i[a]._n=c,i[a]._e=p}),o=null,function(){s.forEach(function(u){return u.unsubscribe()})}}function cs(r){Object.keys(r).forEach(function(t){return r[t]._c()})}function fs(r){for(var t in r)r.hasOwnProperty(t)&&r[t]&&r[t].dispose&&r[t].dispose()}function tn(r){return Object.keys(r).length===0}function ls(r,t){if(typeof r!="function")throw new Error("First argument given to Cycle must be the 'main' function.");if(typeof t!="object"||t===null)throw new Error("Second argument given to Cycle must be an object with driver functions as properties.");if(tn(t))throw new Error("Second argument given to Cycle must be an object with at least one driver function declared as a property.");var e=ps(t),n=r(e.sources);typeof window!="undefined"&&(window.Cyclejs=window.Cyclejs||{},window.Cyclejs.sinks=n);function o(){var i=e.run(n);return function(){i(),e.dispose()}}return{sinks:n,sources:e.sources,run:o}}function ps(r){if(typeof r!="object"||r===null)throw new Error("Argument given to setupReusable must be an object with driver functions as properties.");if(tn(r))throw new Error("Argument given to setupReusable must be an object with at least one driver function declared as a property.");var t=is(r),e=ss(r,t),n=as(e);function o(s){return us(s,t)}function i(){fs(n),cs(t)}return{sources:n,run:o,dispose:i}}function hs(r,t){var e=ls(r,t);return typeof window!="undefined"&&window.CyclejsDevTool_startGraphSerializer&&window.CyclejsDevTool_startGraphSerializer(e.sinks),e.run()}function ds(r,t){return document.createElement(r,t)}function ys(r,t,e){return document.createElementNS(r,t,e)}function ms(){return ct(document.createDocumentFragment())}function vs(r){return document.createTextNode(r)}function _s(r){return document.createComment(r)}function gs(r,t,e){if(Y(r)){let n=r;for(;n&&Y(n);)n=ct(n).parent;r=n!=null?n:r}Y(t)&&(t=ct(t,r)),e&&Y(e)&&(e=ct(e).firstChildNode),r.insertBefore(t,e)}function bs(r,t){r.removeChild(t)}function ws(r,t){Y(t)&&(t=ct(t,r)),r.appendChild(t)}function en(r){if(Y(r)){for(;r&&Y(r);)r=ct(r).parent;return r!=null?r:null}return r.parentNode}function Ss(r){var t;if(Y(r)){const e=ct(r),n=en(e);if(n&&e.lastChildNode){const o=Array.from(n.childNodes),i=o.indexOf(e.lastChildNode);return(t=o[i+1])!==null&&t!==void 0?t:null}return null}return r.nextSibling}function $s(r){return r.tagName}function Os(r,t){r.textContent=t}function As(r){return r.textContent}function Es(r){return r.nodeType===1}function Ps(r){return r.nodeType===3}function Ns(r){return r.nodeType===8}function Y(r){return r.nodeType===11}function ct(r,t){var e,n,o;const i=r;return(e=i.parent)!==null&&e!==void 0||(i.parent=t!=null?t:null),(n=i.firstChildNode)!==null&&n!==void 0||(i.firstChildNode=r.firstChild),(o=i.lastChildNode)!==null&&o!==void 0||(i.lastChildNode=r.lastChild),i}const rn={createElement:ds,createElementNS:ys,createTextNode:vs,createDocumentFragment:ms,createComment:_s,insertBefore:gs,removeChild:bs,appendChild:ws,parentNode:en,nextSibling:Ss,tagName:$s,setTextContent:Os,getTextContent:As,isElement:Es,isText:Ps,isComment:Ns,isDocumentFragment:Y};function J(r,t,e,n,o){const i=t===void 0?void 0:t.key;return{sel:r,data:t,children:e,text:n,elm:o,key:i}}const Se=Array.isArray;function Rt(r){return typeof r=="string"||typeof r=="number"||r instanceof String||r instanceof Number}function ce(r){return r===void 0}function G(r){return r!==void 0}const fe=J("",{},[],void 0,void 0);function Ot(r,t){var e,n;const o=r.key===t.key,i=((e=r.data)===null||e===void 0?void 0:e.is)===((n=t.data)===null||n===void 0?void 0:n.is),s=r.sel===t.sel,a=!r.sel&&r.sel===t.sel?typeof r.text==typeof t.text:!0;return s&&o&&i&&a}function Cs(){throw new Error("The document fragment is not supported on this platform.")}function Is(r,t){return r.isElement(t)}function js(r,t){return r.isDocumentFragment(t)}function Ts(r,t,e){var n;const o={};for(let i=t;i<=e;++i){const s=(n=r[i])===null||n===void 0?void 0:n.key;s!==void 0&&(o[s]=i)}return o}const ks=["create","update","remove","destroy","pre","post"];function xs(r,t,e){const n={create:[],update:[],remove:[],destroy:[],pre:[],post:[]},o=t!==void 0?t:rn;for(const l of ks)for(const f of r){const m=f[l];m!==void 0&&n[l].push(m)}function i(l){const f=l.id?"#"+l.id:"",m=l.getAttribute("class"),v=m?"."+m.split(" ").join("."):"";return J(o.tagName(l).toLowerCase()+f+v,{},[],void 0,l)}function s(l){return J(void 0,{},[],void 0,l)}function a(l,f){return function(){if(--f===0){const v=o.parentNode(l);o.removeChild(v,l)}}}function u(l,f){var m,v,b,w;let S,O=l.data;if(O!==void 0){const P=(m=O.hook)===null||m===void 0?void 0:m.init;G(P)&&(P(l),O=l.data)}const A=l.children,E=l.sel;if(E==="!")ce(l.text)&&(l.text=""),l.elm=o.createComment(l.text);else if(E!==void 0){const P=E.indexOf("#"),j=E.indexOf(".",P),x=P>0?P:E.length,k=j>0?j:E.length,D=P!==-1||j!==-1?E.slice(0,Math.min(x,k)):E,W=l.elm=G(O)&&G(S=O.ns)?o.createElementNS(S,D,O):o.createElement(D,O);for(x<k&&W.setAttribute("id",E.slice(x+1,k)),j>0&&W.setAttribute("class",E.slice(k+1).replace(/\./g," ")),S=0;S<n.create.length;++S)n.create[S](fe,l);if(Se(A))for(S=0;S<A.length;++S){const te=A[S];te!=null&&o.appendChild(W,u(te,f))}else Rt(l.text)&&o.appendChild(W,o.createTextNode(l.text));const nt=l.data.hook;G(nt)&&((v=nt.create)===null||v===void 0||v.call(nt,fe,l),nt.insert&&f.push(l))}else if(((b=e==null?void 0:e.experimental)===null||b===void 0?void 0:b.fragments)&&l.children){for(l.elm=((w=o.createDocumentFragment)!==null&&w!==void 0?w:Cs)(),S=0;S<n.create.length;++S)n.create[S](fe,l);for(S=0;S<l.children.length;++S){const P=l.children[S];P!=null&&o.appendChild(l.elm,u(P,f))}}else l.elm=o.createTextNode(l.text);return l.elm}function c(l,f,m,v,b,w){for(;v<=b;++v){const S=m[v];S!=null&&o.insertBefore(l,u(S,w),f)}}function p(l){var f,m;const v=l.data;if(v!==void 0){(m=(f=v==null?void 0:v.hook)===null||f===void 0?void 0:f.destroy)===null||m===void 0||m.call(f,l);for(let b=0;b<n.destroy.length;++b)n.destroy[b](l);if(l.children!==void 0)for(let b=0;b<l.children.length;++b){const w=l.children[b];w!=null&&typeof w!="string"&&p(w)}}}function h(l,f,m,v){for(var b,w;m<=v;++m){let S,O;const A=f[m];if(A!=null)if(G(A.sel)){p(A),S=n.remove.length+1,O=a(A.elm,S);for(let P=0;P<n.remove.length;++P)n.remove[P](A,O);const E=(w=(b=A==null?void 0:A.data)===null||b===void 0?void 0:b.hook)===null||w===void 0?void 0:w.remove;G(E)?E(A,O):O()}else A.children?(p(A),h(l,A.children,0,A.children.length-1)):o.removeChild(l,A.elm)}}function y(l,f,m,v){let b=0,w=0,S=f.length-1,O=f[0],A=f[S],E=m.length-1,P=m[0],j=m[E],x,k,D,W;for(;b<=S&&w<=E;)O==null?O=f[++b]:A==null?A=f[--S]:P==null?P=m[++w]:j==null?j=m[--E]:Ot(O,P)?(d(O,P,v),O=f[++b],P=m[++w]):Ot(A,j)?(d(A,j,v),A=f[--S],j=m[--E]):Ot(O,j)?(d(O,j,v),o.insertBefore(l,O.elm,o.nextSibling(A.elm)),O=f[++b],j=m[--E]):Ot(A,P)?(d(A,P,v),o.insertBefore(l,A.elm,O.elm),A=f[--S],P=m[++w]):(x===void 0&&(x=Ts(f,b,S)),k=x[P.key],ce(k)?o.insertBefore(l,u(P,v),O.elm):(D=f[k],D.sel!==P.sel?o.insertBefore(l,u(P,v),O.elm):(d(D,P,v),f[k]=void 0,o.insertBefore(l,D.elm,O.elm))),P=m[++w]);w<=E&&(W=m[E+1]==null?null:m[E+1].elm,c(l,W,m,w,E,v)),b<=S&&h(l,f,b,S)}function d(l,f,m){var v,b,w,S,O,A,E,P;const j=(v=f.data)===null||v===void 0?void 0:v.hook;(b=j==null?void 0:j.prepatch)===null||b===void 0||b.call(j,l,f);const x=f.elm=l.elm;if(l===f)return;if(f.data!==void 0||G(f.text)&&f.text!==l.text){(w=f.data)!==null&&w!==void 0||(f.data={}),(S=l.data)!==null&&S!==void 0||(l.data={});for(let W=0;W<n.update.length;++W)n.update[W](l,f);(E=(A=(O=f.data)===null||O===void 0?void 0:O.hook)===null||A===void 0?void 0:A.update)===null||E===void 0||E.call(A,l,f)}const k=l.children,D=f.children;ce(f.text)?G(k)&&G(D)?k!==D&&y(x,k,D,m):G(D)?(G(l.text)&&o.setTextContent(x,""),c(x,null,D,0,D.length-1,m)):G(k)?h(x,k,0,k.length-1):G(l.text)&&o.setTextContent(x,""):l.text!==f.text&&(G(k)&&h(x,k,0,k.length-1),o.setTextContent(x,f.text)),(P=j==null?void 0:j.postpatch)===null||P===void 0||P.call(j,l,f)}return function(f,m){let v,b,w;const S=[];for(v=0;v<n.pre.length;++v)n.pre[v]();for(Is(o,f)?f=i(f):js(o,f)&&(f=s(f)),Ot(f,m)?d(f,m,S):(b=f.elm,w=o.parentNode(b),u(m,S),w!==null&&(o.insertBefore(w,m.elm,o.nextSibling(b)),h(w,[f],0,0))),v=0;v<S.length;++v)S[v].data.hook.insert(S[v]);for(v=0;v<n.post.length;++v)n.post[v]();return m}}function De(r,t,e){if(r.ns="http://www.w3.org/2000/svg",e!=="foreignObject"&&t!==void 0)for(let n=0;n<t.length;++n){const o=t[n];if(typeof o=="string")continue;const i=o.data;i!==void 0&&De(i,o.children,o.sel)}}function Z(r,t,e){let n={},o,i,s;if(e!==void 0?(t!==null&&(n=t),Se(e)?o=e:Rt(e)?i=e.toString():e&&e.sel&&(o=[e])):t!=null&&(Se(t)?o=t:Rt(t)?i=t.toString():t&&t.sel?o=[t]:n=t),o!==void 0)for(s=0;s<o.length;++s)Rt(o[s])&&(o[s]=J(void 0,void 0,void 0,o[s],void 0));return r[0]==="s"&&r[1]==="v"&&r[2]==="g"&&(r.length===3||r[3]==="."||r[3]==="#")&&De(n,o,r),J(r,n,o,i,void 0)}function $e(r,t){const e=t!==void 0?t:rn;let n;if(e.isElement(r)){const o=r.id?"#"+r.id:"",i=r.getAttribute("class"),s=i?"."+i.split(" ").join("."):"",a=e.tagName(r).toLowerCase()+o+s,u={},c={},p={},h=[];let y,d,l;const f=r.attributes,m=r.childNodes;for(d=0,l=f.length;d<l;d++)y=f[d].nodeName,y[0]==="d"&&y[1]==="a"&&y[2]==="t"&&y[3]==="a"&&y[4]==="-"?c[y.slice(5)]=f[d].nodeValue||"":y!=="id"&&y!=="class"&&(u[y]=f[d].nodeValue);for(d=0,l=m.length;d<l;d++)h.push($e(m[d],t));return Object.keys(u).length>0&&(p.attrs=u),Object.keys(c).length>0&&(p.dataset=c),a[0]==="s"&&a[1]==="v"&&a[2]==="g"&&(a.length===3||a[3]==="."||a[3]==="#")&&De(p,h,a),J(a,p,h,void 0,r)}else return e.isText(r)?(n=e.getTextContent(r),J(void 0,void 0,void 0,n,r)):e.isComment(r)?(n=e.getTextContent(r),J("!",{},[],n,r)):J("",{},[],void 0,r)}const Ds="http://www.w3.org/1999/xlink",Ms="http://www.w3.org/XML/1998/namespace",rr=58,Fs=120;function nr(r,t){let e;const n=t.elm;let o=r.data.attrs,i=t.data.attrs;if(!(!o&&!i)&&o!==i){o=o||{},i=i||{};for(e in i){const s=i[e];o[e]!==s&&(s===!0?n.setAttribute(e,""):s===!1?n.removeAttribute(e):e.charCodeAt(0)!==Fs?n.setAttribute(e,s):e.charCodeAt(3)===rr?n.setAttributeNS(Ms,e,s):e.charCodeAt(5)===rr?n.setAttributeNS(Ds,e,s):n.setAttribute(e,s))}for(e in o)e in i||n.removeAttribute(e)}}const Ls={create:nr,update:nr};function or(r,t){let e,n;const o=t.elm;let i=r.data.class,s=t.data.class;if(!(!i&&!s)&&i!==s){i=i||{},s=s||{};for(n in i)i[n]&&!Object.prototype.hasOwnProperty.call(s,n)&&o.classList.remove(n);for(n in s)e=s[n],e!==i[n]&&o.classList[e?"add":"remove"](n)}}const Rs={create:or,update:or},ir=/[A-Z]/g;function sr(r,t){const e=t.elm;let n=r.data.dataset,o=t.data.dataset,i;if(!n&&!o||n===o)return;n=n||{},o=o||{};const s=e.dataset;for(i in n)o[i]||(s?i in s&&delete s[i]:e.removeAttribute("data-"+i.replace(ir,"-$&").toLowerCase()));for(i in o)n[i]!==o[i]&&(s?s[i]=o[i]:e.setAttribute("data-"+i.replace(ir,"-$&").toLowerCase(),o[i]))}const Bs={create:sr,update:sr};function ar(r,t){let e,n,o;const i=t.elm;let s=r.data.props,a=t.data.props;if(!(!s&&!a)&&s!==a){s=s||{},a=a||{};for(e in a)n=a[e],o=s[e],o!==n&&(e!=="value"||i[e]!==n)&&(i[e]=n)}}const Us={create:ar,update:ar},ur=typeof window!="undefined"&&window.requestAnimationFrame.bind(window)||setTimeout,Ws=function(r){ur(function(){ur(r)})};let Oe=!1;function Gs(r,t,e){Ws(function(){r[t]=e})}function cr(r,t){let e,n;const o=t.elm;let i=r.data.style,s=t.data.style;if(!i&&!s||i===s)return;i=i||{},s=s||{};const a="delayed"in i;for(n in i)s[n]||(n[0]==="-"&&n[1]==="-"?o.style.removeProperty(n):o.style[n]="");for(n in s)if(e=s[n],n==="delayed"&&s.delayed)for(const u in s.delayed)e=s.delayed[u],(!a||e!==i.delayed[u])&&Gs(o.style,u,e);else n!=="remove"&&e!==i[n]&&(n[0]==="-"&&n[1]==="-"?o.style.setProperty(n,e):o.style[n]=e)}function zs(r){let t,e;const n=r.elm,o=r.data.style;if(!(!o||!(t=o.destroy)))for(e in t)n.style[e]=t[e]}function qs(r,t){const e=r.data.style;if(!e||!e.remove){t();return}Oe||(r.elm.offsetLeft,Oe=!0);let n;const o=r.elm;let i=0;const s=e.remove;let a=0;const u=[];for(n in s)u.push(n),o.style[n]=s[n];const p=getComputedStyle(o)["transition-property"].split(", ");for(;i<p.length;++i)u.indexOf(p[i])!==-1&&a++;o.addEventListener("transitionend",function(h){h.target===o&&--a,a===0&&t()})}function Vs(){Oe=!1}const Hs={pre:Vs,create:cr,update:cr,destroy:zs,remove:qs};function Vt(r,t,e,n,o){e===void 0&&(e=!1),n===void 0&&(n=!1),o===void 0&&(o=!1);var i=null;return K.create({start:function(a){n?i=function(c){on(c,n),a.next(c)}:i=function(c){a.next(c)},r.addEventListener(t,i,{capture:e,passive:o})},stop:function(){r.removeEventListener(t,i,e),i=null}})}function nn(r,t){for(var e=Object.keys(r),n=e.length,o=0;o<n;o++){var i=e[o];if(typeof r[i]=="object"&&typeof t[i]=="object"){if(!nn(r[i],t[i]))return!1}else if(r[i]!==t[i])return!1}return!0}function on(r,t){if(t)if(typeof t=="boolean")r.preventDefault();else if(Js(t))t(r)&&r.preventDefault();else if(typeof t=="object")nn(t,r)&&r.preventDefault();else throw new Error("preventDefault has to be either a boolean, predicate function or object")}function Js(r){return typeof r=="function"}var Ks=function(){function r(t){this._name=t}return r.prototype.select=function(t){return this},r.prototype.elements=function(){var t=q($.of([document]));return t._isCycleSource=this._name,t},r.prototype.element=function(){var t=q($.of(document));return t._isCycleSource=this._name,t},r.prototype.events=function(t,e,n){e===void 0&&(e={});var o;o=Vt(document,t,e.useCapture,e.preventDefault);var i=q(o);return i._isCycleSource=this._name,i},r}(),Ys=function(){function r(t){this._name=t}return r.prototype.select=function(t){return this},r.prototype.elements=function(){var t=q($.of([document.body]));return t._isCycleSource=this._name,t},r.prototype.element=function(){var t=q($.of(document.body));return t._isCycleSource=this._name,t},r.prototype.events=function(t,e,n){e===void 0&&(e={});var o;o=Vt(document.body,t,e.useCapture,e.preventDefault);var i=q(o);return i._isCycleSource=this._name,i},r}();function Xs(r){var t=1,e=11;return typeof HTMLElement=="object"?r instanceof HTMLElement||r instanceof DocumentFragment:r&&typeof r=="object"&&r!==null&&(r.nodeType===t||r.nodeType===e)&&typeof r.nodeName=="string"}function Zs(r){return r.length>1&&(r[0]==="."||r[0]==="#")}function Qs(r){return r.nodeType===11}function ta(r){if(typeof r!="string"&&!Xs(r))throw new Error("Given container is not a DOM element neither a selector string.")}function ea(r){var t=typeof r=="string"?document.querySelector(r):r;if(typeof r=="string"&&t===null)throw new Error("Cannot render into unknown element `"+r+"`");return t}function sn(r){for(var t="",e=r.length-1;e>=0&&r[e].type==="selector";e--)t=r[e].scope+" "+t;return t.trim()}function Me(r,t){if(!Array.isArray(r)||!Array.isArray(t)||r.length!==t.length)return!1;for(var e=0;e<r.length;e++)if(r[e].type!==t[e].type||r[e].scope!==t[e].scope)return!1;return!0}var an=function(){function r(t,e){this.namespace=t,this.isolateModule=e,this._namespace=t.filter(function(n){return n.type!=="selector"})}return r.prototype.isDirectlyInScope=function(t){var e=this.isolateModule.getNamespace(t);if(!e||this._namespace.length>e.length||!Me(this._namespace,e.slice(0,this._namespace.length)))return!1;for(var n=this._namespace.length;n<e.length;n++)if(e[n].type==="total")return!1;return!0},r}();function ra(r){return Array.prototype.slice.call(r)}var un=function(){function r(t,e){this.namespace=t,this.isolateModule=e}return r.prototype.call=function(){var t=this.namespace,e=sn(t),n=new an(t,this.isolateModule),o=this.isolateModule.getElement(t.filter(function(i){return i.type!=="selector"}));return o===void 0?[]:e===""?[o]:ra(o.querySelectorAll(e)).filter(n.isDirectlyInScope,n).concat(o.matches(e)?[o]:[])},r}(),Ct=globalThis&&globalThis.__assign||function(){return Ct=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ct.apply(this,arguments)};function na(r){return function(t,e){return e===":root"?t:t.map(function(n){if(!n)return n;var o=cn(e),i=Ct({},n,{data:Ct({},n.data,{isolate:!n.data||!Array.isArray(n.data.isolate)?r.concat([o]):n.data.isolate})});return Ct({},i,{key:i.key!==void 0?i.key:JSON.stringify(i.data.isolate)})})}}function cn(r){return{type:Zs(r)?"sibling":"total",scope:r}}var oa=function(){function r(t,e,n,o,i,s){n===void 0&&(n=[]),this._rootElement$=t,this._sanitation$=e,this._namespace=n,this._isolateModule=o,this._eventDelegator=i,this._name=s,this.isolateSource=function(a,u){return new r(a._rootElement$,a._sanitation$,a._namespace.concat(cn(u)),a._isolateModule,a._eventDelegator,a._name)},this.isolateSink=na(this._namespace)}return r.prototype._elements=function(){if(this._namespace.length===0)return this._rootElement$.map(function(e){return[e]});var t=new un(this._namespace,this._isolateModule);return this._rootElement$.map(function(){return t.call()})},r.prototype.elements=function(){var t=q(this._elements().remember());return t._isCycleSource=this._name,t},r.prototype.element=function(){var t=q(this._elements().filter(function(e){return e.length>0}).map(function(e){return e[0]}).remember());return t._isCycleSource=this._name,t},Object.defineProperty(r.prototype,"namespace",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),r.prototype.select=function(t){if(typeof t!="string")throw new Error("DOM driver's select() expects the argument to be a string as a CSS selector");if(t==="document")return new Ks(this._name);if(t==="body")return new Ys(this._name);var e=t===":root"?[]:this._namespace.concat({type:"selector",scope:t.trim()});return new r(this._rootElement$,this._sanitation$,e,this._isolateModule,this._eventDelegator,this._name)},r.prototype.events=function(t,e,n){if(e===void 0&&(e={}),typeof t!="string")throw new Error("DOM driver's events() expects argument to be a string representing the event type to listen for.");var o=this._eventDelegator.addEventListener(t,this._namespace,e,n),i=q(o);return i._isCycleSource=this._name,i},r.prototype.dispose=function(){this._sanitation$.shamefullySendNext(null)},r}(),wt={},ia=H&&H.__spreadArrays||function(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var n=Array(r),o=0,t=0;t<e;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n};Object.defineProperty(wt,"__esModule",{value:!0});wt.SampleCombineOperator=wt.SampleCombineListener=void 0;var sa=z,Q={},fn=function(){function r(t,e){this.i=t,this.p=e,e.ils[t]=this}return r.prototype._n=function(t){var e=this.p;e.out!==Q&&e.up(t,this.i)},r.prototype._e=function(t){this.p._e(t)},r.prototype._c=function(){this.p.down(this.i,this)},r}();wt.SampleCombineListener=fn;var ln=function(){function r(t,e){this.type="sampleCombine",this.ins=t,this.others=e,this.out=Q,this.ils=[],this.Nn=0,this.vals=[]}return r.prototype._start=function(t){this.out=t;for(var e=this.others,n=this.Nn=e.length,o=this.vals=new Array(n),i=0;i<n;i++)o[i]=Q,e[i]._add(new fn(i,this));this.ins._add(this)},r.prototype._stop=function(){var t=this.others,e=t.length,n=this.ils;this.ins._remove(this);for(var o=0;o<e;o++)t[o]._remove(n[o]);this.out=Q,this.vals=[],this.ils=[]},r.prototype._n=function(t){var e=this.out;e!==Q&&(this.Nn>0||e._n(ia([t],this.vals)))},r.prototype._e=function(t){var e=this.out;e!==Q&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==Q&&t._c()},r.prototype.up=function(t,e){var n=this.vals[e];this.Nn>0&&n===Q&&this.Nn--,this.vals[e]=t},r.prototype.down=function(t,e){this.others[t]._remove(e)},r}();wt.SampleCombineOperator=ln;var pn;pn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(o){return new sa.Stream(new ln(o,t))}};var aa=wt.default=pn;globalThis&&globalThis.__assign;function hn(r){if(!r.sel)return{tagName:"",id:"",className:""};var t=r.sel,e=t.indexOf("#"),n=t.indexOf(".",e),o=e>0?e:t.length,i=n>0?n:t.length,s=e!==-1||n!==-1?t.slice(0,Math.min(o,i)):t,a=o<i?t.slice(o+1,i):void 0,u=n>0?t.slice(i+1).replace(/\./g," "):void 0;return{tagName:s,id:a,className:u}}function ua(r){var t=hn(r).className,e=t===void 0?"":t;if(!r.data)return e;var n=r.data,o=n.class,i=n.props;if(o){var s=Object.keys(o).filter(function(a){return o[a]});e+=" "+s.join(" ")}return i&&i.className&&(e+=" "+i.className),e&&e.trim()}var Et;typeof self!="undefined"?Et=self:typeof window!="undefined"?Et=window:typeof global!="undefined"?Et=global:Et=Function("return this")();var fr=Et.Symbol;typeof fr=="function"&&fr("parent");var ca=function(){function r(t){this.rootElement=t}return r.prototype.call=function(t){if(Qs(this.rootElement))return this.wrapDocFrag(t===null?[]:[t]);if(t===null)return this.wrap([]);var e=hn(t),n=e.tagName,o=e.id,i=ua(t),s=t.data||{},a=s.props||{},u=a.id,c=u===void 0?o:u,p=typeof c=="string"&&c.toUpperCase()===this.rootElement.id.toUpperCase()&&n.toUpperCase()===this.rootElement.tagName.toUpperCase()&&i.toUpperCase()===this.rootElement.className.toUpperCase();return p?t:this.wrap([t])},r.prototype.wrapDocFrag=function(t){return J("",{isolate:[]},t,void 0,this.rootElement)},r.prototype.wrap=function(t){var e=this.rootElement,n=e.tagName,o=e.id,i=e.className,s=o?"#"+o:"",a=i?"."+i.split(" ").join("."):"",u=Z(""+n.toLowerCase()+s+a,{},t);return u.data=u.data||{},u.data.isolate=u.data.isolate||[],u},r}(),fa=[Hs,Rs,Us,Ls,Bs],dn=function(){function r(t){this.mapper=t,this.tree=[void 0,{}]}return r.prototype.set=function(t,e,n){for(var o=this.tree,i=n!==void 0?n:t.length,s=0;s<i;s++){var a=this.mapper(t[s]),u=o[1][a];u||(u=[void 0,{}],o[1][a]=u),o=u}o[0]=e},r.prototype.getDefault=function(t,e,n){return this.get(t,e,n)},r.prototype.get=function(t,e,n){for(var o=this.tree,i=n!==void 0?n:t.length,s=0;s<i;s++){var a=this.mapper(t[s]),u=o[1][a];if(!u)if(e)u=[void 0,{}],o[1][a]=u;else return;o=u}return e&&!o[0]&&(o[0]=e()),o[0]},r.prototype.delete=function(t){for(var e=this.tree,n=0;n<t.length-1;n++){var o=e[1][this.mapper(t[n])];if(!o)return;e=o}delete e[1][this.mapper(t[t.length-1])]},r}(),la=function(){function r(){this.namespaceTree=new dn(function(t){return t.scope}),this.namespaceByElement=new Map,this.vnodesBeingRemoved=[]}return r.prototype.setEventDelegator=function(t){this.eventDelegator=t},r.prototype.insertElement=function(t,e){this.namespaceByElement.set(e,t),this.namespaceTree.set(t,e)},r.prototype.removeElement=function(t){this.namespaceByElement.delete(t);var e=this.getNamespace(t);e&&this.namespaceTree.delete(e)},r.prototype.getElement=function(t,e){return this.namespaceTree.get(t,void 0,e)},r.prototype.getRootElement=function(t){if(this.namespaceByElement.has(t))return t;for(var e=t;!this.namespaceByElement.has(e);)if(e=e.parentNode,e){if(e.tagName==="HTML")throw new Error("No root element found, this should not happen at all")}else return;return e},r.prototype.getNamespace=function(t){var e=this.getRootElement(t);if(!!e)return this.namespaceByElement.get(e)},r.prototype.createModule=function(){var t=this;return{create:function(e,n){var o=n.elm,i=n.data,s=i===void 0?{}:i,a=s.isolate;Array.isArray(a)&&t.insertElement(a,o)},update:function(e,n){var o=e.elm,i=e.data,s=i===void 0?{}:i,a=n.elm,u=n.data,c=u===void 0?{}:u,p=s.isolate,h=c.isolate;Me(p,h)||Array.isArray(p)&&t.removeElement(o),Array.isArray(h)&&t.insertElement(h,a)},destroy:function(e){t.vnodesBeingRemoved.push(e)},remove:function(e,n){t.vnodesBeingRemoved.push(e),n()},post:function(){for(var e=t.vnodesBeingRemoved,n=e.length-1;n>=0;n--){var o=e[n],i=o.data!==void 0?o.data.isolation:void 0;i!==void 0&&t.removeElement(i),t.eventDelegator.removeElement(o.elm,i)}t.vnodesBeingRemoved=[]}}},r}(),pa=function(){function r(){this.arr=[],this.prios=[]}return r.prototype.add=function(t,e){for(var n=0;n<this.arr.length;n++)if(this.prios[n]<e){this.arr.splice(n,0,t),this.prios.splice(n,0,e);return}this.arr.push(t),this.prios.push(e)},r.prototype.forEach=function(t){for(var e=0;e<this.arr.length;e++)t(this.arr[e],e,this.arr)},r.prototype.delete=function(t){for(var e=0;e<this.arr.length;e++)if(this.arr[e]===t){this.arr.splice(e,1),this.prios.splice(e,1);return}},r}(),Ht=globalThis&&globalThis.__assign||function(){return Ht=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ht.apply(this,arguments)},ha=["blur","canplay","canplaythrough","durationchange","emptied","ended","focus","load","loadeddata","loadedmetadata","mouseenter","mouseleave","pause","play","playing","ratechange","reset","scroll","seeked","seeking","stalled","submit","suspend","timeupdate","unload","volumechange","waiting"],da=function(){function r(t,e){var n=this;this.rootElement$=t,this.isolateModule=e,this.virtualListeners=new dn(function(o){return o.scope}),this.nonBubblingListenersToAdd=new Set,this.virtualNonBubblingListener=[],this.isolateModule.setEventDelegator(this),this.domListeners=new Map,this.domListenersToAdd=new Map,this.nonBubblingListeners=new Map,t.addListener({next:function(o){n.origin!==o&&(n.origin=o,n.resetEventListeners(),n.domListenersToAdd.forEach(function(i,s){return n.setupDOMListener(s,i)}),n.domListenersToAdd.clear()),n.nonBubblingListenersToAdd.forEach(function(i){n.setupNonBubblingListener(i)})}})}return r.prototype.addEventListener=function(t,e,n,o){var i=$.never(),s,a=new an(e,this.isolateModule),u=o===void 0?ha.indexOf(t)===-1:o;if(u)return this.domListeners.has(t)||this.setupDOMListener(t,!!n.passive),s=this.insertListener(i,a,t,n),i;var c=[];this.nonBubblingListenersToAdd.forEach(function(O){return c.push(O)});for(var p=void 0,h=0,y=c.length,d=function(O){O[0];var A=O[1],E=O[2];return O[3],t===A&&Me(E.namespace,e)};!p&&h<y;){var l=c[h];p=d(l)?l:p,h++}var f=p,m;if(f){var b=f[0];m=b}else{var v=new un(e,this.isolateModule);s=this.insertListener(i,a,t,n),f=[i,t,v,s],m=i,this.nonBubblingListenersToAdd.add(f),this.setupNonBubblingListener(f)}var w=this,S=null;return $.create({start:function(O){S=m.subscribe(O)},stop:function(){f[0];var O=f[1],A=f[2];f[3];var E=A.call();E.forEach(function(P){var j=P.subs;j&&j[O]&&(j[O].unsubscribe(),delete j[O])}),w.nonBubblingListenersToAdd.delete(f),S.unsubscribe()}})},r.prototype.removeElement=function(t,e){e!==void 0&&this.virtualListeners.delete(e);var n=[];this.nonBubblingListeners.forEach(function(s,a){if(s.has(t)){n.push([a,t]);var u=t.subs;u&&Object.keys(u).forEach(function(c){u[c].unsubscribe()})}});for(var o=0;o<n.length;o++){var i=this.nonBubblingListeners.get(n[o][0]);!i||(i.delete(n[o][1]),i.size===0?this.nonBubblingListeners.delete(n[o][0]):this.nonBubblingListeners.set(n[o][0],i))}},r.prototype.insertListener=function(t,e,n,o){var i=[],s=e._namespace,a=s.length;do i.push(this.getVirtualListeners(n,s,!0,a)),a--;while(a>=0&&s[a].type!=="total");for(var u=Ht({},o,{scopeChecker:e,subject:t,bubbles:!!o.bubbles,useCapture:!!o.useCapture,passive:!!o.passive}),c=0;c<i.length;c++)i[c].add(u,s.length);return u},r.prototype.getVirtualListeners=function(t,e,n,o){n===void 0&&(n=!1);var i=o!==void 0?o:e.length;if(!n)for(var s=i-1;s>=0;s--){if(e[s].type==="total"){i=s+1;break}i=s}var a=this.virtualListeners.getDefault(e,function(){return new Map},i);return a.has(t)||a.set(t,new pa),a.get(t)},r.prototype.setupDOMListener=function(t,e){var n=this;if(this.origin){var o=Vt(this.origin,t,!1,!1,e).subscribe({next:function(i){return n.onEvent(t,i,e)},error:function(){},complete:function(){}});this.domListeners.set(t,{sub:o,passive:e})}else this.domListenersToAdd.set(t,e)},r.prototype.setupNonBubblingListener=function(t){t[0];var e=t[1],n=t[2],o=t[3];if(!!this.origin){var i=n.call();if(i.length){var s=this;i.forEach(function(a){var u,c=a.subs;if(!c||!c[e]){var p=Vt(a,e,!1,!1,o.passive).subscribe({next:function(y){return s.onEvent(e,y,!!o.passive,!1)},error:function(){},complete:function(){}});s.nonBubblingListeners.has(e)||s.nonBubblingListeners.set(e,new Map);var h=s.nonBubblingListeners.get(e);if(!h)return;h.set(a,{sub:p,destination:o}),a.subs=Ht({},c,(u={},u[e]=p,u))}})}}},r.prototype.resetEventListeners=function(){for(var t=this.domListeners.entries(),e=t.next();!e.done;){var n=e.value,o=n[0],i=n[1],s=i.sub,a=i.passive;s.unsubscribe(),this.setupDOMListener(o,a),e=t.next()}},r.prototype.putNonBubblingListener=function(t,e,n,o){var i=this.nonBubblingListeners.get(t);if(!!i){var s=i.get(e);s&&s.destination.passive===o&&s.destination.useCapture===n&&(this.virtualNonBubblingListener[0]=s.destination)}},r.prototype.onEvent=function(t,e,n,o){o===void 0&&(o=!0);var i=this.patchEvent(e),s=this.isolateModule.getRootElement(e.target);if(o){var a=this.isolateModule.getNamespace(e.target);if(!a)return;var u=this.getVirtualListeners(t,a);this.bubble(t,e.target,s,i,u,a,a.length-1,!0,n),this.bubble(t,e.target,s,i,u,a,a.length-1,!1,n)}else this.putNonBubblingListener(t,e.target,!0,n),this.doBubbleStep(t,e.target,s,i,this.virtualNonBubblingListener,!0,n),this.putNonBubblingListener(t,e.target,!1,n),this.doBubbleStep(t,e.target,s,i,this.virtualNonBubblingListener,!1,n),e.stopPropagation()},r.prototype.bubble=function(t,e,n,o,i,s,a,u,c){!u&&!o.propagationHasBeenStopped&&this.doBubbleStep(t,e,n,o,i,u,c);var p=n,h=a;if(e===n)if(a>=0&&s[a].type==="sibling")p=this.isolateModule.getElement(s,a),h--;else return;e.parentNode&&p&&this.bubble(t,e.parentNode,p,o,i,s,h,u,c),u&&!o.propagationHasBeenStopped&&this.doBubbleStep(t,e,n,o,i,u,c)},r.prototype.doBubbleStep=function(t,e,n,o,i,s,a){!n||(this.mutateEventCurrentTarget(o,e),i.forEach(function(u){if(u.passive===a&&u.useCapture===s){var c=sn(u.scopeChecker.namespace);!o.propagationHasBeenStopped&&u.scopeChecker.isDirectlyInScope(e)&&(c!==""&&e.matches(c)||c===""&&e===n)&&(on(o,u.preventDefault),u.subject.shamefullySendNext(o))}}))},r.prototype.patchEvent=function(t){var e=t;e.propagationHasBeenStopped=!1;var n=e.stopPropagation;return e.stopPropagation=function(){n.call(this),this.propagationHasBeenStopped=!0},e},r.prototype.mutateEventCurrentTarget=function(t,e){try{Object.defineProperty(t,"currentTarget",{value:e,configurable:!0})}catch{console.log("please use event.ownerTarget")}t.ownerTarget=e},r}();function ya(r){if(!Array.isArray(r))throw new Error("Optional modules option must be an array for snabbdom modules")}function ma(r){if(!r||typeof r.addListener!="function"||typeof r.fold!="function")throw new Error("The DOM driver function expects as input a Stream of virtual DOM elements")}function va(r){return $.merge(r,$.never())}function _a(r){return r.elm}function ga(r){(console.error||console.log)(r)}function ba(){return $.create({start:function(r){document.readyState==="loading"?document.addEventListener("readystatechange",function(){var t=document.readyState;(t==="interactive"||t==="complete")&&(r.next(null),r.complete())}):(r.next(null),r.complete())},stop:function(){}})}function wa(r){return r.data=r.data||{},r.data.isolate=[],r}function Sa(r,t){t===void 0&&(t={}),ta(r);var e=t.modules||fa;ya(e);var n=new la,o=t&&t.snabbdomOptions||void 0,i=xs([n.createModule()].concat(e),void 0,o),s=ba(),a,u,c=$.create({start:function(h){u=new MutationObserver(function(){return h.next(null)})},stop:function(){u.disconnect()}});function p(h,y){y===void 0&&(y="DOM"),ma(h);var d=$.create(),l=s.map(function(){var w=ea(r)||document.body;return a=new ca(w),w}),f=h.remember();f.addListener({}),c.addListener({});var m=l.map(function(w){return $.merge(f.endWhen(d),d).map(function(S){return a.call(S)}).startWith(wa($e(w))).fold(i,$e(w)).drop(1).map(_a).startWith(w).map(function(S){return u.observe(S,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),S}).compose(va)}).flatten(),v=Xr(s,c).endWhen(d).compose(aa(m)).map(function(w){return w[1]}).remember();v.addListener({error:t.reportSnabbdomError||ga});var b=new da(v,n);return new oa(v,d,[],n,b,y)}return p}function $a(r){return typeof r=="string"&&r.length>0}function Oa(r){return $a(r)&&(r[0]==="."||r[0]==="#")}function yn(r){return function(e,n,o){var i=typeof e!="undefined",s=typeof n!="undefined",a=typeof o!="undefined";return Oa(e)?s&&a?Z(r+e,n,o):s?Z(r+e,n):Z(r+e,{}):a?Z(r+e,n,o):s?Z(r,e,n):i?Z(r,e):Z(r,{})}}var Aa=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","colorProfile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotlight","feTile","feTurbulence","filter","font","fontFace","fontFaceFormat","fontFaceName","fontFaceSrc","fontFaceUri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missingGlyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Ea=yn("svg");Aa.forEach(function(r){Ea[r]=yn(r)});var Pa=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","meta","nav","noscript","object","ol","optgroup","option","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","u","ul","video"];Pa.forEach(function(r){});function Na(r,t,e={}){const{combineList:n=["DOM"],globalList:o=["EVENTS"],stateSourceName:i="STATE",domSourceName:s="DOM",container:a="div",containerClass:u}=e;return c=>{const p=Date.now(),h={item:r,itemKey:(d,l)=>typeof d.id!="undefined"?d.id:l,itemScope:d=>d,channel:i,collectSinks:d=>Object.entries(c).reduce((l,[f,m])=>{if(n.includes(f)){const v=d.pickCombine(f);f===s&&a?l[s]=v.map(b=>({sel:a,data:u?{props:{className:u}}:{},children:b,key:p,text:void 0,elm:void 0})):l[f]=v}else l[f]=d.pickMerge(f);return l},{})},y={[i]:t};return o.forEach(d=>y[d]=null),n.forEach(d=>y[d]=null),Ca(h,y,c)}}function Ca(r,t,e){return rt(Xi(r),t)(e)}var V=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Qt={},U={},mn={exports:{}},vn={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=t;function t(e){var n,o=e.Symbol;if(typeof o=="function")if(o.observable)n=o.observable;else{n=o.for("https://github.com/benlesh/symbol-observable");try{o.observable=n}catch{}}else n="@@observable";return n}})(vn);(function(r){r.exports=vn})(mn);var lr=Object.prototype.toString,_n=function(t){var e=lr.call(t),n=e==="[object Arguments]";return n||(n=e!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&lr.call(t.callee)==="[object Function]"),n},le,pr;function Ia(){if(pr)return le;pr=1;var r;if(!Object.keys){var t=Object.prototype.hasOwnProperty,e=Object.prototype.toString,n=_n,o=Object.prototype.propertyIsEnumerable,i=!o.call({toString:null},"toString"),s=o.call(function(){},"prototype"),a=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],u=function(y){var d=y.constructor;return d&&d.prototype===y},c={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},p=function(){if(typeof window=="undefined")return!1;for(var y in window)try{if(!c["$"+y]&&t.call(window,y)&&window[y]!==null&&typeof window[y]=="object")try{u(window[y])}catch{return!0}}catch{return!0}return!1}(),h=function(y){if(typeof window=="undefined"||!p)return u(y);try{return u(y)}catch{return!1}};r=function(d){var l=d!==null&&typeof d=="object",f=e.call(d)==="[object Function]",m=n(d),v=l&&e.call(d)==="[object String]",b=[];if(!l&&!f&&!m)throw new TypeError("Object.keys called on a non-object");var w=s&&f;if(v&&d.length>0&&!t.call(d,0))for(var S=0;S<d.length;++S)b.push(String(S));if(m&&d.length>0)for(var O=0;O<d.length;++O)b.push(String(O));else for(var A in d)!(w&&A==="prototype")&&t.call(d,A)&&b.push(String(A));if(i)for(var E=h(d),P=0;P<a.length;++P)!(E&&a[P]==="constructor")&&t.call(d,a[P])&&b.push(a[P]);return b}}return le=r,le}var ja=Array.prototype.slice,Ta=_n,hr=Object.keys,Bt=hr?function(t){return hr(t)}:Ia(),dr=Object.keys;Bt.shim=function(){if(Object.keys){var t=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);t||(Object.keys=function(n){return Ta(n)?dr(ja.call(n)):dr(n)})}else Object.keys=Bt;return Object.keys||Bt};var ka=Bt,xa=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),n=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var o=42;t[e]=o;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var i=Object.getOwnPropertySymbols(t);if(i.length!==1||i[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(t,e);if(s.value!==o||s.enumerable!==!0)return!1}return!0},yr=typeof Symbol!="undefined"&&Symbol,Da=xa,Ma=function(){return typeof yr!="function"||typeof Symbol!="function"||typeof yr("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Da()},mr={foo:{}},Fa=Object,La=function(){return{__proto__:mr}.foo===mr.foo&&!({__proto__:null}instanceof Fa)},Ra="Function.prototype.bind called on incompatible ",pe=Array.prototype.slice,Ba=Object.prototype.toString,Ua="[object Function]",Wa=function(t){var e=this;if(typeof e!="function"||Ba.call(e)!==Ua)throw new TypeError(Ra+e);for(var n=pe.call(arguments,1),o,i=function(){if(this instanceof o){var p=e.apply(this,n.concat(pe.call(arguments)));return Object(p)===p?p:this}else return e.apply(t,n.concat(pe.call(arguments)))},s=Math.max(0,e.length-n.length),a=[],u=0;u<s;u++)a.push("$"+u);if(o=Function("binder","return function ("+a.join(",")+"){ return binder.apply(this,arguments); }")(i),e.prototype){var c=function(){};c.prototype=e.prototype,o.prototype=new c,c.prototype=null}return o},Ga=Wa,gn=Function.prototype.bind||Ga,za=gn,qa=za.call(Function.call,Object.prototype.hasOwnProperty),C,St=SyntaxError,bn=Function,gt=TypeError,he=function(r){try{return bn('"use strict"; return ('+r+").constructor;")()}catch{}},ft=Object.getOwnPropertyDescriptor;if(ft)try{ft({},"")}catch{ft=null}var de=function(){throw new gt},Va=ft?function(){try{return arguments.callee,de}catch{try{return ft(arguments,"callee").get}catch{return de}}}():de,dt=Ma(),Ha=La(),F=Object.getPrototypeOf||(Ha?function(r){return r.__proto__}:null),vt={},Ja=typeof Uint8Array=="undefined"||!F?C:F(Uint8Array),lt={"%AggregateError%":typeof AggregateError=="undefined"?C:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?C:ArrayBuffer,"%ArrayIteratorPrototype%":dt&&F?F([][Symbol.iterator]()):C,"%AsyncFromSyncIteratorPrototype%":C,"%AsyncFunction%":vt,"%AsyncGenerator%":vt,"%AsyncGeneratorFunction%":vt,"%AsyncIteratorPrototype%":vt,"%Atomics%":typeof Atomics=="undefined"?C:Atomics,"%BigInt%":typeof BigInt=="undefined"?C:BigInt,"%BigInt64Array%":typeof BigInt64Array=="undefined"?C:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array=="undefined"?C:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?C:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?C:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?C:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?C:FinalizationRegistry,"%Function%":bn,"%GeneratorFunction%":vt,"%Int8Array%":typeof Int8Array=="undefined"?C:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?C:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?C:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":dt&&F?F(F([][Symbol.iterator]())):C,"%JSON%":typeof JSON=="object"?JSON:C,"%Map%":typeof Map=="undefined"?C:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!dt||!F?C:F(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?C:Promise,"%Proxy%":typeof Proxy=="undefined"?C:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?C:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?C:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!dt||!F?C:F(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?C:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":dt&&F?F(""[Symbol.iterator]()):C,"%Symbol%":dt?Symbol:C,"%SyntaxError%":St,"%ThrowTypeError%":Va,"%TypedArray%":Ja,"%TypeError%":gt,"%Uint8Array%":typeof Uint8Array=="undefined"?C:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?C:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?C:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?C:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?C:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?C:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?C:WeakSet};if(F)try{null.error}catch(r){var Ka=F(F(r));lt["%Error.prototype%"]=Ka}var Ya=function r(t){var e;if(t==="%AsyncFunction%")e=he("async function () {}");else if(t==="%GeneratorFunction%")e=he("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=he("async function* () {}");else if(t==="%AsyncGenerator%"){var n=r("%AsyncGeneratorFunction%");n&&(e=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var o=r("%AsyncGenerator%");o&&F&&(e=F(o.prototype))}return lt[t]=e,e},vr={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},jt=gn,Jt=qa,Xa=jt.call(Function.call,Array.prototype.concat),Za=jt.call(Function.apply,Array.prototype.splice),_r=jt.call(Function.call,String.prototype.replace),Kt=jt.call(Function.call,String.prototype.slice),Qa=jt.call(Function.call,RegExp.prototype.exec),tu=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,eu=/\\(\\)?/g,ru=function(t){var e=Kt(t,0,1),n=Kt(t,-1);if(e==="%"&&n!=="%")throw new St("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&e!=="%")throw new St("invalid intrinsic syntax, expected opening `%`");var o=[];return _r(t,tu,function(i,s,a,u){o[o.length]=a?_r(u,eu,"$1"):s||i}),o},nu=function(t,e){var n=t,o;if(Jt(vr,n)&&(o=vr[n],n="%"+o[0]+"%"),Jt(lt,n)){var i=lt[n];if(i===vt&&(i=Ya(n)),typeof i=="undefined"&&!e)throw new gt("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:o,name:n,value:i}}throw new St("intrinsic "+t+" does not exist!")},ou=function(t,e){if(typeof t!="string"||t.length===0)throw new gt("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new gt('"allowMissing" argument must be a boolean');if(Qa(/^%?[^%]*%?$/,t)===null)throw new St("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=ru(t),o=n.length>0?n[0]:"",i=nu("%"+o+"%",e),s=i.name,a=i.value,u=!1,c=i.alias;c&&(o=c[0],Za(n,Xa([0,1],c)));for(var p=1,h=!0;p<n.length;p+=1){var y=n[p],d=Kt(y,0,1),l=Kt(y,-1);if((d==='"'||d==="'"||d==="`"||l==='"'||l==="'"||l==="`")&&d!==l)throw new St("property names with quotes must have matching quotes");if((y==="constructor"||!h)&&(u=!0),o+="."+y,s="%"+o+"%",Jt(lt,s))a=lt[s];else if(a!=null){if(!(y in a)){if(!e)throw new gt("base intrinsic for "+t+" exists, but the property is not available.");return}if(ft&&p+1>=n.length){var f=ft(a,y);h=!!f,h&&"get"in f&&!("originalValue"in f.get)?a=f.get:a=a[y]}else h=Jt(a,y),a=a[y];h&&!u&&(lt[s]=a)}}return a},iu=ou,Ae=iu("%Object.defineProperty%",!0),Ee=function(){if(Ae)try{return Ae({},"a",{value:1}),!0}catch{return!1}return!1};Ee.hasArrayLengthDefineBug=function(){if(!Ee())return null;try{return Ae([],"length",{value:1}).length!==1}catch{return!0}};var su=Ee,au=ka,uu=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",cu=Object.prototype.toString,fu=Array.prototype.concat,wn=Object.defineProperty,lu=function(r){return typeof r=="function"&&cu.call(r)==="[object Function]"},pu=su(),Sn=wn&&pu,hu=function(r,t,e,n){if(t in r){if(n===!0){if(r[t]===e)return}else if(!lu(n)||!n())return}Sn?wn(r,t,{configurable:!0,enumerable:!1,value:e,writable:!0}):r[t]=e},$n=function(r,t){var e=arguments.length>2?arguments[2]:{},n=au(t);uu&&(n=fu.call(n,Object.getOwnPropertySymbols(t)));for(var o=0;o<n.length;o+=1)hu(r,n[o],t[n[o]],e[n[o]])};$n.supportsDescriptors=!!Sn;var On=$n,An=V,du=An,En=function(){return typeof V!="object"||!V||V.Math!==Math||V.Array!==Array?du:V},yu=On,mu=En,vu=function(){var t=mu();if(yu.supportsDescriptors){var e=Object.getOwnPropertyDescriptor(t,"globalThis");(!e||e.configurable&&(e.enumerable||!e.writable||globalThis!==t))&&Object.defineProperty(t,"globalThis",{configurable:!0,enumerable:!1,value:t,writable:!0})}else(typeof globalThis!="object"||globalThis!==t)&&(t.globalThis=t);return t},_u=On,gu=An,Pn=En,bu=vu,wu=Pn(),Nn=function(){return wu};_u(Nn,{getPolyfill:Pn,implementation:gu,shim:bu});var Su=Nn,$u=V&&V.__extends||function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},r(t,e)};return function(t,e){r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}();Object.defineProperty(U,"__esModule",{value:!0});U.NO_IL=U.NO=U.MemoryStream=U.Stream=void 0;var Ou=mn.exports,Au=Su,Mt=Ou.default(Au.getPolyfill()),g={};U.NO=g;function B(){}function Ut(r){for(var t=r.length,e=Array(t),n=0;n<t;++n)e[n]=r[n];return e}function Eu(r,t){return function(n){return r(n)&&t(n)}}function Fe(r,t,e){try{return r.f(t)}catch(n){return e._e(n),g}}var st={_n:B,_e:B,_c:B};U.NO_IL=st;function gr(r){r._start=function(e){e.next=e._n,e.error=e._e,e.complete=e._c,this.start(e)},r._stop=r.stop}var Pu=function(){function r(t,e){this._stream=t,this._listener=e}return r.prototype.unsubscribe=function(){this._stream._remove(this._listener)},r}(),Nu=function(){function r(t){this._listener=t}return r.prototype.next=function(t){this._listener._n(t)},r.prototype.error=function(t){this._listener._e(t)},r.prototype.complete=function(){this._listener._c()},r}(),Cu=function(){function r(t){this.type="fromObservable",this.ins=t,this.active=!1}return r.prototype._start=function(t){this.out=t,this.active=!0,this._sub=this.ins.subscribe(new Nu(t)),this.active||this._sub.unsubscribe()},r.prototype._stop=function(){this._sub&&this._sub.unsubscribe(),this.active=!1},r}(),Iu=function(){function r(t){this.type="merge",this.insArr=t,this.out=g,this.ac=0}return r.prototype._start=function(t){this.out=t;var e=this.insArr,n=e.length;this.ac=n;for(var o=0;o<n;o++)e[o]._add(this)},r.prototype._stop=function(){for(var t=this.insArr,e=t.length,n=0;n<e;n++)t[n]._remove(this);this.out=g},r.prototype._n=function(t){var e=this.out;e!==g&&e._n(t)},r.prototype._e=function(t){var e=this.out;e!==g&&e._e(t)},r.prototype._c=function(){if(--this.ac<=0){var t=this.out;if(t===g)return;t._c()}},r}(),ju=function(){function r(t,e,n){this.i=t,this.out=e,this.p=n,n.ils.push(this)}return r.prototype._n=function(t){var e=this.p,n=this.out;if(n!==g&&e.up(t,this.i)){var o=Ut(e.vals);n._n(o)}},r.prototype._e=function(t){var e=this.out;e!==g&&e._e(t)},r.prototype._c=function(){var t=this.p;t.out!==g&&--t.Nc===0&&t.out._c()},r}(),Tu=function(){function r(t){this.type="combine",this.insArr=t,this.out=g,this.ils=[],this.Nc=this.Nn=0,this.vals=[]}return r.prototype.up=function(t,e){var n=this.vals[e],o=this.Nn?n===g?--this.Nn:this.Nn:0;return this.vals[e]=t,o===0},r.prototype._start=function(t){this.out=t;var e=this.insArr,n=this.Nc=this.Nn=e.length,o=this.vals=new Array(n);if(n===0)t._n([]),t._c();else for(var i=0;i<n;i++)o[i]=g,e[i]._add(new ju(i,t,this))},r.prototype._stop=function(){for(var t=this.insArr,e=t.length,n=this.ils,o=0;o<e;o++)t[o]._remove(n[o]);this.out=g,this.ils=[],this.vals=[]},r}(),ku=function(){function r(t){this.type="fromArray",this.a=t}return r.prototype._start=function(t){for(var e=this.a,n=0,o=e.length;n<o;n++)t._n(e[n]);t._c()},r.prototype._stop=function(){},r}(),xu=function(){function r(t){this.type="fromPromise",this.on=!1,this.p=t}return r.prototype._start=function(t){var e=this;this.on=!0,this.p.then(function(n){e.on&&(t._n(n),t._c())},function(n){t._e(n)}).then(B,function(n){setTimeout(function(){throw n})})},r.prototype._stop=function(){this.on=!1},r}(),Du=function(){function r(t){this.type="periodic",this.period=t,this.intervalID=-1,this.i=0}return r.prototype._start=function(t){var e=this;function n(){t._n(e.i++)}this.intervalID=setInterval(n,this.period)},r.prototype._stop=function(){this.intervalID!==-1&&clearInterval(this.intervalID),this.intervalID=-1,this.i=0},r}(),Mu=function(){function r(t,e){this.type="debug",this.ins=t,this.out=g,this.s=B,this.l="",typeof e=="string"?this.l=e:typeof e=="function"&&(this.s=e)}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=g},r.prototype._n=function(t){var e=this.out;if(e!==g){var n=this.s,o=this.l;if(n!==B)try{n(t)}catch(i){e._e(i)}else o?console.log(o+":",t):console.log(t);e._n(t)}},r.prototype._e=function(t){var e=this.out;e!==g&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==g&&t._c()},r}(),Fu=function(){function r(t,e){this.type="drop",this.ins=e,this.out=g,this.max=t,this.dropped=0}return r.prototype._start=function(t){this.out=t,this.dropped=0,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=g},r.prototype._n=function(t){var e=this.out;e!==g&&this.dropped++>=this.max&&e._n(t)},r.prototype._e=function(t){var e=this.out;e!==g&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==g&&t._c()},r}(),Lu=function(){function r(t,e){this.out=t,this.op=e}return r.prototype._n=function(){this.op.end()},r.prototype._e=function(t){this.out._e(t)},r.prototype._c=function(){this.op.end()},r}(),Ru=function(){function r(t,e){this.type="endWhen",this.ins=e,this.out=g,this.o=t,this.oil=st}return r.prototype._start=function(t){this.out=t,this.o._add(this.oil=new Lu(t,this)),this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.o._remove(this.oil),this.out=g,this.oil=st},r.prototype.end=function(){var t=this.out;t!==g&&t._c()},r.prototype._n=function(t){var e=this.out;e!==g&&e._n(t)},r.prototype._e=function(t){var e=this.out;e!==g&&e._e(t)},r.prototype._c=function(){this.end()},r}(),ye=function(){function r(t,e){this.type="filter",this.ins=e,this.out=g,this.f=t}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=g},r.prototype._n=function(t){var e=this.out;if(e!==g){var n=Fe(this,t,e);n===g||!n||e._n(t)}},r.prototype._e=function(t){var e=this.out;e!==g&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==g&&t._c()},r}(),Bu=function(){function r(t,e){this.out=t,this.op=e}return r.prototype._n=function(t){this.out._n(t)},r.prototype._e=function(t){this.out._e(t)},r.prototype._c=function(){this.op.inner=g,this.op.less()},r}(),Uu=function(){function r(t){this.type="flatten",this.ins=t,this.out=g,this.open=!0,this.inner=g,this.il=st}return r.prototype._start=function(t){this.out=t,this.open=!0,this.inner=g,this.il=st,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.inner!==g&&this.inner._remove(this.il),this.out=g,this.open=!0,this.inner=g,this.il=st},r.prototype.less=function(){var t=this.out;t!==g&&!this.open&&this.inner===g&&t._c()},r.prototype._n=function(t){var e=this.out;if(e!==g){var n=this,o=n.inner,i=n.il;o!==g&&i!==st&&o._remove(i),(this.inner=t)._add(this.il=new Bu(e,this))}},r.prototype._e=function(t){var e=this.out;e!==g&&e._e(t)},r.prototype._c=function(){this.open=!1,this.less()},r}(),Wu=function(){function r(t,e,n){var o=this;this.type="fold",this.ins=n,this.out=g,this.f=function(i){return t(o.acc,i)},this.acc=this.seed=e}return r.prototype._start=function(t){this.out=t,this.acc=this.seed,t._n(this.acc),this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=g,this.acc=this.seed},r.prototype._n=function(t){var e=this.out;if(e!==g){var n=Fe(this,t,e);n!==g&&e._n(this.acc=n)}},r.prototype._e=function(t){var e=this.out;e!==g&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==g&&t._c()},r}(),Gu=function(){function r(t){this.type="last",this.ins=t,this.out=g,this.has=!1,this.val=g}return r.prototype._start=function(t){this.out=t,this.has=!1,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=g,this.val=g},r.prototype._n=function(t){this.has=!0,this.val=t},r.prototype._e=function(t){var e=this.out;e!==g&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==g&&(this.has?(t._n(this.val),t._c()):t._e(new Error("last() failed because input stream completed")))},r}(),zu=function(){function r(t,e){this.type="map",this.ins=e,this.out=g,this.f=t}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=g},r.prototype._n=function(t){var e=this.out;if(e!==g){var n=Fe(this,t,e);n!==g&&e._n(n)}},r.prototype._e=function(t){var e=this.out;e!==g&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==g&&t._c()},r}(),qu=function(){function r(t){this.type="remember",this.ins=t,this.out=g}return r.prototype._start=function(t){this.out=t,this.ins._add(t)},r.prototype._stop=function(){this.ins._remove(this.out),this.out=g},r}(),Vu=function(){function r(t,e){this.type="replaceError",this.ins=e,this.out=g,this.f=t}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=g},r.prototype._n=function(t){var e=this.out;e!==g&&e._n(t)},r.prototype._e=function(t){var e=this.out;if(e!==g)try{this.ins._remove(this),(this.ins=this.f(t))._add(this)}catch(n){e._e(n)}},r.prototype._c=function(){var t=this.out;t!==g&&t._c()},r}(),Hu=function(){function r(t,e){this.type="startWith",this.ins=t,this.out=g,this.val=e}return r.prototype._start=function(t){this.out=t,this.out._n(this.val),this.ins._add(t)},r.prototype._stop=function(){this.ins._remove(this.out),this.out=g},r}(),Ju=function(){function r(t,e){this.type="take",this.ins=e,this.out=g,this.max=t,this.taken=0}return r.prototype._start=function(t){this.out=t,this.taken=0,this.max<=0?t._c():this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=g},r.prototype._n=function(t){var e=this.out;if(e!==g){var n=++this.taken;n<this.max?e._n(t):n===this.max&&(e._n(t),e._c())}},r.prototype._e=function(t){var e=this.out;e!==g&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==g&&t._c()},r}(),Le=function(){function r(t){this._prod=t||g,this._ils=[],this._stopID=g,this._dl=g,this._d=!1,this._target=null,this._err=g}return r.prototype._n=function(t){var e=this._ils,n=e.length;if(this._d&&this._dl._n(t),n==1)e[0]._n(t);else{if(n==0)return;for(var o=Ut(e),i=0;i<n;i++)o[i]._n(t)}},r.prototype._e=function(t){if(this._err===g){this._err=t;var e=this._ils,n=e.length;if(this._x(),this._d&&this._dl._e(t),n==1)e[0]._e(t);else{if(n==0)return;for(var o=Ut(e),i=0;i<n;i++)o[i]._e(t)}if(!this._d&&n==0)throw this._err}},r.prototype._c=function(){var t=this._ils,e=t.length;if(this._x(),this._d&&this._dl._c(),e==1)t[0]._c();else{if(e==0)return;for(var n=Ut(t),o=0;o<e;o++)n[o]._c()}},r.prototype._x=function(){this._ils.length!==0&&(this._prod!==g&&this._prod._stop(),this._err=g,this._ils=[])},r.prototype._stopNow=function(){this._prod._stop(),this._err=g,this._stopID=g},r.prototype._add=function(t){var e=this._target;if(e)return e._add(t);var n=this._ils;if(n.push(t),!(n.length>1))if(this._stopID!==g)clearTimeout(this._stopID),this._stopID=g;else{var o=this._prod;o!==g&&o._start(this)}},r.prototype._remove=function(t){var e=this,n=this._target;if(n)return n._remove(t);var o=this._ils,i=o.indexOf(t);i>-1&&(o.splice(i,1),this._prod!==g&&o.length<=0?(this._err=g,this._stopID=setTimeout(function(){return e._stopNow()})):o.length===1&&this._pruneCycles())},r.prototype._pruneCycles=function(){this._hasNoSinks(this,[])&&this._remove(this._ils[0])},r.prototype._hasNoSinks=function(t,e){if(e.indexOf(t)!==-1)return!0;if(t.out===this)return!0;if(t.out&&t.out!==g)return this._hasNoSinks(t.out,e.concat(t));if(t._ils){for(var n=0,o=t._ils.length;n<o;n++)if(!this._hasNoSinks(t._ils[n],e.concat(t)))return!1;return!0}else return!1},r.prototype.ctor=function(){return this instanceof tt?tt:r},r.prototype.addListener=function(t){t._n=t.next||B,t._e=t.error||B,t._c=t.complete||B,this._add(t)},r.prototype.removeListener=function(t){this._remove(t)},r.prototype.subscribe=function(t){return this.addListener(t),new Pu(this,t)},r.prototype[Mt]=function(){return this},r.create=function(t){if(t){if(typeof t.start!="function"||typeof t.stop!="function")throw new Error("producer requires both start and stop functions");gr(t)}return new r(t)},r.createWithMemory=function(t){return t&&gr(t),new tt(t)},r.never=function(){return new r({_start:B,_stop:B})},r.empty=function(){return new r({_start:function(t){t._c()},_stop:B})},r.throw=function(t){return new r({_start:function(e){e._e(t)},_stop:B})},r.from=function(t){if(typeof t[Mt]=="function")return r.fromObservable(t);if(typeof t.then=="function")return r.fromPromise(t);if(Array.isArray(t))return r.fromArray(t);throw new TypeError("Type of input to from() must be an Array, Promise, or Observable")},r.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r.fromArray(t)},r.fromArray=function(t){return new r(new ku(t))},r.fromPromise=function(t){return new r(new xu(t))},r.fromObservable=function(t){if(t.endWhen!==void 0)return t;var e=typeof t[Mt]=="function"?t[Mt]():t;return new r(new Cu(e))},r.periodic=function(t){return new r(new Du(t))},r.prototype._map=function(t){return new(this.ctor())(new zu(t,this))},r.prototype.map=function(t){return this._map(t)},r.prototype.mapTo=function(t){var e=this.map(function(){return t}),n=e._prod;return n.type="mapTo",e},r.prototype.filter=function(t){var e=this._prod;return e instanceof ye?new r(new ye(Eu(e.f,t),e.ins)):new r(new ye(t,this))},r.prototype.take=function(t){return new(this.ctor())(new Ju(t,this))},r.prototype.drop=function(t){return new r(new Fu(t,this))},r.prototype.last=function(){return new r(new Gu(this))},r.prototype.startWith=function(t){return new tt(new Hu(this,t))},r.prototype.endWhen=function(t){return new(this.ctor())(new Ru(t,this))},r.prototype.fold=function(t,e){return new tt(new Wu(t,e,this))},r.prototype.replaceError=function(t){return new(this.ctor())(new Vu(t,this))},r.prototype.flatten=function(){return new r(new Uu(this))},r.prototype.compose=function(t){return t(this)},r.prototype.remember=function(){return new tt(new qu(this))},r.prototype.debug=function(t){return new(this.ctor())(new Mu(this,t))},r.prototype.imitate=function(t){if(t instanceof tt)throw new Error("A MemoryStream was given to imitate(), but it only supports a Stream. Read more about this restriction here: https://github.com/staltz/xstream#faq");this._target=t;for(var e=this._ils,n=e.length,o=0;o<n;o++)t._add(e[o]);this._ils=[]},r.prototype.shamefullySendNext=function(t){this._n(t)},r.prototype.shamefullySendError=function(t){this._e(t)},r.prototype.shamefullySendComplete=function(){this._c()},r.prototype.setDebugListener=function(t){t?(this._d=!0,t._n=t.next||B,t._e=t.error||B,t._c=t.complete||B,this._dl=t):(this._d=!1,this._dl=g)},r.merge=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new r(new Iu(e))},r.combine=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return new r(new Tu(e))},r}();U.Stream=Le;var tt=function(r){$u(t,r);function t(e){var n=r.call(this,e)||this;return n._has=!1,n}return t.prototype._n=function(e){this._v=e,this._has=!0,r.prototype._n.call(this,e)},t.prototype._add=function(e){var n=this._target;if(n)return n._add(e);var o=this._ils;if(o.push(e),o.length>1){this._has&&e._n(this._v);return}if(this._stopID!==g)this._has&&e._n(this._v),clearTimeout(this._stopID),this._stopID=g;else if(this._has)e._n(this._v);else{var i=this._prod;i!==g&&i._start(this)}},t.prototype._stopNow=function(){this._has=!1,r.prototype._stopNow.call(this)},t.prototype._x=function(){this._has=!1,r.prototype._x.call(this)},t.prototype.map=function(e){return this._map(e)},t.prototype.mapTo=function(e){return r.prototype.mapTo.call(this,e)},t.prototype.take=function(e){return r.prototype.take.call(this,e)},t.prototype.endWhen=function(e){return r.prototype.endWhen.call(this,e)},t.prototype.replaceError=function(e){return r.prototype.replaceError.call(this,e)},t.prototype.remember=function(){return this},t.prototype.debug=function(e){return r.prototype.debug.call(this,e)},t}(Le);U.MemoryStream=tt;var Ku=Le;U.default=Ku;Object.defineProperty(Qt,"__esModule",{value:!0});Qt.DropRepeatsOperator=void 0;var Yu=U,me={},Cn=function(){function r(t,e){this.ins=t,this.type="dropRepeats",this.out=null,this.v=me,this.isEq=e||function(n,o){return n===o}}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=null,this.v=me},r.prototype._n=function(t){var e=this.out;if(!!e){var n=this.v;n!==me&&this.isEq(t,n)||(this.v=t,e._n(t))}},r.prototype._e=function(t){var e=this.out;!e||e._e(t)},r.prototype._c=function(){var t=this.out;!t||t._c()},r}();Qt.DropRepeatsOperator=Cn;function Xu(r){return r===void 0&&(r=void 0),function(e){return new Yu.Stream(new Cn(e,r))}}var Yt=Qt.default=Xu;function Zu(r,t,e,n={}){const{switched:o=["DOM"],stateSourceName:i="STATE"}=n,s=typeof t;if(!t)throw new Error("Missing 'name$' parameter for switchable()");if(!(s==="string"||s==="function"||t instanceof K))throw new Error("Invalid 'name$' parameter for switchable(): expects Stream, String, or Function");if(t instanceof K){const a=t.compose(Yt()).startWith(e).remember();return u=>br(r,u,a,o)}else{const a=s==="function"&&t||(u=>u[t]);return u=>{const c=u&&(typeof i=="string"&&u[i]||u.STATE||u.state).stream;if(!c instanceof K)throw new Error(`Could not find the state source: ${i}`);const p=c.map(a).filter(h=>typeof h=="string").compose(Yt()).startWith(e).remember();return br(r,u,p,o,i)}}}function br(r,t,e,n=["DOM"],o="STATE"){typeof n=="string"&&(n=[n]);const i=Object.entries(r).map(([a,u])=>{if(t[o]){const c=t[o].stream,p=$.combine(e,c).filter(([y,d])=>y==a).map(([y,d])=>d).remember(),h=new t[o].constructor(p,t[o]._name);return[a,u(T(I({},t),{state:h}))]}return[a,u(t)]});return Object.keys(t).reduce((a,u)=>{if(n.includes(u))a[u]=e.map(c=>{const p=i.find(([h,y])=>h===c);return p&&p[1][u]||$.never()}).flatten().remember().startWith(void 0);else{const c=i.filter(([p,h])=>h[u]!==void 0).map(([p,h])=>h[u]);a[u]=$.merge(...c)}return a},{})}var In={};Object.defineProperty(In,"__esModule",{value:!0});var Qu=U,tc=function(){function r(t,e){this.dt=t,this.ins=e,this.type="delay",this.out=null}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=null},r.prototype._n=function(t){var e=this.out;if(!!e)var n=setInterval(function(){e._n(t),clearInterval(n)},this.dt)},r.prototype._e=function(t){var e=this.out;if(!!e)var n=setInterval(function(){e._e(t),clearInterval(n)},this.dt)},r.prototype._c=function(){var t=this.out;if(!!t)var e=setInterval(function(){t._c(),clearInterval(e)},this.dt)},r}();function ec(r){return function(e){return new Qu.Stream(new tc(r,e))}}var Pe=In.default=ec,jn={};Object.defineProperty(jn,"__esModule",{value:!0});var rc=U,nc=function(){function r(t){this.streams=t,this.type="concat",this.out=null,this.i=0}return r.prototype._start=function(t){this.out=t,this.streams[this.i]._add(this)},r.prototype._stop=function(){var t=this.streams;this.i<t.length&&t[this.i]._remove(this),this.i=0,this.out=null},r.prototype._n=function(t){var e=this.out;!e||e._n(t)},r.prototype._e=function(t){var e=this.out;!e||e._e(t)},r.prototype._c=function(){var t=this.out;if(!!t){var e=this.streams;e[this.i]._remove(this),++this.i<e.length?e[this.i]._add(this):t._c()}},r}();function oc(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return new rc.Stream(new nc(r))}var wr=jn.default=oc,Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});var Pt=U,ic=function(){function r(t,e){this.dt=t,this.ins=e,this.type="debounce",this.out=null,this.id=null,this.t=Pt.NO}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=null,this.clearInterval()},r.prototype.clearInterval=function(){var t=this.id;t!==null&&clearInterval(t),this.id=null},r.prototype._n=function(t){var e=this,n=this.out;!n||(this.clearInterval(),this.t=t,this.id=setInterval(function(){e.clearInterval(),n._n(t),e.t=Pt.NO},this.dt))},r.prototype._e=function(t){var e=this.out;!e||(this.clearInterval(),e._e(t))},r.prototype._c=function(){var t=this.out;!t||(this.clearInterval(),this.t!=Pt.NO&&t._n(this.t),this.t=Pt.NO,t._c())},r}();function sc(r){return function(e){return new Pt.Stream(new ic(r,e))}}var ve=Tn.default=sc;const Ne=typeof window!="undefined"&&window||process&&process.env||{},Sr="request",ac="BOOTSTRAP",yt="INITIALIZE",uc="HYDRATE";let $r=!0;const Xt="~#~#~ABORT~#~#~";function kn(r){const{name:t,sources:e,isolateOpts:n,stateSourceName:o="STATE"}=r;if(e&&typeof e!="object")throw new Error("Sources must be a Cycle.js sources object:",t);let i;typeof n=="string"?i={[o]:n}:n===!0?i={}:i=n;const s=typeof e=="undefined";if(typeof i=="object"){const a=u=>{const c=T(I({},r),{sources:u});return new _e(c).sinks};return s?rt(a,i):rt(a,i)(e)}else return s?a=>new _e(T(I({},r),{sources:a})).sinks:new _e(r).sinks}class _e{constructor({name:t="NO NAME",sources:e,intent:n,request:o,model:i,response:s,view:a,children:u={},components:c={},initialState:p,calculated:h,storeCalculatedInState:y=!0,DOMSourceName:d="DOM",stateSourceName:l="STATE",requestSourceName:f="HTTP"}){if(!e||typeof e!="object")throw new Error("Missing or invalid sources");this.name=t,this.sources=e,this.intent=n,this.request=o,this.model=i,this.response=s,this.view=a,this.children=u,this.components=c,this.initialState=p,this.calculated=h,this.storeCalculatedInState=y,this.DOMSourceName=d,this.stateSourceName=l,this.requestSourceName=f,this.sourceNames=Object.keys(e),this.isSubComponent=this.sourceNames.includes("props$");const m=e[l]&&e[l].stream;m&&(this.currentState=p||{},this.sources[this.stateSourceName]=new At(m.map(v=>(this.currentState=v,v)))),$r&&typeof this.intent=="undefined"&&typeof this.model=="undefined"&&(this.initialState=p||!0,this.intent=v=>({__NOOP_ACTION__:$.never()}),this.model={__NOOP_ACTION__:v=>v}),$r=!1,this.log=cc(t),this.initIntent$(),this.initAction$(),this.initResponse$(),this.initState(),this.initModel$(),this.initSendResponse$(),this.initChildren$(),this.initSubComponentSink$(),this.initSubComponentsRendered$(),this.initVdom$(),this.initSinks()}initIntent$(){if(!!this.intent){if(typeof this.intent!="function")throw new Error("Intent must be a function");if(this.intent$=this.intent(this.sources),!(this.intent$ instanceof K)&&typeof this.intent$!="object")throw new Error("Intent must return either an action$ stream or map of event streams")}}initAction$(){const t=this.sources&&this.sources[this.requestSourceName]||null;if(!this.intent$){this.action$=$.never();return}let e;if(this.intent$ instanceof K)e=this.intent$;else{const a=Object.entries(this.intent$).map(([u,c])=>c.map(p=>({type:u,data:p})));e=$.merge($.never(),...a)}const n=e instanceof K?e:e.apply&&e(this.sources)||$.never(),o=wr($.of({type:ac}),n).compose(Pe(10));let i;t&&typeof t.select=="function"?i=t.select("initial").flatten():i=$.never();const s=i.map(a=>({type:uc,data:a}));this.action$=$.merge(o,s).compose(this.log(({type:a})=>`Action triggered: <${a}>`))}initResponse$(){if(typeof this.request=="undefined")return;if(typeof this.request!="object")throw new Error("The request parameter must be an object");const t=this.sources[this.requestSourceName],n=Object.entries(this.request).reduce((o,[i,s])=>{const a=i.toLowerCase();if(typeof t[a]!="function")throw new Error("Invalid method in request object:",i);const c=Object.entries(s).reduce((h,[y,d])=>{const l=`[${a.toUpperCase()}]:${y||"none"}`,f=typeof d;if(f==="undefined")throw new Error(`Action for '${y}' route in request object not specified`);if(f!=="string"&&f!=="function")throw new Error(`Invalid action for '${y}' route: expecting string or function`);const m=f==="function"?"[ FUNCTION ]":`< ${d} >`;console.log(`[${this.name}] Adding ${this.requestSourceName} route:`,a.toUpperCase(),`'${y}' <${m}>`);const v=t[a](y).compose(Yt((b,w)=>b.id==w.id)).map(b=>{if(!b||!b.id)throw new Error(`No id found in request: ${l}`);try{const w=b.id,S=b.params,O=b.body,A=b.cookies,E=f==="function"?"FUNCTION":d,P={params:S,body:O,cookies:A,req:b},j={type:E,data:O,req:b,_reqId:w,_action:E},x=new Date().toISOString(),k=b.get?b.get("host"):"0.0.0.0";if(console.log(`${x} ${k} ${b.method} ${b.url}`),Ne.DEBUG&&this.action$.setDebugListener({next:({type:D})=>console.log(`[${this.name}] Action from ${this.requestSourceName} request: <${D}>`)}),f==="function"){const D=this.addCalculated(this.currentState),W=d(D,b);return $.of(T(I({},j),{data:W}))}else{this.action$.shamefullySendNext(j);const W=Object.entries(this.sources).reduce((nt,[te,ee])=>{if(!ee||typeof ee[Sr]!="function")return nt;const Kn=ee[Sr](w);return[...nt,Kn]},[]);return $.merge(...W)}}catch(w){console.error(w)}}).flatten();return[...h,v]},[]),p=$.merge(...c);return[...o,p]},[]);if(this.response$=$.merge(...n).compose(this.log(o=>o._action?`[${this.requestSourceName}] response data received for Action: <${o._action}>`:`[${this.requestSourceName}] response data received from FUNCTION`)),typeof this.response!="undefined"&&typeof this.response$=="undefined")throw new Error("Cannot have a response parameter without a request parameter")}initState(){this.model!=null&&(this.model[yt]===void 0?this.model[yt]={[this.stateSourceName]:(t,e)=>I({},this.addCalculated(e))}:Object.keys(this.model[yt]).forEach(t=>{t!==this.stateSourceName&&(console.warn(`${yt} can only be used with the ${this.stateSourceName} source... disregarding ${t}`),delete this.model[yt][t])}))}initModel$(){if(typeof this.model=="undefined"){this.model$=this.sourceNames.reduce((u,c)=>(u[c]=$.never(),u),{});return}const t={type:yt,data:this.initialState},e=this.initialState?wr($.of(t),this.action$).compose(Pe(0)):this.action$,n=this.makeOnAction(e,!0,this.action$),o=this.makeOnAction(this.action$,!1,this.action$),i=Object.entries(this.model),s={};i.forEach(u=>{let[c,p]=u;if(typeof p=="function"&&(p={[this.stateSourceName]:p}),typeof p!="object")throw new Error(`Entry for each action must be an object: ${this.name} ${c}`);Object.entries(p).forEach(y=>{const[d,l]=y,f=d==this.stateSourceName,b=(f?n:o)(c,l).compose(this.log(w=>{if(f)return`State reducer added: <${c}>`;{const S=w&&(w.type||w.command||w.name||w.key||Array.isArray(w)&&"Array"||w);return`Data sent to [${d}]: <${c}> ${S}`}}));Array.isArray(s[d])?s[d].push(b):s[d]=[b]})});const a=Object.entries(s).reduce((u,c)=>{const[p,h]=c;return u[p]=$.merge($.never(),...h),u},{});this.model$=a}initSendResponse$(){const t=typeof this.response;if(t!="function"&&t!="undefined")throw new Error("The response parameter must be a function");if(t=="undefined"){this.response$&&this.response$.subscribe({next:this.log(({_reqId:s,_action:a})=>`Unhandled response for request: ${a} ${s}`)}),this.sendResponse$=$.never();return}const e={select:s=>typeof s=="undefined"?this.response$:(Array.isArray(s)||(s=[s]),this.response$.filter(({_action:a})=>s.length>0?a==="FUNCTION"||s.includes(a):!0))},n=this.response(e);if(typeof n!="object")throw new Error("The response function must return an object");const i=Object.entries(n).reduce((s,[a,u])=>{const c=u.map(({_reqId:p,_action:h,data:y})=>{if(!p)throw new Error(`No request id found for response for: ${a}`);return{_reqId:p,_action:h,command:a,data:y}});return[...s,c]},[]);this.sendResponse$=$.merge(...i).compose(this.log(({_reqId:s,_action:a})=>`[${this.requestSourceName}] response sent for: <${a}>`))}initChildren$(){const t=this.sourceNames.reduce((e,n)=>(n==this.DOMSourceName?e[n]={}:e[n]=[],e),{});this.children$=Object.entries(this.children).reduce((e,[n,o])=>{const i=o(this.sources);return this.sourceNames.forEach(s=>{s==this.DOMSourceName?e[s][n]=i[s]:e[s].push(i[s])}),e},t)}initSubComponentSink$(){const t=$.create({start:e=>{this.newSubComponentSinks=e.next.bind(e)},stop:e=>{}});t.subscribe({next:e=>e}),this.subComponentSink$=t.filter(e=>Object.keys(e).length>0)}initSubComponentsRendered$(){const t=$.create({start:e=>{this.subComponentsRendered=e.next.bind(e)},stop:e=>{}});this.subComponentsRendered$=t.startWith(null)}initVdom$(){if(typeof this.view!="function"){this.vdom$=$.of(null);return}const t=this.collectRenderParameters();this.vdom$=t.map(this.view).map(e=>e||{sel:"div",data:{},children:[]}).compose(this.instantiateSubComponents.bind(this)).filter(e=>e!==void 0).compose(this.renderVdom.bind(this))}initSinks(){this.sinks=this.sourceNames.reduce((t,e)=>{if(e==this.DOMSourceName)return t;const n=this.subComponentSink$?this.subComponentSink$.map(o=>o[e]).filter(o=>!!o).flatten():$.never();return e===this.stateSourceName?t[e]=$.merge(this.model$[e]||$.never(),n,this.sources[this.stateSourceName].stream.filter(o=>!1),...this.children$[e]):t[e]=$.merge(this.model$[e]||$.never(),n,...this.children$[e]),t},{}),this.sinks[this.DOMSourceName]=this.vdom$,this.sinks[this.requestSourceName]=$.merge(this.sendResponse$,this.sinks[this.requestSourceName])}makeOnAction(t,e=!0,n){return n=n||t,(o,i)=>{const s=t.filter(({type:u})=>u==o);let a;if(typeof i=="function")a=s.map(u=>{const c=(h,y)=>{const d=u._reqId||u.req&&u.req.id,l=d?typeof y=="object"?T(I({},y),{_reqId:d,_action:o}):{data:y,_reqId:d,_action:o}:y;setTimeout(()=>{n.shamefullySendNext({type:h,data:l})},10)};let p=u.data;if(p&&p.data&&p._reqId&&(p=p.data),e)return h=>{const y=this.isSubComponent?this.currentState:h,d=this.addCalculated(y),l=i(d,p,c,u.req);return l==Xt?y:this.cleanupCalculated(l)};{const h=this.addCalculated(this.currentState),y=i(h,p,c,u.req),d=typeof y,l=u._reqId||u.req&&u.req.id;if(["string","number","boolean","function"].includes(d))return y;if(d=="object")return T(I({},y),{_reqId:l,_action:o});if(d=="undefined")return console.warn(`'undefined' value sent to ${o}`),y;throw new Error(`Invalid reducer type for ${o} ${d}`)}}).filter(u=>u!=Xt);else if(i===void 0||i===!0)a=s.map(({data:u})=>u);else{const u=i;a=s.mapTo(u)}return a}}addCalculated(t){if(!this.calculated||typeof t!="object"||t instanceof Array)return t;if(typeof this.calculated!="object")throw new Error("'calculated' parameter must be an object mapping calculated state field named to functions");const n=Object.entries(this.calculated).reduce((o,[i,s])=>{if(typeof s!="function")throw new Error(`Missing or invalid calculator function for calculated field '${i}`);try{o[i]=s(t)}catch(a){console.warn(`Calculated field '${i}' threw an error during calculation: ${a.message}`)}return o},{});return I(I({},t),n)}cleanupCalculated(t){if(!t||typeof t!="object"||t instanceof Array)return t;const u=this.storeCalculatedInState?this.addCalculated(t):t,{__props:n,__children:o}=u,i=pt(u,["__props","__children"]),s=I({},i);return this.calculated&&Object.keys(this.calculated).forEach(c=>{this.initialState&&typeof this.initialState[c]!="undefined"?s[c]=this.initialState[c]:delete s[c]}),s}collectRenderParameters(){const t=this.sources[this.stateSourceName],e=I({},this.children$[this.DOMSourceName]),n=t&&t.isolateSource(t,{get:u=>this.addCalculated(u)}),o=n&&n.stream||$.never();e.state=o,e[this.stateSourceName]=o,this.sources.props$&&(e.__props=this.sources.props$),this.sources.children$&&(e.__children=this.sources.children$);const i=[],s=[];return Object.entries(e).forEach(([u,c])=>{i.push(u),s.push(c)}),$.combine(...s).map(u=>i.reduce((c,p,h)=>(c[p]=u[h],c),{}))}instantiateSubComponents(t){return t.fold((e,n)=>{const o=Object.keys(this.components),i=xn(n,o),s=Object.entries(i),a={"::ROOT::":n};if(s.length===0)return a;const u={},c=s.reduce((h,[y,d])=>{const l=d.data,f=l.props||{},m=d.children||[],v=l.isCollection||!1,b=l.isSwitchable||!1;if(e[y]){const E=e[y];return h[y]=E,E.props$.shamefullySendNext(f),E.children$.shamefullySendNext(m),h}const w=$.create().startWith(f),S=$.create().startWith(m);let O;v?O=this.instantiateCollection.bind(this):b?O=this.instantiateSwitchable.bind(this):O=this.instantiateCustomComponent.bind(this);const A=O(d,w,S);return A[this.DOMSourceName]=A[this.DOMSourceName]?this.makeCoordinatedSubComponentDomSink(A[this.DOMSourceName]):$.never(),h[y]={sink$:A,props$:w,children$:S},Object.entries(A).map(([E,P])=>{u[E]||(u[E]=[]),E!==this.DOMSourceName&&u[E].push(P)}),h},a),p=Object.entries(u).reduce((h,[y,d])=>(d.length===0||(h[y]=d.length===1?d[0]:$.merge(...d)),h),{});return this.newSubComponentSinks(p),c},{})}makeCoordinatedSubComponentDomSink(t){const e=t.remember(),n=(i,s)=>JSON.stringify(i)===JSON.stringify(s);return this.sources[this.stateSourceName].stream.compose(Yt(n)).map(i=>e).compose(ve(10)).flatten().debug(i=>this.subComponentsRendered()).remember()}instantiateCollection(t,e,n){const i=t.data.props||{};t.children;const s=$.combine(this.sources[this.stateSourceName].stream.startWith(this.currentState),e,n).map(([f,m,v])=>typeof f=="object"?T(I({},this.addCalculated(f)),{__props:m,__children:v}):{value:f,__props:m,__children:v}),a=new At(s),u=i.from;let c;const p=typeof i.of=="function"?i.of:this.components[i.of],h=f=>{if(typeof f=="object"){const m=f,{__props:v,__children:b}=m;return pt(m,["__props","__children"])}else return f},y={get:f=>{const{__props:m,__children:v}=f;return Array.isArray(f[u])?f[u].map(b=>typeof b=="object"?T(I({},b),{__props:m,__children:v}):{value:b,__props:m,__children:v}):[]},set:(f,m)=>this.calculated&&u in this.calculated?(console.warn(`Collection sub-component of ${this.name} attempted to update state on a calculated field '${u}': Update ignored`),f):T(I({},f),{[u]:m.map(h)})};u===void 0?c={get:f=>!(f instanceof Array)&&f.value&&f.value instanceof Array?f.value:f,set:(f,m)=>(console.log("COLL SET",m),m)}:typeof u=="string"?typeof this.currentState=="object"?!(u in this.currentState)&&!(u in this.calculated)?(console.error(`Collection component in ${this.name} is attempting to use non-existent state property '${u}': To fix this error, specify a valid array property on the state.  Attempting to use parent component state.`),c=void 0):(Array.isArray(this.currentState[u])||console.warn(`State property '${u}' in collection comopnent of ${this.name} is not an array: No components will be instantiated in the collection.`),c=y):(Array.isArray(this.currentState[u])||console.warn(`State property '${u}' in collection component of ${this.name} is not an array: No components will be instantiated in the collection.`),c=y):typeof u=="object"?typeof u.get!="function"?(console.error(`Collection component in ${this.name} has an invalid 'from' field: Expecting 'undefined', a string indicating an array property in the state, or an object with 'get' and 'set' functions for retrieving and setting child state from the current state. Attempting to use parent component state.`),c=void 0):c={get:u.get,set:u.set}:(console.error(`Collection component in ${this.name} has an invalid 'from' field: Expecting 'undefined', a string indicating an array property in the state, or an object with 'get' and 'set' functions for retrieving and setting child state from the current state. Attempting to use parent component state.`),c=void 0);const d=T(I({},this.sources),{[this.stateSourceName]:a,props$:e,children$:n}),l=Na(p,c,{container:null})(d);if(typeof l!="object")throw new Error("Invalid sinks returned from component factory of collection element");return l}instantiateSwitchable(t,e,n){const i=t.data.props||{};t.children;const s=$.combine(this.sources[this.stateSourceName].stream.startWith(this.currentState),e,n).map(([f,m,v])=>typeof f=="object"?T(I({},this.addCalculated(f)),{__props:m,__children:v}):{value:f,__props:m,__children:v}),a=new At(s),u=i.state;let c;const p={get:f=>{const{__props:m,__children:v}=f;return typeof f[u]=="object"&&!(f[u]instanceof Array)?T(I({},f[u]),{__props:m,__children:v}):{value:f[u],__props:m,__children:v}},set:(f,m)=>{if(this.calculated&&u in this.calculated)return console.warn(`Switchable sub-component of ${this.name} attempted to update state on a calculated field '${u}': Update ignored`),f;if(console.log("SWITCH SET",m),typeof m!="object"||m instanceof Array)return T(I({},f),{[u]:m});const S=m,{__props:v,__children:b}=S,w=pt(S,["__props","__children"]);return T(I({},f),{[u]:w})}},h={get:f=>f,set:(f,m)=>{if(typeof m!="object"||m instanceof Array)return m;const S=m,{__props:v,__children:b}=S;return pt(S,["__props","__children"])}};typeof u=="undefined"?c=h:typeof u=="string"?c=p:typeof u=="object"?typeof u.get!="function"?(console.error(`Switchable component in ${this.name} has an invalid 'state' field: Expecting 'undefined', a string indicating an array property in the state, or an object with 'get' and 'set' functions for retrieving and setting sub-component state from the current state. Attempting to use parent component state.`),c=h):c={get:u.get,set:u.set}:(console.error(`Invalid state provided to switchable sub-component of ${this.name}: Expecting string, object, or undefined, but found ${typeof u}. Attempting to use parent component state.`),c=h);const y=i.of,d=T(I({},this.sources),{[this.stateSourceName]:a,props$:e,children$:n}),l=rt(Zu(y,e.map(f=>f.current)),{[this.stateSourceName]:c})(d);if(typeof l!="object")throw new Error("Invalid sinks returned from component factory of switchable element");return l}instantiateCustomComponent(t,e,n){const o=t.sel,s=t.data.props||{};t.children;const a=$.combine(this.sources[this.stateSourceName].stream.startWith(this.currentState),e,n).map(([m,v,b])=>typeof m=="object"?T(I({},this.addCalculated(m)),{__props:v,__children:b}):{value:m,__props:v,__children:b}),u=new At(a),c=s.state,p=o==="sygnal-factory"?s.sygnalFactory:this.components[o]||s.sygnalFactory;if(!p)throw o==="sygnal-factory"?new Error("Component not found on element with Capitalized selector and nameless function: JSX transpilation replaces selectors starting with upper case letters with functions in-scope with the same name, Sygnal cannot see the name of the resulting component."):new Error(`Component not found: ${o}`);let h;const y={get:m=>{const{__props:v,__children:b}=m;return typeof m[c]=="object"?T(I({},m[c]),{__props:v,__children:b}):{value:m[c],__props:v,__children:b}},set:(m,v)=>this.calculated&&c in this.calculated?(console.warn(`Sub-component of ${this.name} attempted to update state on a calculated field '${c}': Update ignored`),m):T(I({},m),{[c]:v})},d={get:m=>m,set:(m,v)=>{if(typeof v!="object"||v instanceof Array)return v;const O=v,{__props:b,__children:w}=O;return pt(O,["__props","__children"])}};typeof c=="undefined"?h=d:typeof c=="string"?h=y:typeof c=="object"?typeof c.get!="function"?(console.error(`Sub-component in ${this.name} has an invalid 'state' field: Expecting 'undefined', a string indicating an array property in the state, or an object with 'get' and 'set' functions for retrieving and setting sub-component state from the current state. Attempting to use parent component state.`),h=d):h={get:c.get,set:c.set}:(console.error(`Invalid state provided to sub-component of ${this.name}: Expecting string, object, or undefined, but found ${typeof c}. Attempting to use parent component state.`),h=d);const l=T(I({},this.sources),{[this.stateSourceName]:u,props$:e,children$:n}),f=rt(p,{[this.stateSourceName]:h})(l);if(typeof f!="object"){const m=o==="sygnal-factory"?"custom element":o;throw new Error("Invalid sinks returned from component factory:",m)}return f}renderVdom(t){return $.combine(this.subComponentsRendered$,t).compose(ve(5)).map(([e,n])=>{const o=Object.keys(this.components),i=n["::ROOT::"],s=Object.entries(n).filter(([c])=>c!=="::ROOT::");if(s.length===0)return $.of(i);const a=[],u=s.map(([c,p])=>(a.push(c),p.sink$[this.DOMSourceName].startWith(void 0)));return u.length===0?$.of(i):$.combine(...u).compose(ve(10)).map(c=>{const p=c.reduce((d,l,f)=>(d[a[f]]=l,d),{}),h=Fn(i);return Dn(h,p,o)})}).flatten().filter(e=>!!e).remember().compose(this.log("View Rendered"))}}function cc(r){return function(t){const e=typeof t=="function"?t:n=>t;return n=>n.debug(o=>{(Ne.DEBUG=="true"||Ne.DEBUG===!0)&&console.log(`[${r}] ${e(o)}`)})}}function xn(r,t,e=0,n=0){var h,y,d,l;if(!r)return{};if((h=r.data)!=null&&h.componentsProcessed)return{};e===0&&(r.data.componentsProcessed=!0);const o=r.sel,i=o&&o.toLowerCase()==="collection",s=o&&o.toLowerCase()==="switchable",a=o&&["collection","switchable","sygnal-factory",...t].includes(r.sel)||typeof((d=(y=r.data)==null?void 0:y.props)==null?void 0:d.sygnalFactory)=="function",u=r.data&&r.data.props||{};r.data&&r.data.attrs;const c=r.children||[];let p={};if(a){const f=Mn(r,e,n);if(i){if(!u.of)throw new Error("Collection element missing required 'component' property");if(typeof u.of!="string"&&typeof u.of!="function")throw new Error(`Invalid 'component' property of collection element: found ${typeof u.of} requires string or component factory function`);if(typeof u.of!="function"&&!t.includes(u.of))throw new Error(`Specified component for collection not found: ${u.of}`);typeof u.from!="undefined"&&!(typeof u.from=="string"||Array.isArray(u.from))&&console.warn(`No valid array found in the 'value' property of collection ${typeof u.of=="string"?u.of:"function component"}: no collection components will be created`),r.data.isCollection=!0,(l=r.data).props||(l.props={})}else if(s){if(!u.of)throw new Error("Switchable element missing required 'of' property");if(typeof u.of!="object")throw new Error(`Invalid 'components' property of switchable element: found ${typeof u.of} requires object mapping names to component factories`);if(!Object.values(u.of).every(b=>typeof b=="function"))throw new Error("One or more components provided to switchable element is not a valid component factory");if(!u.current||typeof u.current!="string"&&typeof u.current!="function")throw new Error(`Missing or invalid 'current' property for switchable element: found '${typeof u.current}' requires string or function`);if(!Object.keys(u.of).includes(u.current))throw new Error(`Component '${u.current}' not found in switchable element`);r.data.isSwitchable=!0}p[f]=r}return c.length>0&&c.map((f,m)=>xn(f,t,e+1,m)).forEach(f=>{Object.entries(f).forEach(([m,v])=>p[m]=v)}),p}function Dn(r,t,e,n=0,o){var p,h,y,d,l;if(!r)return;if((p=r.data)!=null&&p.componentsInjected)return r;n===0&&r.data&&(r.data.componentsInjected=!0);const i=r.sel||"NO SELECTOR",s=["collection","switchable","sygnal-factory",...e].includes(i)||typeof((y=(h=r.data)==null?void 0:h.props)==null?void 0:y.sygnalFactory)=="function",a=(d=r==null?void 0:r.data)==null?void 0:d.isCollection,u=(l=r==null?void 0:r.data)==null?void 0:l.isSwitchable;r.data&&r.data.props;const c=r.children||[];if(s){const f=Mn(r,n,o),m=t[f];return a?(r.sel="div",r.children=Array.isArray(m)?m:[m],r):m}else return c.length>0&&(r.children=c.map((f,m)=>Dn(f,t,e,n+1,m)).flat()),r}const Or=new Map;function Mn(r,t,e){const n=r.sel,o=typeof n=="string"?n:"functionComponent";let i=Or.get(n);if(!i){const p=Date.now(),h=Math.floor(Math.random()*1e4);i=`${p}-${h}`,Or.set(n,i)}const s=`${i}-${t}-${e}`,a=r.data&&r.data.props||{},u=a.id&&JSON.stringify(a.id)||s;return`${o}::${u}`}function Fn(r){return typeof r=="undefined"?r:T(I({},r),{children:Array.isArray(r.children)?r.children.map(Fn):void 0,data:r.data&&T(I({},r.data),{componentsInjected:!1})})}var Re={};Object.defineProperty(Re,"__esModule",{value:!0});function Ln(){var r;return typeof window!="undefined"?r=window:typeof V!="undefined"?r=V:r=this,r.Cyclejs=r.Cyclejs||{},r=r.Cyclejs,r.adaptStream=r.adaptStream||function(t){return t},r}function fc(r){Ln().adaptStream=r}Re.setAdapt=fc;function lc(r){return Ln().adaptStream(r)}var pc=Re.adapt=lc;function hc(r){const t=new EventTarget;return r.subscribe({next:e=>t.dispatchEvent(new CustomEvent("data",{detail:e}))}),{select:e=>{const n=!e,o=Array.isArray(e)?e:[e];let i;const s=$.create({start:a=>{i=({detail:u})=>{const c=u&&u.data||null;(n||o.includes(u.type))&&a.next(c)},t.addEventListener("data",i)},stop:a=>t.removeEventListener("data",i)});return pc(s)}}}function dc(r){r.addListener({next:t=>{console.log(t)}})}function yc(r,t={},e={}){const{mountPoint:n="#root",fragments:o=!0}=e,i=rs(r,"STATE"),s={EVENTS:hc,DOM:Sa(n,{snabbdomOptions:{experimental:{fragments:o}}}),LOG:dc},a=I(I({},s),t);return hs(i,a)}function mc(...r){return r.reduce((t,e)=>(typeof e=="string"&&!t.includes(e)?t.push(...Bn(e)):Array.isArray(e)?t.push(...vc(e)):typeof e=="object"&&t.push(..._c(e)),t),[]).join(" ")}function Rn(r){return/^[a-zA-Z0-9-_]+$/.test(r)}function Bn(r){if(typeof r!="string")throw new Error("Class name must be a string");return r.trim().split(" ").reduce((t,e)=>{if(e.trim().length===0)return t;if(!Rn(e))throw new Error(`${e} is not a valid CSS class name`);return t.push(e),t},[])}function vc(r){return r.map(Bn).flat()}function _c(r){return Object.entries(r).filter(([e,n])=>typeof n=="function"?n():!!n).map(([e,n])=>{const o=e.trim();if(!Rn(o))throw new Error(`${o} is not a valid CSS class name`);return o})}var Un={};Object.defineProperty(Un,"__esModule",{value:!0});var gc=U,bc=function(){function r(t,e){this.dt=t,this.ins=e,this.type="throttle",this.out=null,this.id=null}return r.prototype._start=function(t){this.out=t,this.ins._add(this)},r.prototype._stop=function(){this.ins._remove(this),this.out=null,this.id=null},r.prototype.clearInterval=function(){var t=this.id;t!==null&&clearInterval(t),this.id=null},r.prototype._n=function(t){var e=this,n=this.out;!n||this.id||(n._n(t),this.id=setInterval(function(){e.clearInterval()},this.dt))},r.prototype._e=function(t){var e=this.out;!e||(this.clearInterval(),e._e(t))},r.prototype._c=function(){var t=this.out;!t||(this.clearInterval(),t._c())},r}();function wc(r){return function(e){return new gc.Stream(new bc(r,e))}}Un.default=wc;var $t={},Sc=V&&V.__spreadArrays||function(){for(var r=0,t=0,e=arguments.length;t<e;t++)r+=arguments[t].length;for(var n=Array(r),o=0,t=0;t<e;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n};Object.defineProperty($t,"__esModule",{value:!0});$t.SampleCombineOperator=$t.SampleCombineListener=void 0;var $c=U,et={},Wn=function(){function r(t,e){this.i=t,this.p=e,e.ils[t]=this}return r.prototype._n=function(t){var e=this.p;e.out!==et&&e.up(t,this.i)},r.prototype._e=function(t){this.p._e(t)},r.prototype._c=function(){this.p.down(this.i,this)},r}();$t.SampleCombineListener=Wn;var Gn=function(){function r(t,e){this.type="sampleCombine",this.ins=t,this.others=e,this.out=et,this.ils=[],this.Nn=0,this.vals=[]}return r.prototype._start=function(t){this.out=t;for(var e=this.others,n=this.Nn=e.length,o=this.vals=new Array(n),i=0;i<n;i++)o[i]=et,e[i]._add(new Wn(i,this));this.ins._add(this)},r.prototype._stop=function(){var t=this.others,e=t.length,n=this.ils;this.ins._remove(this);for(var o=0;o<e;o++)t[o]._remove(n[o]);this.out=et,this.vals=[],this.ils=[]},r.prototype._n=function(t){var e=this.out;e!==et&&(this.Nn>0||e._n(Sc([t],this.vals)))},r.prototype._e=function(t){var e=this.out;e!==et&&e._e(t)},r.prototype._c=function(){var t=this.out;t!==et&&t._c()},r.prototype.up=function(t,e){var n=this.vals[e];this.Nn>0&&n===et&&this.Nn--,this.vals[e]=t},r.prototype.down=function(t,e){this.others[t]._remove(e)},r}();$t.SampleCombineOperator=Gn;var zn;zn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(o){return new $c.Stream(new Gn(o,t))}};$t.default=zn;var Wt=Object.prototype.hasOwnProperty,qn=Object.prototype.toString,Ar=Object.defineProperty,Er=Object.getOwnPropertyDescriptor,Pr=function(t){return typeof Array.isArray=="function"?Array.isArray(t):qn.call(t)==="[object Array]"},Nr=function(t){if(!t||qn.call(t)!=="[object Object]")return!1;var e=Wt.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&Wt.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!e&&!n)return!1;var o;for(o in t);return typeof o=="undefined"||Wt.call(t,o)},Cr=function(t,e){Ar&&e.name==="__proto__"?Ar(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},Ir=function(t,e){if(e==="__proto__")if(Wt.call(t,e)){if(Er)return Er(t,e).value}else return;return t[e]},Vn=function r(){var t,e,n,o,i,s,a=arguments[0],u=1,c=arguments.length,p=!1;for(typeof a=="boolean"&&(p=a,a=arguments[1]||{},u=2),(a==null||typeof a!="object"&&typeof a!="function")&&(a={});u<c;++u)if(t=arguments[u],t!=null)for(e in t)n=Ir(a,e),o=Ir(t,e),a!==o&&(p&&o&&(Nr(o)||(i=Pr(o)))?(i?(i=!1,s=n&&Pr(n)?n:[]):s=n&&Nr(n)?n:{},Cr(a,{name:e,newValue:r(p,s,o)})):typeof o!="undefined"&&Cr(a,{name:e,newValue:o}));return a};const Oc=r=>r===void 0,Ac=r=>typeof r=="number",Ec=r=>typeof r=="string",Hn=r=>Ec(r)||Ac(r),Pc=r=>Array.isArray(r),Nc=r=>typeof r=="object"&&r!==null,Cc=r=>typeof r=="function",Ic=r=>Nc(r)&&"sel"in r&&"data"in r&&"children"in r&&"text"in r,jc={svg:1,circle:1,ellipse:1,line:1,polygon:1,polyline:1,rect:1,g:1,path:1,text:1},Tc=r=>r.sel in jc,Ce=(...r)=>Vn(!0,...r),kc=(...r)=>Vn(!1,...r),Jn=(r,t,e)=>{let n=e;for(let o=0;o<r.length;o++){const i=r[o];Pc(i)?n=Jn(i,t,n):n=t(n,i)}return n},Be=(r,t)=>Object.keys(r).map(e=>t(e,r[e])).reduce((e,n)=>Ce(e,n),{}),xc=(r,t)=>Be(r,(e,n)=>{const o=e.indexOf("-");if(o>-1&&t[e.slice(0,o)]!==void 0){const i={[e.slice(o+1)]:n};return{[e.slice(0,o)]:i}}return{[e]:n}}),jr=(r,t)=>Be(t,(e,n)=>e!==r?{[e]:n}:{}),Dc=r=>Hn(r)?{text:r,sel:void 0,data:void 0,children:void 0,elm:void 0,key:void 0}:void 0,Ue=r=>Tc(r)?kc(r,{data:jr("props",Ce(r.data,{ns:"http://www.w3.org/2000/svg",attrs:jr("className",Ce(r.data.props,{class:r.data.props?r.data.props.className:void 0}))}))},{children:Oc(r.children)?void 0:r.children.map(t=>Ue(t))}):r,ot={for:"attrs",role:"attrs",tabindex:"attrs","aria-*":"attrs",key:null},Mc=(r,t)=>Be(r,(e,n)=>{const o={[e]:n};if(ot[e]&&t[ot[e]]!==void 0)return{[ot[e]]:o};if(ot[e]===null)return{};const i=Object.keys(ot);for(let s=0;s<i.length;s++){const a=i[s];if(a.charAt(a.length-1)==="*"&&e.indexOf(a.slice(0,-1))===0&&t[ot[a]]!==void 0)return{[ot[a]]:o}}return t[e]!==void 0?{[t[e]?t[e]:e]:n}:t.props!==void 0?{props:o}:o}),Fc=(r,t)=>Ue(Mc(xc(r,t),t)),Lc=r=>r.length>1||!Hn(r[0])?void 0:r[0].toString(),Rc=r=>Jn(r,(t,e)=>{const n=Ic(e)?e:Dc(e);return t.push(n),t},[]),Bc={attrs:"",props:"",class:"",data:"dataset",style:"",hook:"",on:""},Uc=r=>(t,e,...n)=>{if(typeof t=="undefined"&&(t="UNDEFINED",cnosole.error("JSX Error: Capitalized HTML element without corresponding Sygnal factory.  Components with names where the first letter is capital MUST be defined or included at the parent component's file scope.")),Cc(t)){if(t.name==="Fragment")return t(e||{},n);const i=t;t=t.name||"sygnal-factory",e||(e={}),e.sygnalFactory=i}const o=Lc(n);return Ue({sel:t,data:e?Fc(e,r):{},children:typeof o!="undefined"?void 0:Rc(n),text:o,elm:void 0,key:e?e.key:void 0})},L=Uc(Bc);function Wc(r,t,e,n,o){const i=t===void 0?void 0:t.key;return{sel:r,data:t,children:e,text:n,elm:o,key:i}}Wc("",{},[],void 0,void 0);typeof window!="undefined"&&window.requestAnimationFrame.bind(window);let Gc=0;function zc(r){const t=new Array(16).fill().map((c,p)=>p),e=r.filter(c=>!c.deleted).map(c=>c.row*4+c.column),n=t.filter(c=>!e.includes(c));if(n.length===0)return r;const o=Math.floor(Math.random()*n.length),i=n[o],s=i%4,a=Math.floor(i/4),u=Math.ceil(Math.random()*1e3)<900?2:4;return[...r,{id:Gc++,value:u,row:a,column:s,new:!0}]}function Ie(r,t){let e,n,o,i,s;t=="UP"||t=="DOWN"?(e="column",n="row"):(e="row",n="column"),t=="UP"||t=="LEFT"?(o=0,i=3,s=1):(o=3,i=0,s=-1);const a=r.filter(p=>!p.deleted),u=[];let c=!1;for(let p=0;p<=3;p++){let h=null,y=o;for(let d=o;s==1?d<=i:d>=i;d+=s){const l=a.find(f=>f[e]===p&&f[n]===d);if(l){const f=l[n];if(l[n]=y,h!==null&&!h.merged&&l.value===h.value){const v=l.value*2;l.value=v,h.value=v,l[n]-=s,l.merged=!0,c=!0}else c=c||y!==f,y+=s;const m={id:l.id,value:l.value,row:l.row,column:l.column,merged:l.merged};h=m,u.push(m)}}}if(c){const p=r.map(h=>u.find(y=>y.id===h.id)||h);return p.forEach(h=>{h.deleted=h.deleted||h.merged,delete h.merged}),p}return!1}function qc(r){const t=r.map(o=>I({},o));let e=Ie(t,"UP"),n=Ie(t,"LEFT");return!(!e&&!n)}const Tr=100;var Vc=kn({name:"TILE",model:{DELETE:r=>{}},intent:({STATE:r})=>({DELETE:r.stream.filter(n=>n.deleted).compose(Pe(Tr))}),view:({state:r})=>{const{id:t,value:e,row:n,column:o,deleted:i}=r,s=mc("tile",`tile-${t}`,{new:!!r.new}),a=Math.log2(r.value||0),u=Math.floor(50*a/11+30),c={"--row":`       ${n}`,"--col":`       ${o}`,"--tile-color":`${u}%`,"--duration":`${Tr}ms`,zIndex:i?10:1};return L("div",{className:s,id:`tile-${t}`,style:c},e)}});const Hc="ArrowUp",Jc="ArrowDown",Kc="ArrowLeft",Yc="ArrowRight",Xc=120,kr={tiles:[],over:!1,max:2,score:0,locked:!1};var Zc=kn({name:"BOARD",initialState:kr,calculated:{max:r=>r.tiles.filter(t=>t&&!t.deleted).reduce((t,e)=>t>e.value?t:e.value,0),lost:r=>!r.over&&r.tiles.filter(t=>!t.deleted).length===16&&!qc(r.tiles)},model:{RESTART:(r,t,e)=>(e("ADD_TILE"),e("ADD_TILE"),I({},kr)),MOVE:(r,t,e)=>{if(r.locked||r.over)return Xt;const n=Ie(r.tiles,t);if(!n)return Xt;const o=n.filter(i=>i.deleted).reduce((i,s)=>i+s.value,0);return setTimeout(i=>{e("ADD_TILE")},Xc),T(I({},r),{tiles:n,score:r.score+o,locked:!0})},ADD_TILE:(r,t)=>{const e=zc(r.tiles);return T(I({},r),{tiles:e,locked:!1})},GAME_OVER:(r,t)=>T(I({},r),{over:!0,won:t})},intent:({STATE:r,DOM:t})=>{const e=t.select("document").events("keydown").map(l=>l.key),n=l=>f=>f===l,o=e.filter(n(Hc)).mapTo("UP"),i=e.filter(n(Jc)).mapTo("DOWN"),s=e.filter(n(Kc)).mapTo("LEFT"),a=e.filter(n(Yc)).mapTo("RIGHT"),u=$.merge(o,i,s,a),c=r.stream.filter(l=>!l.over&&l.max===2048).mapTo(!0),p=r.stream.filter(l=>l.lost===!0).mapTo(!1),h=$.merge(c,p),y=t.select(".restart, .gameover").events("click"),d=$.fromArray([1,2]);return{RESTART:y,GAME_OVER:h,MOVE:u,ADD_TILE:d}},view:({state:r})=>{const{score:t,max:e,over:n,won:o}=r;return L("div",{className:"container"},L("h1",null,"Sygnal 2048"),L("div",{className:"info"},L("div",{className:"largest"},"Largest: ",e),L("div",{className:"score"},"Score: ",t)),L("div",{className:"board-container"},L("div",{className:"slot-board"},Array(16).fill().map(i=>L("div",{className:"slot"}))),L("collection",{of:Vc,from:"tiles",className:"tile-board"}),n&&o&&L("div",{className:"gameover won"},L("span",{className:"won-message"},"YOU WON!!")),n&&!o&&L("div",{className:"gameover lost"},L("span",{className:"lost-message"},"GAME OVER"))),L("div",{className:"restart-container"},L("input",{type:"button",className:"restart",value:"Start Over"})))}});yc(Zc);
