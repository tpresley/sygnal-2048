var Bn=Object.defineProperty,Un=Object.defineProperties;var Wn=Object.getOwnPropertyDescriptors;var qe=Object.getOwnPropertySymbols;var qn=Object.prototype.hasOwnProperty,Gn=Object.prototype.propertyIsEnumerable;var Ge=(e,t,r)=>t in e?Bn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,vt=(e,t)=>{for(var r in t||(t={}))qn.call(t,r)&&Ge(e,r,t[r]);if(qe)for(var r of qe(t))Gn.call(t,r)&&Ge(e,r,t[r]);return e},Ft=(e,t)=>Un(e,Wn(t));const zn=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}};zn();var K=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},G={},Dr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=t;function t(r){var n,o=r.Symbol;if(typeof o=="function")if(o.observable)n=o.observable;else{n=o.for("https://github.com/benlesh/symbol-observable");try{o.observable=n}catch{}}else n="@@observable";return n}})(Dr);var Hn=Dr,ze=Object.prototype.toString,kr=function(t){var r=ze.call(t),n=r==="[object Arguments]";return n||(n=r!=="[object Array]"&&t!==null&&typeof t=="object"&&typeof t.length=="number"&&t.length>=0&&ze.call(t.callee)==="[object Function]"),n},xr;if(!Object.keys){var Rt=Object.prototype.hasOwnProperty,He=Object.prototype.toString,Vn=kr,Ve=Object.prototype.propertyIsEnumerable,Kn=!Ve.call({toString:null},"toString"),Jn=Ve.call(function(){},"prototype"),Bt=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],ae=function(e){var t=e.constructor;return t&&t.prototype===e},Yn={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},Xn=function(){if(typeof window=="undefined")return!1;for(var e in window)try{if(!Yn["$"+e]&&Rt.call(window,e)&&window[e]!==null&&typeof window[e]=="object")try{ae(window[e])}catch{return!0}}catch{return!0}return!1}(),Zn=function(e){if(typeof window=="undefined"||!Xn)return ae(e);try{return ae(e)}catch{return!1}};xr=function(t){var r=t!==null&&typeof t=="object",n=He.call(t)==="[object Function]",o=Vn(t),i=r&&He.call(t)==="[object String]",a=[];if(!r&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var s=Jn&&n;if(i&&t.length>0&&!Rt.call(t,0))for(var u=0;u<t.length;++u)a.push(String(u));if(o&&t.length>0)for(var l=0;l<t.length;++l)a.push(String(l));else for(var p in t)!(s&&p==="prototype")&&Rt.call(t,p)&&a.push(String(p));if(Kn)for(var c=Zn(t),h=0;h<Bt.length;++h)!(c&&Bt[h]==="constructor")&&Rt.call(t,Bt[h])&&a.push(Bt[h]);return a}}var Qn=xr,to=Array.prototype.slice,eo=kr,Ke=Object.keys,Gt=Ke?function(t){return Ke(t)}:Qn,Je=Object.keys;Gt.shim=function(){if(Object.keys){var t=function(){var r=Object.keys(arguments);return r&&r.length===arguments.length}(1,2);t||(Object.keys=function(n){return eo(n)?Je(to.call(n)):Je(n)})}else Object.keys=Gt;return Object.keys||Gt};var ro=Gt,no=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var o=42;t[r]=o;for(r in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var i=Object.getOwnPropertySymbols(t);if(i.length!==1||i[0]!==r||!Object.prototype.propertyIsEnumerable.call(t,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(t,r);if(a.value!==o||a.enumerable!==!0)return!1}return!0},Ye=typeof Symbol!="undefined"&&Symbol,oo=no,io=function(){return typeof Ye!="function"||typeof Symbol!="function"||typeof Ye("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:oo()},ao="Function.prototype.bind called on incompatible ",se=Array.prototype.slice,so=Object.prototype.toString,uo="[object Function]",fo=function(t){var r=this;if(typeof r!="function"||so.call(r)!==uo)throw new TypeError(ao+r);for(var n=se.call(arguments,1),o,i=function(){if(this instanceof o){var p=r.apply(this,n.concat(se.call(arguments)));return Object(p)===p?p:this}else return r.apply(t,n.concat(se.call(arguments)))},a=Math.max(0,r.length-n.length),s=[],u=0;u<a;u++)s.push("$"+u);if(o=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(i),r.prototype){var l=function(){};l.prototype=r.prototype,o.prototype=new l,l.prototype=null}return o},co=fo,Mr=Function.prototype.bind||co,lo=Mr,po=lo.call(Function.call,Object.prototype.hasOwnProperty),I,xt=SyntaxError,jr=Function,wt=TypeError,ue=function(e){try{return jr('"use strict"; return ('+e+").constructor;")()}catch{}},dt=Object.getOwnPropertyDescriptor;if(dt)try{dt({},"")}catch{dt=null}var fe=function(){throw new wt},ho=dt?function(){try{return arguments.callee,fe}catch{try{return dt(arguments,"callee").get}catch{return fe}}}():fe,yt=io(),ut=Object.getPrototypeOf||function(e){return e.__proto__},bt={},vo=typeof Uint8Array=="undefined"?I:ut(Uint8Array),St={"%AggregateError%":typeof AggregateError=="undefined"?I:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?I:ArrayBuffer,"%ArrayIteratorPrototype%":yt?ut([][Symbol.iterator]()):I,"%AsyncFromSyncIteratorPrototype%":I,"%AsyncFunction%":bt,"%AsyncGenerator%":bt,"%AsyncGeneratorFunction%":bt,"%AsyncIteratorPrototype%":bt,"%Atomics%":typeof Atomics=="undefined"?I:Atomics,"%BigInt%":typeof BigInt=="undefined"?I:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?I:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?I:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?I:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?I:FinalizationRegistry,"%Function%":jr,"%GeneratorFunction%":bt,"%Int8Array%":typeof Int8Array=="undefined"?I:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?I:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?I:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":yt?ut(ut([][Symbol.iterator]())):I,"%JSON%":typeof JSON=="object"?JSON:I,"%Map%":typeof Map=="undefined"?I:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!yt?I:ut(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?I:Promise,"%Proxy%":typeof Proxy=="undefined"?I:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?I:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?I:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!yt?I:ut(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?I:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":yt?ut(""[Symbol.iterator]()):I,"%Symbol%":yt?Symbol:I,"%SyntaxError%":xt,"%ThrowTypeError%":ho,"%TypedArray%":vo,"%TypeError%":wt,"%Uint8Array%":typeof Uint8Array=="undefined"?I:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?I:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?I:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?I:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?I:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?I:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?I:WeakSet},yo=function e(t){var r;if(t==="%AsyncFunction%")r=ue("async function () {}");else if(t==="%GeneratorFunction%")r=ue("function* () {}");else if(t==="%AsyncGeneratorFunction%")r=ue("async function* () {}");else if(t==="%AsyncGenerator%"){var n=e("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(t==="%AsyncIteratorPrototype%"){var o=e("%AsyncGenerator%");o&&(r=ut(o.prototype))}return St[t]=r,r},Xe={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},re=Mr,Jt=po,mo=re.call(Function.call,Array.prototype.concat),go=re.call(Function.apply,Array.prototype.splice),Ze=re.call(Function.call,String.prototype.replace),Yt=re.call(Function.call,String.prototype.slice),bo=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,_o=/\\(\\)?/g,wo=function(t){var r=Yt(t,0,1),n=Yt(t,-1);if(r==="%"&&n!=="%")throw new xt("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new xt("invalid intrinsic syntax, expected opening `%`");var o=[];return Ze(t,bo,function(i,a,s,u){o[o.length]=s?Ze(u,_o,"$1"):a||i}),o},So=function(t,r){var n=t,o;if(Jt(Xe,n)&&(o=Xe[n],n="%"+o[0]+"%"),Jt(St,n)){var i=St[n];if(i===bt&&(i=yo(n)),typeof i=="undefined"&&!r)throw new wt("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:o,name:n,value:i}}throw new xt("intrinsic "+t+" does not exist!")},Oo=function(t,r){if(typeof t!="string"||t.length===0)throw new wt("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new wt('"allowMissing" argument must be a boolean');var n=wo(t),o=n.length>0?n[0]:"",i=So("%"+o+"%",r),a=i.name,s=i.value,u=!1,l=i.alias;l&&(o=l[0],go(n,mo([0,1],l)));for(var p=1,c=!0;p<n.length;p+=1){var h=n[p],g=Yt(h,0,1),f=Yt(h,-1);if((g==='"'||g==="'"||g==="`"||f==='"'||f==="'"||f==="`")&&g!==f)throw new xt("property names with quotes must have matching quotes");if((h==="constructor"||!c)&&(u=!0),o+="."+h,a="%"+o+"%",Jt(St,a))s=St[a];else if(s!=null){if(!(h in s)){if(!r)throw new wt("base intrinsic for "+t+" exists, but the property is not available.");return}if(dt&&p+1>=n.length){var d=dt(s,h);c=!!d,c&&"get"in d&&!("originalValue"in d.get)?s=d.get:s=s[h]}else c=Jt(s,h),s=s[h];c&&!u&&(St[a]=s)}}return s},Ao=Oo,me=Ao("%Object.defineProperty%",!0),ge=function(){if(me)try{return me({},"a",{value:1}),!0}catch{return!1}return!1};ge.hasArrayLengthDefineBug=function(){if(!ge())return null;try{return me([],"length",{value:1}).length!==1}catch{return!0}};var $o=ge,Eo=ro,No=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",Po=Object.prototype.toString,Io=Array.prototype.concat,Lr=Object.defineProperty,Co=function(e){return typeof e=="function"&&Po.call(e)==="[object Function]"},To=$o(),Fr=Lr&&To,Do=function(e,t,r,n){t in e&&(!Co(n)||!n())||(Fr?Lr(e,t,{configurable:!0,enumerable:!1,value:r,writable:!0}):e[t]=r)},Rr=function(e,t){var r=arguments.length>2?arguments[2]:{},n=Eo(t);No&&(n=Io.call(n,Object.getOwnPropertySymbols(t)));for(var o=0;o<n.length;o+=1)Do(e,n[o],t[n[o]],r[n[o]])};Rr.supportsDescriptors=!!Fr;var Br=Rr,Dt={exports:{}};typeof self!="undefined"?Dt.exports=self:typeof window!="undefined"?Dt.exports=window:Dt.exports=Function("return this")();var ko=Dt.exports,Ur=function(){return typeof K!="object"||!K||K.Math!==Math||K.Array!==Array?ko:K},xo=Br,Mo=Ur,jo=function(){var t=Mo();if(xo.supportsDescriptors){var r=Object.getOwnPropertyDescriptor(t,"globalThis");(!r||r.configurable&&(r.enumerable||!r.writable||globalThis!==t))&&Object.defineProperty(t,"globalThis",{configurable:!0,enumerable:!1,value:t,writable:!0})}else(typeof globalThis!="object"||globalThis!==t)&&(t.globalThis=t);return t},Lo=Br,Fo=Dt.exports,Wr=Ur,Ro=jo,Bo=Wr(),qr=function(){return Bo};Lo(qr,{getPolyfill:Wr,implementation:Fo,shim:Ro});var Uo=qr,Wo=K&&K.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)o.hasOwnProperty(i)&&(n[i]=o[i])},e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(G,"__esModule",{value:!0});G.NO_IL=ke=G.NO=G.MemoryStream=Q=G.Stream=void 0;var qo=Hn,Go=Uo,Ut=qo.default(Go.getPolyfill()),m={},ke=G.NO=m;function q(){}function zt(e){for(var t=e.length,r=Array(t),n=0;n<t;++n)r[n]=e[n];return r}function zo(e,t){return function(n){return e(n)&&t(n)}}function xe(e,t,r){try{return e.f(t)}catch(n){return r._e(n),m}}var pt={_n:q,_e:q,_c:q};G.NO_IL=pt;function Qe(e){e._start=function(r){r.next=r._n,r.error=r._e,r.complete=r._c,this.start(r)},e._stop=e.stop}var Ho=function(){function e(t,r){this._stream=t,this._listener=r}return e.prototype.unsubscribe=function(){this._stream._remove(this._listener)},e}(),Vo=function(){function e(t){this._listener=t}return e.prototype.next=function(t){this._listener._n(t)},e.prototype.error=function(t){this._listener._e(t)},e.prototype.complete=function(){this._listener._c()},e}(),Ko=function(){function e(t){this.type="fromObservable",this.ins=t,this.active=!1}return e.prototype._start=function(t){this.out=t,this.active=!0,this._sub=this.ins.subscribe(new Vo(t)),this.active||this._sub.unsubscribe()},e.prototype._stop=function(){this._sub&&this._sub.unsubscribe(),this.active=!1},e}(),Jo=function(){function e(t){this.type="merge",this.insArr=t,this.out=m,this.ac=0}return e.prototype._start=function(t){this.out=t;var r=this.insArr,n=r.length;this.ac=n;for(var o=0;o<n;o++)r[o]._add(this)},e.prototype._stop=function(){for(var t=this.insArr,r=t.length,n=0;n<r;n++)t[n]._remove(this);this.out=m},e.prototype._n=function(t){var r=this.out;r!==m&&r._n(t)},e.prototype._e=function(t){var r=this.out;r!==m&&r._e(t)},e.prototype._c=function(){if(--this.ac<=0){var t=this.out;if(t===m)return;t._c()}},e}(),Yo=function(){function e(t,r,n){this.i=t,this.out=r,this.p=n,n.ils.push(this)}return e.prototype._n=function(t){var r=this.p,n=this.out;if(n!==m&&r.up(t,this.i)){var o=zt(r.vals);n._n(o)}},e.prototype._e=function(t){var r=this.out;r!==m&&r._e(t)},e.prototype._c=function(){var t=this.p;t.out!==m&&--t.Nc===0&&t.out._c()},e}(),Xo=function(){function e(t){this.type="combine",this.insArr=t,this.out=m,this.ils=[],this.Nc=this.Nn=0,this.vals=[]}return e.prototype.up=function(t,r){var n=this.vals[r],o=this.Nn?n===m?--this.Nn:this.Nn:0;return this.vals[r]=t,o===0},e.prototype._start=function(t){this.out=t;var r=this.insArr,n=this.Nc=this.Nn=r.length,o=this.vals=new Array(n);if(n===0)t._n([]),t._c();else for(var i=0;i<n;i++)o[i]=m,r[i]._add(new Yo(i,t,this))},e.prototype._stop=function(){for(var t=this.insArr,r=t.length,n=this.ils,o=0;o<r;o++)t[o]._remove(n[o]);this.out=m,this.ils=[],this.vals=[]},e}(),Zo=function(){function e(t){this.type="fromArray",this.a=t}return e.prototype._start=function(t){for(var r=this.a,n=0,o=r.length;n<o;n++)t._n(r[n]);t._c()},e.prototype._stop=function(){},e}(),Qo=function(){function e(t){this.type="fromPromise",this.on=!1,this.p=t}return e.prototype._start=function(t){var r=this;this.on=!0,this.p.then(function(n){r.on&&(t._n(n),t._c())},function(n){t._e(n)}).then(q,function(n){setTimeout(function(){throw n})})},e.prototype._stop=function(){this.on=!1},e}(),ti=function(){function e(t){this.type="periodic",this.period=t,this.intervalID=-1,this.i=0}return e.prototype._start=function(t){var r=this;function n(){t._n(r.i++)}this.intervalID=setInterval(n,this.period)},e.prototype._stop=function(){this.intervalID!==-1&&clearInterval(this.intervalID),this.intervalID=-1,this.i=0},e}(),ei=function(){function e(t,r){this.type="debug",this.ins=t,this.out=m,this.s=q,this.l="",typeof r=="string"?this.l=r:typeof r=="function"&&(this.s=r)}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=m},e.prototype._n=function(t){var r=this.out;if(r!==m){var n=this.s,o=this.l;if(n!==q)try{n(t)}catch(i){r._e(i)}else o?console.log(o+":",t):console.log(t);r._n(t)}},e.prototype._e=function(t){var r=this.out;r!==m&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==m&&t._c()},e}(),ri=function(){function e(t,r){this.type="drop",this.ins=r,this.out=m,this.max=t,this.dropped=0}return e.prototype._start=function(t){this.out=t,this.dropped=0,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=m},e.prototype._n=function(t){var r=this.out;r!==m&&this.dropped++>=this.max&&r._n(t)},e.prototype._e=function(t){var r=this.out;r!==m&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==m&&t._c()},e}(),ni=function(){function e(t,r){this.out=t,this.op=r}return e.prototype._n=function(){this.op.end()},e.prototype._e=function(t){this.out._e(t)},e.prototype._c=function(){this.op.end()},e}(),oi=function(){function e(t,r){this.type="endWhen",this.ins=r,this.out=m,this.o=t,this.oil=pt}return e.prototype._start=function(t){this.out=t,this.o._add(this.oil=new ni(t,this)),this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.o._remove(this.oil),this.out=m,this.oil=pt},e.prototype.end=function(){var t=this.out;t!==m&&t._c()},e.prototype._n=function(t){var r=this.out;r!==m&&r._n(t)},e.prototype._e=function(t){var r=this.out;r!==m&&r._e(t)},e.prototype._c=function(){this.end()},e}(),ce=function(){function e(t,r){this.type="filter",this.ins=r,this.out=m,this.f=t}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=m},e.prototype._n=function(t){var r=this.out;if(r!==m){var n=xe(this,t,r);n===m||!n||r._n(t)}},e.prototype._e=function(t){var r=this.out;r!==m&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==m&&t._c()},e}(),ii=function(){function e(t,r){this.out=t,this.op=r}return e.prototype._n=function(t){this.out._n(t)},e.prototype._e=function(t){this.out._e(t)},e.prototype._c=function(){this.op.inner=m,this.op.less()},e}(),ai=function(){function e(t){this.type="flatten",this.ins=t,this.out=m,this.open=!0,this.inner=m,this.il=pt}return e.prototype._start=function(t){this.out=t,this.open=!0,this.inner=m,this.il=pt,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.inner!==m&&this.inner._remove(this.il),this.out=m,this.open=!0,this.inner=m,this.il=pt},e.prototype.less=function(){var t=this.out;t!==m&&!this.open&&this.inner===m&&t._c()},e.prototype._n=function(t){var r=this.out;if(r!==m){var n=this,o=n.inner,i=n.il;o!==m&&i!==pt&&o._remove(i),(this.inner=t)._add(this.il=new ii(r,this))}},e.prototype._e=function(t){var r=this.out;r!==m&&r._e(t)},e.prototype._c=function(){this.open=!1,this.less()},e}(),si=function(){function e(t,r,n){var o=this;this.type="fold",this.ins=n,this.out=m,this.f=function(i){return t(o.acc,i)},this.acc=this.seed=r}return e.prototype._start=function(t){this.out=t,this.acc=this.seed,t._n(this.acc),this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=m,this.acc=this.seed},e.prototype._n=function(t){var r=this.out;if(r!==m){var n=xe(this,t,r);n!==m&&r._n(this.acc=n)}},e.prototype._e=function(t){var r=this.out;r!==m&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==m&&t._c()},e}(),ui=function(){function e(t){this.type="last",this.ins=t,this.out=m,this.has=!1,this.val=m}return e.prototype._start=function(t){this.out=t,this.has=!1,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=m,this.val=m},e.prototype._n=function(t){this.has=!0,this.val=t},e.prototype._e=function(t){var r=this.out;r!==m&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==m&&(this.has?(t._n(this.val),t._c()):t._e(new Error("last() failed because input stream completed")))},e}(),fi=function(){function e(t,r){this.type="map",this.ins=r,this.out=m,this.f=t}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=m},e.prototype._n=function(t){var r=this.out;if(r!==m){var n=xe(this,t,r);n!==m&&r._n(n)}},e.prototype._e=function(t){var r=this.out;r!==m&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==m&&t._c()},e}(),ci=function(){function e(t){this.type="remember",this.ins=t,this.out=m}return e.prototype._start=function(t){this.out=t,this.ins._add(t)},e.prototype._stop=function(){this.ins._remove(this.out),this.out=m},e}(),li=function(){function e(t,r){this.type="replaceError",this.ins=r,this.out=m,this.f=t}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=m},e.prototype._n=function(t){var r=this.out;r!==m&&r._n(t)},e.prototype._e=function(t){var r=this.out;if(r!==m)try{this.ins._remove(this),(this.ins=this.f(t))._add(this)}catch(n){r._e(n)}},e.prototype._c=function(){var t=this.out;t!==m&&t._c()},e}(),pi=function(){function e(t,r){this.type="startWith",this.ins=t,this.out=m,this.val=r}return e.prototype._start=function(t){this.out=t,this.out._n(this.val),this.ins._add(t)},e.prototype._stop=function(){this.ins._remove(this.out),this.out=m},e}(),di=function(){function e(t,r){this.type="take",this.ins=r,this.out=m,this.max=t,this.taken=0}return e.prototype._start=function(t){this.out=t,this.taken=0,this.max<=0?t._c():this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=m},e.prototype._n=function(t){var r=this.out;if(r!==m){var n=++this.taken;n<this.max?r._n(t):n===this.max&&(r._n(t),r._c())}},e.prototype._e=function(t){var r=this.out;r!==m&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==m&&t._c()},e}(),Me=function(){function e(t){this._prod=t||m,this._ils=[],this._stopID=m,this._dl=m,this._d=!1,this._target=null,this._err=m}return e.prototype._n=function(t){var r=this._ils,n=r.length;if(this._d&&this._dl._n(t),n==1)r[0]._n(t);else{if(n==0)return;for(var o=zt(r),i=0;i<n;i++)o[i]._n(t)}},e.prototype._e=function(t){if(this._err===m){this._err=t;var r=this._ils,n=r.length;if(this._x(),this._d&&this._dl._e(t),n==1)r[0]._e(t);else{if(n==0)return;for(var o=zt(r),i=0;i<n;i++)o[i]._e(t)}if(!this._d&&n==0)throw this._err}},e.prototype._c=function(){var t=this._ils,r=t.length;if(this._x(),this._d&&this._dl._c(),r==1)t[0]._c();else{if(r==0)return;for(var n=zt(t),o=0;o<r;o++)n[o]._c()}},e.prototype._x=function(){this._ils.length!==0&&(this._prod!==m&&this._prod._stop(),this._err=m,this._ils=[])},e.prototype._stopNow=function(){this._prod._stop(),this._err=m,this._stopID=m},e.prototype._add=function(t){var r=this._target;if(r)return r._add(t);var n=this._ils;if(n.push(t),!(n.length>1))if(this._stopID!==m)clearTimeout(this._stopID),this._stopID=m;else{var o=this._prod;o!==m&&o._start(this)}},e.prototype._remove=function(t){var r=this,n=this._target;if(n)return n._remove(t);var o=this._ils,i=o.indexOf(t);i>-1&&(o.splice(i,1),this._prod!==m&&o.length<=0?(this._err=m,this._stopID=setTimeout(function(){return r._stopNow()})):o.length===1&&this._pruneCycles())},e.prototype._pruneCycles=function(){this._hasNoSinks(this,[])&&this._remove(this._ils[0])},e.prototype._hasNoSinks=function(t,r){if(r.indexOf(t)!==-1)return!0;if(t.out===this)return!0;if(t.out&&t.out!==m)return this._hasNoSinks(t.out,r.concat(t));if(t._ils){for(var n=0,o=t._ils.length;n<o;n++)if(!this._hasNoSinks(t._ils[n],r.concat(t)))return!1;return!0}else return!1},e.prototype.ctor=function(){return this instanceof it?it:e},e.prototype.addListener=function(t){t._n=t.next||q,t._e=t.error||q,t._c=t.complete||q,this._add(t)},e.prototype.removeListener=function(t){this._remove(t)},e.prototype.subscribe=function(t){return this.addListener(t),new Ho(this,t)},e.prototype[Ut]=function(){return this},e.create=function(t){if(t){if(typeof t.start!="function"||typeof t.stop!="function")throw new Error("producer requires both start and stop functions");Qe(t)}return new e(t)},e.createWithMemory=function(t){return t&&Qe(t),new it(t)},e.never=function(){return new e({_start:q,_stop:q})},e.empty=function(){return new e({_start:function(t){t._c()},_stop:q})},e.throw=function(t){return new e({_start:function(r){r._e(t)},_stop:q})},e.from=function(t){if(typeof t[Ut]=="function")return e.fromObservable(t);if(typeof t.then=="function")return e.fromPromise(t);if(Array.isArray(t))return e.fromArray(t);throw new TypeError("Type of input to from() must be an Array, Promise, or Observable")},e.of=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.fromArray(t)},e.fromArray=function(t){return new e(new Zo(t))},e.fromPromise=function(t){return new e(new Qo(t))},e.fromObservable=function(t){if(t.endWhen!==void 0)return t;var r=typeof t[Ut]=="function"?t[Ut]():t;return new e(new Ko(r))},e.periodic=function(t){return new e(new ti(t))},e.prototype._map=function(t){return new(this.ctor())(new fi(t,this))},e.prototype.map=function(t){return this._map(t)},e.prototype.mapTo=function(t){var r=this.map(function(){return t}),n=r._prod;return n.type="mapTo",r},e.prototype.filter=function(t){var r=this._prod;return r instanceof ce?new e(new ce(zo(r.f,t),r.ins)):new e(new ce(t,this))},e.prototype.take=function(t){return new(this.ctor())(new di(t,this))},e.prototype.drop=function(t){return new e(new ri(t,this))},e.prototype.last=function(){return new e(new ui(this))},e.prototype.startWith=function(t){return new it(new pi(this,t))},e.prototype.endWhen=function(t){return new(this.ctor())(new oi(t,this))},e.prototype.fold=function(t,r){return new it(new si(t,r,this))},e.prototype.replaceError=function(t){return new(this.ctor())(new li(t,this))},e.prototype.flatten=function(){return new e(new ai(this))},e.prototype.compose=function(t){return t(this)},e.prototype.remember=function(){return new it(new ci(this))},e.prototype.debug=function(t){return new(this.ctor())(new ei(this,t))},e.prototype.imitate=function(t){if(t instanceof it)throw new Error("A MemoryStream was given to imitate(), but it only supports a Stream. Read more about this restriction here: https://github.com/staltz/xstream#faq");this._target=t;for(var r=this._ils,n=r.length,o=0;o<n;o++)t._add(r[o]);this._ils=[]},e.prototype.shamefullySendNext=function(t){this._n(t)},e.prototype.shamefullySendError=function(t){this._e(t)},e.prototype.shamefullySendComplete=function(){this._c()},e.prototype.setDebugListener=function(t){t?(this._d=!0,t._n=t.next||q,t._e=t.error||q,t._c=t.complete||q,this._dl=t):(this._d=!1,this._dl=m)},e.merge=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new e(new Jo(r))},e.combine=function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new e(new Xo(r))},e}(),Q=G.Stream=Me,it=function(e){Wo(t,e);function t(r){var n=e.call(this,r)||this;return n._has=!1,n}return t.prototype._n=function(r){this._v=r,this._has=!0,e.prototype._n.call(this,r)},t.prototype._add=function(r){var n=this._target;if(n)return n._add(r);var o=this._ils;if(o.push(r),o.length>1){this._has&&r._n(this._v);return}if(this._stopID!==m)this._has&&r._n(this._v),clearTimeout(this._stopID),this._stopID=m;else if(this._has)r._n(this._v);else{var i=this._prod;i!==m&&i._start(this)}},t.prototype._stopNow=function(){this._has=!1,e.prototype._stopNow.call(this)},t.prototype._x=function(){this._has=!1,e.prototype._x.call(this)},t.prototype.map=function(r){return this._map(r)},t.prototype.mapTo=function(r){return e.prototype.mapTo.call(this,r)},t.prototype.take=function(r){return e.prototype.take.call(this,r)},t.prototype.endWhen=function(r){return e.prototype.endWhen.call(this,r)},t.prototype.replaceError=function(r){return e.prototype.replaceError.call(this,r)},t.prototype.remember=function(){return this},t.prototype.debug=function(r){return e.prototype.debug.call(this,r)},t}(Me);G.MemoryStream=it;var hi=Me,S=G.default=hi,je={};Object.defineProperty(je,"__esModule",{value:!0});function Gr(){var e;return typeof window!="undefined"?e=window:typeof K!="undefined"?e=K:e=this,e.Cyclejs=e.Cyclejs||{},e=e.Cyclejs,e.adaptStream=e.adaptStream||function(t){return t},e}function vi(e){Gr().adaptStream=e}je.setAdapt=vi;function yi(e){return Gr().adaptStream(e)}var H=je.adapt=yi;function mi(e,t){if(typeof e!="function")throw new Error("First argument given to isolate() must be a 'dataflowComponent' function");if(t===null)throw new Error("Second argument given to isolate() must not be null")}function gi(e,t,r){var n={};return Object.keys(e).forEach(function(o){if(typeof t=="string"){n[o]=t;return}var i=t[o];if(typeof i!="undefined"){n[o]=i;return}var a=t["*"];if(typeof a!="undefined"){n[o]=a;return}n[o]=r}),n}function bi(e,t){var r={};for(var n in e){var o=e[n];e.hasOwnProperty(n)&&o&&t[n]!==null&&typeof o.isolateSource=="function"?r[n]=o.isolateSource(o,t[n]):e.hasOwnProperty(n)&&(r[n]=e[n])}return r}function _i(e,t,r){var n={};for(var o in t){var i=e[o],a=t[o];t.hasOwnProperty(o)&&i&&r[o]!==null&&typeof i.isolateSink=="function"?n[o]=H(i.isolateSink(S.fromObservable(a),r[o])):t.hasOwnProperty(o)&&(n[o]=t[o])}return n}var zr=0;function tr(){return"cycle"+ ++zr}function ht(e,t){t===void 0&&(t=tr()),mi(e,t);var r=typeof t=="object"?tr():"",n=typeof t=="string"||typeof t=="object"?t:t.toString();return function(i){for(var a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];var u=gi(i,n,r),l=bi(i,u),p=e.apply(void 0,[l].concat(a)),c=_i(i,p,u);return c}}ht.reset=function(){return zr=0};var ne={};Object.defineProperty(ne,"__esModule",{value:!0});ne.DropRepeatsOperator=void 0;var wi=G,le={},Hr=function(){function e(t,r){this.ins=t,this.type="dropRepeats",this.out=null,this.v=le,this.isEq=r||function(n,o){return n===o}}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=null,this.v=le},e.prototype._n=function(t){var r=this.out;if(!!r){var n=this.v;n!==le&&this.isEq(t,n)||(this.v=t,r._n(t))}},e.prototype._e=function(t){var r=this.out;!r||r._e(t)},e.prototype._c=function(){var t=this.out;!t||t._c()},e}();ne.DropRepeatsOperator=Hr;function Si(e){return e===void 0&&(e=void 0),function(r){return new wi.Stream(new Hr(r,e))}}var Mt=ne.default=Si,be=globalThis&&globalThis.__assign||function(){return be=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},be.apply(this,arguments)};function Oi(e,t,r){if(r===e[t])return e;var n=parseInt(t);return typeof r=="undefined"?e.filter(function(o,i){return i!==n}):e.map(function(o,i){return i===n?r:o})}function Vr(e){return typeof e=="string"||typeof e=="number"?function(r){if(typeof r!="undefined")return r[e]}:e.get}function Ai(e){return typeof e=="string"||typeof e=="number"?function(r,n){var o,i;return Array.isArray(r)?Oi(r,e,n):typeof r=="undefined"?(o={},o[e]=n,o):be({},r,(i={},i[e]=n,i))}:e.set}function $i(e,t){return e.select(t)}function Ei(e,t){var r=Vr(t),n=Ai(t);return e.map(function(o){return function(a){var s=r(a),u=o(s);return s===u?a:n(a,u)}})}var _t=function(){function e(t,r){this.isolateSource=$i,this.isolateSink=Ei,this._stream=t.filter(function(n){return typeof n!="undefined"}).compose(Mt()).remember(),this._name=r,this.stream=H(this._stream),this._stream._isCycleSource=r}return e.prototype.select=function(t){var r=Vr(t);return new e(this._stream.map(r),this._name)},e}(),Ni=function(){function e(t,r,n){this.ins=n,this.out=t,this.p=r}return e.prototype._n=function(t){this.p;var r=this.out;r!==null&&r._n(t)},e.prototype._e=function(t){var r=this.out;r!==null&&r._e(t)},e.prototype._c=function(){},e}(),Pi=function(){function e(t,r){this.type="pickMerge",this.ins=r,this.out=null,this.sel=t,this.ils=new Map,this.inst=null}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this);var t=this.ils;t.forEach(function(r,n){r.ins._remove(r),r.ins=null,r.out=null,t.delete(n)}),t.clear(),this.out=null,this.ils=new Map,this.inst=null},e.prototype._n=function(t){this.inst=t;for(var r=t.arr,n=this.ils,o=this.out,i=this.sel,a=r.length,s=0;s<a;++s){var u=r[s],l=u._key,p=S.fromObservable(u[i]||S.never());n.has(l)||(n.set(l,new Ni(o,this,p)),p._add(n.get(l)))}n.forEach(function(c,h){(!t.dict.has(h)||!t.dict.get(h))&&(c.ins._remove(c),c.ins=null,c.out=null,n.delete(h))})},e.prototype._e=function(t){var r=this.out;r!==null&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==null&&t._c()},e}();function Ii(e){return function(r){return new Q(new Pi(e,r))}}var Ci=function(){function e(t,r,n,o){this.key=t,this.out=r,this.p=n,this.val=ke,this.ins=o}return e.prototype._n=function(t){this.p;var r=this.out;this.val=t,r!==null&&this.p.up()},e.prototype._e=function(t){var r=this.out;r!==null&&r._e(t)},e.prototype._c=function(){},e}(),Ti=function(){function e(t,r){this.type="combine",this.ins=r,this.sel=t,this.out=null,this.ils=new Map,this.inst=null}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this);var t=this.ils;t.forEach(function(r){r.ins._remove(r),r.ins=null,r.out=null,r.val=null}),t.clear(),this.out=null,this.ils=new Map,this.inst=null},e.prototype.up=function(){for(var t=this.inst.arr,r=t.length,n=this.ils,o=Array(r),i=0;i<r;++i){var a=t[i],s=a._key;if(!n.has(s))return;var u=n.get(s).val;if(u===ke)return;o[i]=u}this.out._n(o)},e.prototype._n=function(t){this.inst=t;var r=t.arr,n=this.ils,o=this.out,i=this.sel,a=t.dict,s=r.length,u=!1;if(n.forEach(function(g,f){a.has(f)||(g.ins._remove(g),g.ins=null,g.out=null,g.val=null,n.delete(f),u=!0)}),s===0){o._n([]);return}for(var l=0;l<s;++l){var p=r[l],c=p._key;if(!p[i])throw new Error("pickCombine found an undefined child sink stream");var h=S.fromObservable(p[i]);n.has(c)||(n.set(c,new Ci(c,o,this,h)),h._add(n.get(c)))}u&&this.up()},e.prototype._e=function(t){var r=this.out;r!==null&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==null&&t._c()},e}();function Di(e){return function(r){return new Q(new Ti(e,r))}}var Xt=globalThis&&globalThis.__assign||function(){return Xt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},Xt.apply(this,arguments)},ki=function(){function e(t){this._instances$=t}return e.prototype.pickMerge=function(t){return H(this._instances$.compose(Ii(t)))},e.prototype.pickCombine=function(t){return H(this._instances$.compose(Di(t)))},e}();function xi(e){return{"*":null}}function Mi(e,t){return{get:function(r){if(typeof r!="undefined"){for(var n=0,o=r.length;n<o;++n)if(""+e(r[n],n)===t)return r[n];return}},set:function(r,n){return typeof r=="undefined"?[n]:typeof n=="undefined"?r.filter(function(o,i){return""+e(o,i)!==t}):r.map(function(o,i){return""+e(o,i)===t?n:o})}}}var ji={get:function(e){return e},set:function(e,t){return t}};function Li(e){return function(r){var n=e.channel||"state",o=e.itemKey,i=e.itemScope||xi,a=S.fromObservable(r[n].stream),s=a.fold(function(u,l){var p,c,h,g,f=u.dict;if(Array.isArray(l)){for(var d=Array(l.length),y=new Set,v=0,A=l.length;v<A;++v){var b=""+(o?o(l[v],v):v);if(y.add(b),f.has(b))d[v]=f.get(b);else{var _=o?Mi(o,b):""+v,w=i(b),$=typeof w=="string"?(p={"*":w},p[n]=_,p):Xt({},w,(c={},c[n]=_,c)),E=e.itemFactory?e.itemFactory(l[v],v):e.item,O=ht(E,$)(r);f.set(b,O),d[v]=O}d[v]._key=b}return f.forEach(function(N,P){y.has(P)||f.delete(P)}),y.clear(),{dict:f,arr:d}}else{f.clear();var b=""+(o?o(l,0):"this"),_=ji,w=i(b),$=typeof w=="string"?(h={"*":w},h[n]=_,h):Xt({},w,(g={},g[n]=_,g)),E=e.itemFactory?e.itemFactory(l,0):e.item,O=ht(E,$)(r);return f.set(b,O),{dict:f,arr:[O]}}},{dict:new Map,arr:[]});return e.collectSinks(new ki(s))}}var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});var Fi=G,Ri=function(){function e(t){this.streams=t,this.type="concat",this.out=null,this.i=0}return e.prototype._start=function(t){this.out=t,this.streams[this.i]._add(this)},e.prototype._stop=function(){var t=this.streams;this.i<t.length&&t[this.i]._remove(this),this.i=0,this.out=null},e.prototype._n=function(t){var r=this.out;!r||r._n(t)},e.prototype._e=function(t){var r=this.out;!r||r._e(t)},e.prototype._c=function(){var t=this.out;if(!!t){var r=this.streams;r[this.i]._remove(this),++this.i<r.length?r[this.i]._add(this):t._c()}},e}();function Bi(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new Fi.Stream(new Ri(e))}var Zt=Kr.default=Bi,Jr={};Object.defineProperty(Jr,"__esModule",{value:!0});function Ui(){return typeof queueMicrotask!="undefined"?queueMicrotask:typeof setImmediate!="undefined"?setImmediate:typeof process!="undefined"?process.nextTick:setTimeout}var Yr=Jr.default=Ui,pe=Yr();function Wi(e,t){return t===void 0&&(t="state"),function(n){var o=S.create(),i=o.fold(function(l,p){return p(l)},void 0).drop(1),a=n;a[t]=new _t(i,t);var s=e(a);if(s[t]){var u=Zt(S.fromObservable(s[t]),S.never());u.subscribe({next:function(l){return pe(function(){return o._n(l)})},error:function(l){return pe(function(){return o._e(l)})},complete:function(){return pe(function(){return o._c()})}})}return s}}function qi(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gi(e,t){return Ki(e)||Vi(e,t)||Hi(e,t)||zi()}function zi(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hi(e,t){if(!!e){if(typeof e=="string")return er(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return er(e,t)}}function er(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Vi(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(u){i=!0,s=u}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function Ki(e){if(Array.isArray(e))return e}function Ji(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.combineList,o=n===void 0?["DOM"]:n,i=r.globalList,a=i===void 0?["EVENTS"]:i,s=r.stateSourceName,u=s===void 0?"STATE":s,l=r.domSourceName,p=l===void 0?"DOM":l,c=r.container,h=c===void 0?"div":c,g=r.containerClass;return function(f){var d=Date.now(),y={item:e,itemKey:function(b,_){return typeof b.id!="undefined"?b.id:_},itemScope:function(b){return b},channel:u,collectSinks:function(b){return Object.entries(f).reduce(function(_,w){var $=Gi(w,2),E=$[0];if($[1],o.includes(E)){var O=b.pickCombine(E);E===p&&h?_.DOM=O.map(function(N){var P=g?{props:{className:g}}:{};return{sel:h,data:P,children:N,key:d,text:void 0,elm:void 0}}):(console.warn("Collections without wrapping containers will fail in unpredictable ways when used inside JSX fragments"),_[E]=O)}else _[E]=b.pickMerge(E);return _},{})}},v=qi({},u,t);return a.forEach(function(A){return v[A]=null}),o.forEach(function(A){return v[A]=null}),Yi(y,v,f)}}function Yi(e,t,r){return ht(Li(e),t)(r)}function Xi(e){return ta(e)||Qi(e)||Xr(e)||Zi()}function Zi(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qi(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ta(e){if(Array.isArray(e))return _e(e)}function rr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function nr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rr(Object(r),!0).forEach(function(n){ea(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rr(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ea(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mt(e,t){return oa(e)||na(e,t)||Xr(e,t)||ra()}function ra(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xr(e,t){if(!!e){if(typeof e=="string")return _e(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _e(e,t)}}function _e(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function na(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(u){i=!0,s=u}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function oa(e){if(Array.isArray(e))return e}function we(e){return we=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(e)}function or(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},o=n.switched,i=o===void 0?["DOM"]:o,a=n.stateSourceName,s=a===void 0?"STATE":a,u=we(t);if(!t)throw new Error("Missing 'name$' parameter for switchable()");if(!(u==="string"||u==="function"||t instanceof Q))throw new Error("Invalid 'name$' parameter for switchable(): expects Stream, String, or Function");if(t instanceof Q){var l=t.compose(Mt()).startWith(r).remember();return function(c){return ir(e,c,l,i)}}else{var p=u==="function"&&t||function(c){return c[t]};return function(c){var h=c&&(typeof s=="string"&&c[s]||c.STATE||c.state).stream;if(!h instanceof Q)throw new Error("Could not find the state source: ".concat(s));var g=h.map(p).filter(function(f){return typeof f=="string"}).compose(Mt()).startWith(r).remember();return ir(e,c,g,i,s)}}}function ir(e,t,r){var n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:["DOM"],o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:"STATE";typeof n=="string"&&(n=[n]);var i=Object.entries(e).map(function(s){var u=mt(s,2),l=u[0],p=u[1];if(t[o]){var c=t[o].stream,h=S.combine(r,c).filter(function(f){var d=mt(f,2),y=d[0];return d[1],y==l}).map(function(f){var d=mt(f,2);d[0];var y=d[1];return y}).remember(),g=new t[o].constructor(h,t[o]._name);return[l,p(nr(nr({},t),{},{state:g}))]}return[l,p(t)]}),a=Object.keys(t).reduce(function(s,u){if(n.includes(u))s[u]=r.map(function(p){var c=i.find(function(h){var g=mt(h,2),f=g[0];return g[1],f===p});return c&&c[1][u]||S.never()}).flatten().remember().startWith(void 0);else{var l=i.filter(function(p){var c=mt(p,2);c[0];var h=c[1];return h[u]!==void 0}).map(function(p){var c=mt(p,2);c[0];var h=c[1];return h[u]});s[u]=S.merge.apply(S,Xi(l))}return s},{});return a}var Zr={};Object.defineProperty(Zr,"__esModule",{value:!0});var ia=G,aa=function(){function e(t,r){this.dt=t,this.ins=r,this.type="delay",this.out=null}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=null},e.prototype._n=function(t){var r=this.out;if(!!r)var n=setInterval(function(){r._n(t),clearInterval(n)},this.dt)},e.prototype._e=function(t){var r=this.out;if(!!r)var n=setInterval(function(){r._e(t),clearInterval(n)},this.dt)},e.prototype._c=function(){var t=this.out;if(!!t)var r=setInterval(function(){t._c(),clearInterval(r)},this.dt)},e}();function sa(e){return function(r){return new ia.Stream(new aa(e,r))}}var Se=Zr.default=sa,Qr={};Object.defineProperty(Qr,"__esModule",{value:!0});var Ct=G,ua=function(){function e(t,r){this.dt=t,this.ins=r,this.type="debounce",this.out=null,this.id=null,this.t=Ct.NO}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=null,this.clearInterval()},e.prototype.clearInterval=function(){var t=this.id;t!==null&&clearInterval(t),this.id=null},e.prototype._n=function(t){var r=this,n=this.out;!n||(this.clearInterval(),this.t=t,this.id=setInterval(function(){r.clearInterval(),n._n(t),r.t=Ct.NO},this.dt))},e.prototype._e=function(t){var r=this.out;!r||(this.clearInterval(),r._e(t))},e.prototype._c=function(){var t=this.out;!t||(this.clearInterval(),this.t!=Ct.NO&&t._n(this.t),this.t=Ct.NO,t._c())},e}();function fa(e){return function(r){return new Ct.Stream(new ua(e,r))}}var Wt=Qr.default=fa,ca=["state","sygnalFactory","id"];function la(e,t){if(e==null)return{};var r=pa(e,t),n,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],!(t.indexOf(n)>=0)&&(!Object.prototype.propertyIsEnumerable.call(e,n)||(r[n]=e[n]))}return r}function pa(e,t){if(e==null)return{};var r={},n=Object.keys(e),o,i;for(i=0;i<n.length;i++)o=n[i],!(t.indexOf(o)>=0)&&(r[o]=e[o]);return r}function U(e){return va(e)||ha(e)||tn(e)||da()}function da(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ha(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function va(e){if(Array.isArray(e))return Oe(e)}function B(e,t){return ga(e)||ma(e,t)||tn(e,t)||ya()}function ya(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tn(e,t){if(!!e){if(typeof e=="string")return Oe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Oe(e,t)}}function Oe(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function ma(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(u){i=!0,s=u}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function ga(e){if(Array.isArray(e))return e}function ba(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ar(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _a(e,t,r){return t&&ar(e.prototype,t),r&&ar(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function sr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sr(Object(r),!0).forEach(function(n){R(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sr(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e){return x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(e)}var Ae=typeof window!="undefined"&&window||process&&process.env||{},ur="request",wa="BOOTSTRAP",gt="INITIALIZE",Sa="HYDRATE",fr=!0,Qt="~#~#~ABORT~#~#~";function en(e){var t=e.name,r=e.sources,n=e.isolateOpts,o=e.stateSourceName,i=o===void 0?"STATE":o;if(r&&x(r)!=="object")throw new Error("Sources must be a Cycle.js sources object:",t);var a;typeof n=="string"?a=R({},i,n):n===!0?a={}:a=n;var s=typeof r=="undefined";if(x(a)=="object"){var u=function(p){var c=C(C({},e),{},{sources:p});return new de(c).sinks};return s?ht(u,a):ht(u,a)(r)}else return s?function(l){return new de(C(C({},e),{},{sources:l})).sinks}:new de(e).sinks}var de=function(){function e(t){var r=this,n=t.name,o=n===void 0?"NO NAME":n,i=t.sources,a=t.intent,s=t.request,u=t.model,l=t.response,p=t.view,c=t.children,h=c===void 0?{}:c,g=t.components,f=g===void 0?{}:g,d=t.initialState,y=t.calculated,v=t.storeCalculatedInState,A=v===void 0?!0:v,b=t.DOMSourceName,_=b===void 0?"DOM":b,w=t.stateSourceName,$=w===void 0?"STATE":w,E=t.requestSourceName,O=E===void 0?"HTTP":E;if(ba(this,e),!i||x(i)!="object")throw new Error("Missing or invalid sources");this.name=o,this.sources=i,this.intent=a,this.request=s,this.model=u,this.response=l,this.view=p,this.children=h,this.components=f,this.initialState=d,this.calculated=y,this.storeCalculatedInState=A,this.DOMSourceName=_,this.stateSourceName=$,this.requestSourceName=O,this.sourceNames=Object.keys(i),this.isSubComponent=this.sourceNames.includes("props$");var N=i[$]&&i[$].stream;N&&(this.currentState=d||{},this.sources[this.stateSourceName]=new _t(N.map(function(P){return r.currentState=P,P}))),fr&&typeof this.intent=="undefined"&&typeof this.model=="undefined"&&(this.initialState=d||!0,this.intent=function(P){return{__NOOP_ACTION__:S.never()}},this.model={__NOOP_ACTION__:function(T){return T}}),fr=!1,this.log=Oa(o),this.initIntent$(),this.initAction$(),this.initResponse$(),this.initState(),this.initModel$(),this.initSendResponse$(),this.initChildren$(),this.initSubComponentSink$(),this.initVdom$(),this.initSinks()}return _a(e,[{key:"initIntent$",value:function(){if(!!this.intent){if(typeof this.intent!="function")throw new Error("Intent must be a function");if(this.intent$=this.intent(this.sources),!(this.intent$ instanceof Q)&&x(this.intent$)!="object")throw new Error("Intent must return either an action$ stream or map of event streams")}}},{key:"initAction$",value:function(){var r=this.sources&&this.sources[this.requestSourceName]||null;if(!this.intent$){this.action$=S.never();return}var n;if(this.intent$ instanceof Q)n=this.intent$;else{var o=Object.entries(this.intent$).map(function(l){var p=B(l,2),c=p[0],h=p[1];return h.map(function(g){return{type:c,data:g}})});n=S.merge.apply(S,[S.never()].concat(U(o)))}var i=n instanceof Q?n:n.apply&&n(this.sources)||S.never(),a=Zt(S.of({type:wa}),i).compose(Se(10)),s;r&&typeof r.select=="function"?s=r.select("initial").flatten():s=S.never();var u=s.map(function(l){return{type:Sa,data:l}});this.action$=S.merge(a,u).compose(this.log(function(l){var p=l.type;return"Action triggered: <".concat(p,">")}))}},{key:"initResponse$",value:function(){var r=this;if(typeof this.request!="undefined"){if(x(this.request)!="object")throw new Error("The request parameter must be an object");var n=this.sources[this.requestSourceName],o=Object.entries(this.request),i=o.reduce(function(a,s){var u=B(s,2),l=u[0],p=u[1],c=l.toLowerCase();if(typeof n[c]!="function")throw new Error("Invalid method in request object:",l);var h=Object.entries(p),g=h.reduce(function(d,y){var v=B(y,2),A=v[0],b=v[1],_="[".concat(c.toUpperCase(),"]:").concat(A||"none"),w=x(b);if(w==="undefined")throw new Error("Action for '".concat(A,"' route in request object not specified"));if(w!=="string"&&w!=="function")throw new Error("Invalid action for '".concat(A,"' route: expecting string or function"));var $=w==="function"?"[ FUNCTION ]":"< ".concat(b," >");console.log("[".concat(r.name,"] Adding ").concat(r.requestSourceName," route:"),c.toUpperCase(),"'".concat(A,"' <").concat($,">"));var E=n[c](A).compose(Mt(function(O,N){return O.id==N.id})).map(function(O){if(!O||!O.id)throw new Error("No id found in request: ".concat(_));try{var N=O.id,P=O.params,T=O.body,D=O.cookies,M=w==="function"?"FUNCTION":b,tt={params:P,body:T,cookies:D,req:O},et={type:M,data:T,req:O,_reqId:N,_action:M},jt=new Date().toISOString(),At=O.get?O.get("host"):"0.0.0.0";if(console.log("".concat(jt," ").concat(At," ").concat(O.method," ").concat(O.url)),Ae.DEBUG&&r.action$.setDebugListener({next:function(Y){var X=Y.type;return console.log("[".concat(r.name,"] Action from ").concat(r.requestSourceName," request: <").concat(X,">"))}}),w==="function"){var $t=r.addCalculated(r.currentState),V=b($t,O);return S.of(C(C({},et),{},{data:V}))}else{r.action$.shamefullySendNext(et);var ft=Object.entries(r.sources),J=ft.reduce(function(L,Y){var X=B(Y,2),ct=X[0],rt=X[1];if(!rt||typeof rt[ur]!="function")return L;var Lt=rt[ur](N);return[].concat(U(L),[Lt])},[]);return S.merge.apply(S,U(J))}}catch(L){console.error(L)}}).flatten();return[].concat(U(d),[E])},[]),f=S.merge.apply(S,U(g));return[].concat(U(a),[f])},[]);if(this.response$=S.merge.apply(S,U(i)).compose(this.log(function(a){return a._action?"[".concat(r.requestSourceName,"] response data received for Action: <").concat(a._action,">"):"[".concat(r.requestSourceName,"] response data received from FUNCTION")})),typeof this.response!="undefined"&&typeof this.response$=="undefined")throw new Error("Cannot have a response parameter without a request parameter")}}},{key:"initState",value:function(){var r=this;this.model!=null&&(this.model[gt]===void 0?this.model[gt]=R({},this.stateSourceName,function(n,o){return C({},r.addCalculated(o))}):Object.keys(this.model[gt]).forEach(function(n){n!==r.stateSourceName&&(console.warn("".concat(gt," can only be used with the ").concat(r.stateSourceName," source... disregarding ").concat(n)),delete r.model[gt][n])}))}},{key:"initModel$",value:function(){var r=this;if(typeof this.model=="undefined"){this.model$=this.sourceNames.reduce(function(p,c){return p[c]=S.never(),p},{});return}var n={type:gt,data:this.initialState},o=this.initialState?Zt(S.of(n),this.action$).compose(Se(0)):this.action$,i=this.makeOnAction(o,!0,this.action$),a=this.makeOnAction(this.action$,!1,this.action$),s=Object.entries(this.model),u={};s.forEach(function(p){var c=B(p,2),h=c[0],g=c[1];if(typeof g=="function"&&(g=R({},r.stateSourceName,g)),x(g)!=="object")throw new Error("Entry for each action must be an object: ".concat(r.name," ").concat(h));var f=Object.entries(g);f.forEach(function(d){var y=B(d,2),v=y[0],A=y[1],b=v==r.stateSourceName,_=b?i:a,w=_(h,A),$=w.compose(r.log(function(E){if(b)return"State reducer added: <".concat(h,">");var O=E&&(E.type||E.command||E.name||E.key||Array.isArray(E)&&"Array"||E);return"Data sent to [".concat(v,"]: <").concat(h,"> ").concat(O)}));Array.isArray(u[v])?u[v].push($):u[v]=[$]})});var l=Object.entries(u).reduce(function(p,c){var h=B(c,2),g=h[0],f=h[1];return p[g]=S.merge.apply(S,[S.never()].concat(U(f))),p},{});this.model$=l}},{key:"initSendResponse$",value:function(){var r=this,n=x(this.response);if(n!="function"&&n!="undefined")throw new Error("The response parameter must be a function");if(n=="undefined"){this.response$&&this.response$.subscribe({next:this.log(function(u){var l=u._reqId,p=u._action;return"Unhandled response for request: ".concat(p," ").concat(l)})}),this.sendResponse$=S.never();return}var o={select:function(l){return typeof l=="undefined"?r.response$:(Array.isArray(l)||(l=[l]),r.response$.filter(function(p){var c=p._action;return l.length>0?c==="FUNCTION"||l.includes(c):!0}))}},i=this.response(o);if(x(i)!="object")throw new Error("The response function must return an object");var a=Object.entries(i),s=a.reduce(function(u,l){var p=B(l,2),c=p[0],h=p[1],g=h.map(function(f){var d=f._reqId,y=f._action,v=f.data;if(!d)throw new Error("No request id found for response for: ".concat(c));return{_reqId:d,_action:y,command:c,data:v}});return[].concat(U(u),[g])},[]);this.sendResponse$=S.merge.apply(S,U(s)).compose(this.log(function(u){u._reqId;var l=u._action;return"[".concat(r.requestSourceName,"] response sent for: <").concat(l,">")}))}},{key:"initChildren$",value:function(){var r=this,n=this.sourceNames.reduce(function(o,i){return i==r.DOMSourceName?o[i]={}:o[i]=[],o},{});this.children$=Object.entries(this.children).reduce(function(o,i){var a=B(i,2),s=a[0],u=a[1],l=u(r.sources);return r.sourceNames.forEach(function(p){p==r.DOMSourceName?o[p][s]=l[p]:o[p].push(l[p])}),o},n)}},{key:"initSubComponentSink$",value:function(){var r=this,n=S.create({start:function(i){r.newSubComponentSinks=i.next.bind(i)},stop:function(i){}});n.subscribe({next:function(i){return i}}),this.subComponentSink$=n.filter(function(o){return Object.keys(o).length>0})}},{key:"initVdom$",value:function(){var r=this;if(typeof this.view!="function"){this.vdom$=S.of(null);return}var n=this.sources[this.stateSourceName],o=C({},this.children$[this.DOMSourceName]),i=n&&n.isolateSource(n,{get:function(d){return r.addCalculated(d)}}),a=i&&i.stream||S.never();o.state=a,o[this.stateSourceName]=a,this.sources.props$&&(o.props=this.sources.props$),this.sources.children$&&(o.children=this.sources.children$);var s=Object.entries(o).reduce(function(f,d){var y=B(d,2),v=y[0],A=y[1];return f.names.push(v),f.streams.push(A),f},{names:[],streams:[]}),u=S.combine.apply(S,U(s.streams)),l=u.compose(Wt(5)).map(function(f){return s.names.reduce(function(d,y,v){return d[y]=f[v],d},{})}),p=Object.keys(this.components),c=S.create(),h=l.map(function(f){return f}).map(this.view).map(function(f){return f||{sel:"div",data:{},children:[]}}),g=h.fold(function(f,d){var y=rn(d,p),v=Object.entries(y),A={"::ROOT::":d};if(v.length===0)return A;var b={},_=v.reduce(function($,E){var O=B(E,2),N=O[0],P=O[1],T=P.sel,D=P.data,M=D.props||{},tt=P.children||[],et=D.isCollection||!1,jt=D.isSwitchable||!1;if(f[N]){var At=f[N];return $[N]=At,At.props$.shamefullySendNext(M),At.children$.shamefullySendNext(tt),$}var $t=T==="sygnal-factory"?M.sygnalFactory:r.components[T]||M.sygnalFactory;if(!$t&&!et&&!jt)throw T==="sygnal-factory"?new Error("Component not found on element with Capitalized selector and nameless function: JSX transpilation replaces selectors starting with upper case letters with functions in-scope with the same name, Sygnal cannot see the name of the resulting component."):new Error("Component not found: ".concat(T));var V=S.create().startWith(M),ft=S.create().startWith(tt),J=new _t(r.sources[r.stateSourceName].stream.startWith(r.currentState)),L,Y=!0;if(et){var X,ct,rt,Lt=function(k){var j=k[ct];if(typeof j!="undefined"){if(!Array.isArray(j)){var ot=typeof D.props.of=="string"?D.props.of:"components";return console.warn("Collection of ".concat(ot," does not have a valid array in the 'for' property: expects either an array or a string of the name of an array property on the state")),[]}return j}};typeof M.for=="undefined"?(rt={get:function(k){return Array.isArray(k)?k:(console.warn("Collection sub-component of ".concat(r.name," has no 'for' attribute and the parent state is not an array: Provide a 'for' attribute with either an array or the name of a state property containing an array")),[])},set:function(k,j){return j}},Y=!1):typeof M.for=="string"?(ct=M.for,rt={get:Lt,set:function(k,j){return r.calculated&&ct in r.calculated?(console.warn("Collection sub-component of ".concat(r.name," attempted to update state on a calculated field '").concat(ct,"': Update ignored")),k):C(C({},k),{},R({},ct,j))}},Y=!1):(ct="for",J=new _t(V.remember()),rt={get:Lt,set:function(k,j){return k}});var In=C(C({},r.sources),{},(X={},R(X,r.stateSourceName,J),R(X,"props$",V),R(X,"children$",ft),X)),Cn=typeof D.props.of=="function"?D.props.of:r.components[D.props.of];if(L=Ji(Cn,rt,{container:null})(In),x(L)!=="object")throw new Error("Invalid sinks returned from component factory of collection element")}else if(jt){var Et,nt=D.props.state,oe=!1,ie;if(typeof nt=="string")oe=!0,ie={get:function(k){return k[nt]},set:function(k,j){return r.calculated&&nt in r.calculated?(console.warn("Switchable sub-component of ".concat(r.name," attempted to update state on a calculated field '").concat(nt,"': Update ignored")),k):C(C({},k),{},R({},nt,j))}},Y=!1;else if(typeof nt=="undefined")oe=!0,ie={get:function(k){return k},set:function(k,j){return j}},Y=!1;else if(x(nt)==="object")J=new _t(V.map(function(F){return F.state}));else throw new Error("Invalid state provided to collection sub-component of ".concat(r.name,": Expecting string, object, or none, but found ").concat(x(nt)));var Be=D.props.of,Ue=C(C({},r.sources),{},(Et={},R(Et,r.stateSourceName,J),R(Et,"props$",V),R(Et,"children$",ft),Et));if(oe?L=ht(or(Be,V.map(function(F){return F.current})),R({},r.stateSourceName,ie))(Ue):L=or(Be,V.map(function(F){return F.current}))(Ue),x(L)!=="object")throw new Error("Invalid sinks returned from component factory of switchable element")}else{var Tn=M.state;M.sygnalFactory,M.id;var We=la(M,ca);if(typeof Tn=="undefined"&&(x(We)!=="object"||Object.keys(We).length===0)){var Nt,Dn=C(C({},r.sources),{},(Nt={},R(Nt,r.stateSourceName,J),R(Nt,"props$",S.never().startWith(null)),R(Nt,"children$",ft),Nt));L=$t(Dn),Y=!1}else{var Pt,kn=function(k){var j=k.state;if(typeof j=="undefined")return k;if(x(j)!=="object")return j;var ot=C({},k);return delete ot.state,C(C({},ot),j)};J=new _t(V.map(kn));var xn=C(C({},r.sources),{},(Pt={},R(Pt,r.stateSourceName,J),R(Pt,"props$",V),R(Pt,"children$",ft),Pt));L=$t(xn)}if(x(L)!=="object"){var Mn=T==="sygnal-factory"?"custom element":T;throw new Error("Invalid sinks returned from component factory:",Mn)}}if(Y){var jn=L[r.stateSourceName];L[r.stateSourceName]=jn.filter(function(F){return console.warn("State update attempt from component with inderect link to state: Components with state set through HTML properties/attributes cannot update application state directly"),!1})}var Ln=L[r.DOMSourceName].remember(),Fn=function(k,j){var ot=JSON.stringify(k),Rn=JSON.stringify(j);return ot===Rn};return L[r.DOMSourceName]=J.stream.compose(Mt(Fn)).map(function(F){return c.shamefullySendNext(null),Ln}).compose(Wt(10)).flatten().remember(),$[N]={sink$:L,props$:V,children$:ft},Object.entries(L).map(function(F){var k=B(F,2),j=k[0],ot=k[1];b[j]||(b[j]=[]),j!==r.DOMSourceName&&b[j].push(ot)}),$},A),w=Object.entries(b).reduce(function($,E){var O=B(E,2),N=O[0],P=O[1];return P.length===0||($[N]=P.length===1?P[0]:S.merge.apply(S,U(P))),$},{});return r.newSubComponentSinks(w),_},{});this.vdom$=S.combine(c.startWith(null),g).map(function(f){var d=B(f,2);d[0];var y=d[1],v=y["::ROOT::"],A=[],b=Object.entries(y).filter(function(w){var $=B(w,1),E=$[0];return E!=="::ROOT::"});if(b.length===0)return S.of(v);var _=b.map(function(w){var $=B(w,2),E=$[0],O=$[1];return A.push(E),O.sink$[r.DOMSourceName].startWith(void 0)});return _.length===0?S.of(v):S.combine.apply(S,U(_)).compose(Wt(5)).map(function(w){var $=w.reduce(function(N,P,T){return N[A[T]]=P,N},{}),E=an(v),O=nn(E,$,p);return O})}).flatten().filter(function(f){return!!f}).compose(Wt(5)).remember().compose(this.log("View Rendered"))}},{key:"initSinks",value:function(){var r=this;this.sinks=this.sourceNames.reduce(function(n,o){if(o==r.DOMSourceName)return n;var i=r.subComponentSink$?r.subComponentSink$.map(function(a){return a[o]}).filter(function(a){return!!a}).flatten():S.never();return o===r.stateSourceName?n[o]=S.merge.apply(S,[r.model$[o]||S.never(),i,r.sources[r.stateSourceName].stream.filter(function(a){return!1})].concat(U(r.children$[o]))):n[o]=S.merge.apply(S,[r.model$[o]||S.never(),i].concat(U(r.children$[o]))),n},{}),this.sinks[this.DOMSourceName]=this.vdom$,this.sinks[this.requestSourceName]=S.merge(this.sendResponse$,this.sinks[this.requestSourceName])}},{key:"makeOnAction",value:function(r){var n=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2?arguments[2]:void 0;return i=i||r,function(a,s){var u=r.filter(function(c){var h=c.type;return h==a}),l;if(typeof s=="function")l=u.map(function(c){var h=function(b,_){var w=c._reqId||c.req&&c.req.id,$=w?x(_)=="object"?C(C({},_),{},{_reqId:w,_action:a}):{data:_,_reqId:w,_action:a}:_;setTimeout(function(){i.shamefullySendNext({type:b,data:$})},10)},g=c.data;if(g&&g.data&&g._reqId&&(g=g.data),o)return function(A){var b=n.isSubComponent?n.currentState:A,_=n.addCalculated(b),w=s(_,g,h,c.req);return w==Qt?b:n.cleanupCalculated(w)};var f=n.addCalculated(n.currentState),d=s(f,g,h,c.req),y=x(d),v=c._reqId||c.req&&c.req.id;if(["string","number","boolean","function"].includes(y))return d;if(y=="object")return C(C({},d),{},{_reqId:v,_action:a});if(y=="undefined")return console.warn("'undefined' value sent to ".concat(a)),d;throw new Error("Invalid reducer type for ".concat(a," ").concat(y))}).filter(function(c){return c!=Qt});else if(s===void 0||s===!0)l=u.map(function(c){var h=c.data;return h});else{var p=s;l=u.mapTo(p)}return l}}},{key:"addCalculated",value:function(r){if(!this.calculated||x(r)!=="object")return r;if(x(this.calculated)!=="object")throw new Error("'calculated' parameter must be an object mapping calculated state field named to functions");var n=Object.entries(this.calculated),o=n.reduce(function(i,a){var s=B(a,2),u=s[0],l=s[1];if(typeof l!="function")throw new Error("Missing or invalid calculator function for calculated field '".concat(u));try{i[u]=l(r)}catch(p){console.warn("Calculated field '".concat(u,"' threw an error during calculation: ").concat(p.message))}return i},{});return C(C({},r),o)}},{key:"cleanupCalculated",value:function(r){var n=this;if(this.storeCalculatedInState)return this.addCalculated(r);if(!this.calculated||!r||x(r)!=="object")return r;var o=Object.keys(this.calculated),i=C({},r);return o.forEach(function(a){n.initialState&&typeof n.initialState[a]!="undefined"?i[a]=n.initialState[a]:delete i[a]}),i}}]),e}();function Oa(e){return function(t){var r=typeof t=="function"?t:function(n){return t};return function(n){return n.debug(function(o){(Ae.DEBUG=="true"||Ae.DEBUG===!0)&&console.log("[".concat(e,"] ").concat(r(o)))})}}}function rn(e,t){var r,n,o,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;if(!e)return{};if((r=e.data)!==null&&r!==void 0&&r.componentsProcessed)return{};i===0&&(e.data.componentsProcessed=!0);var s=e.sel,u=s&&s.toLowerCase()==="collection",l=s&&s.toLowerCase()==="switchable",p=s&&["collection","switchable","sygnal-factory"].concat(U(t)).includes(e.sel)||typeof((n=e.data)===null||n===void 0||(o=n.props)===null||o===void 0?void 0:o.sygnalFactory)=="function",c=e.data&&e.data.props||{},h=e.data&&e.data.attrs||{},g=e.children||[],f={};if(p){var d=on(e,i,a);if(u){var y;if(!c.of)throw new Error("Collection element missing required 'component' property");if(typeof c.of!="string"&&typeof c.of!="function")throw new Error("Invalid 'component' property of collection element: found ".concat(x(c.of)," requires string or component factory function"));if(typeof c.of!="function"&&!t.includes(c.of))throw new Error("Specified component for collection not found: ".concat(c.of));typeof h.for!="undefined"&&!(typeof h.for=="string"||Array.isArray(h.for))&&console.warn("No valid array found in the 'value' property of collection ".concat(typeof c.of=="string"?c.of:"function component",": no collection components will be created")),e.data.isCollection=!0,(y=e.data).props||(y.props={}),e.data.props.for=h.for,e.data.attrs=void 0}else if(l){if(!c.of)throw new Error("Switchable element missing required 'of' property");if(x(c.of)!=="object")throw new Error("Invalid 'components' property of switchable element: found ".concat(x(c.of)," requires object mapping names to component factories"));var v=Object.values(c.of);if(!v.every(function(b){return typeof b=="function"}))throw new Error("One or more components provided to switchable element is not a valid component factory");if(!c.current||typeof c.current!="string"&&typeof c.current!="function")throw new Error("Missing or invalid 'current' property for switchable element: found '".concat(x(c.current),"' requires string or function"));var A=Object.keys(c.of);if(!A.includes(c.current))throw new Error("Component '".concat(c.current,"' not found in switchable element"));e.data.isSwitchable=!0}f[d]=e}return g.length>0&&g.map(function(b,_){return rn(b,t,i+1,_)}).forEach(function(b){Object.entries(b).forEach(function(_){var w=B(_,2),$=w[0],E=w[1];return f[$]=E})}),f}function nn(e,t,r){var n,o,i,a,s,u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,l=arguments.length>4?arguments[4]:void 0;if(!!e){if((n=e.data)!==null&&n!==void 0&&n.componentsInjected)return e;u===0&&e.data&&(e.data.componentsInjected=!0);var p=e.sel||"NO SELECTOR",c=["collection","switchable","sygnal-factory"].concat(U(r)).includes(p)||typeof((o=e.data)===null||o===void 0||(i=o.props)===null||i===void 0?void 0:i.sygnalFactory)=="function",h=e==null||(a=e.data)===null||a===void 0?void 0:a.isCollection,g=e==null||(s=e.data)===null||s===void 0?void 0:s.isSwitchable;e.data&&e.data.props;var f=e.children||[];if(c){var d=on(e,u,l),y=t[d];return h?(e.sel="div",e.children=Array.isArray(y)?y:[y],e):y}else return f.length>0&&(e.children=f.map(function(v,A){return nn(v,t,r,u+1,A)}).flat()),e}}var cr=new Map;function on(e,t,r){var n=e.sel,o=typeof n=="string"?n:"functionComponent",i=cr.get(n);if(!i){var a=Date.now(),s=Math.floor(Math.random()*1e4);i="".concat(a,"-").concat(s),cr.set(n,i)}var u="".concat(i,"-").concat(t,"-").concat(r),l=e.data&&e.data.props||{},p=l.id&&JSON.stringify(l.id)||u,c="".concat(o,"::").concat(p);return c}function an(e){return typeof e=="undefined"?e:C(C({},e),{},{children:Array.isArray(e.children)?e.children.map(an):void 0,data:e.data&&C(C({},e.data),{},{componentsInjected:!1})})}function Aa(){var e;return typeof window!="undefined"?e=window:typeof global!="undefined"?e=global:e=this,e.Cyclejs=e.Cyclejs||{},e=e.Cyclejs,e.adaptStream=e.adaptStream||function(t){return t},e}function $a(e){return Aa().adaptStream(e)}function Ea(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=S.create());return t}function Na(e,t){var r={};for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n](t[n],n),r[n]&&typeof r[n]=="object"&&(r[n]._isCycleSource=n));return r}function Pa(e){for(var t in e)e.hasOwnProperty(t)&&e[t]&&typeof e[t].shamefullySendNext=="function"&&(e[t]=$a(e[t]));return e}function Ia(e,t){var r=Yr(),n=Object.keys(e).filter(function(s){return!!t[s]}),o={},i={};n.forEach(function(s){o[s]={_n:[],_e:[]},i[s]={next:function(u){return o[s]._n.push(u)},error:function(u){return o[s]._e.push(u)},complete:function(){}}});var a=n.map(function(s){return S.fromObservable(e[s]).subscribe(i[s])});return n.forEach(function(s){var u=t[s],l=function(c){r(function(){return u._n(c)})},p=function(c){r(function(){(console.error||console.log)(c),u._e(c)})};o[s]._n.forEach(l),o[s]._e.forEach(p),i[s].next=l,i[s].error=p,i[s]._n=l,i[s]._e=p}),o=null,function(){a.forEach(function(u){return u.unsubscribe()})}}function Ca(e){Object.keys(e).forEach(function(t){return e[t]._c()})}function Ta(e){for(var t in e)e.hasOwnProperty(t)&&e[t]&&e[t].dispose&&e[t].dispose()}function sn(e){return Object.keys(e).length===0}function Da(e,t){if(typeof e!="function")throw new Error("First argument given to Cycle must be the 'main' function.");if(typeof t!="object"||t===null)throw new Error("Second argument given to Cycle must be an object with driver functions as properties.");if(sn(t))throw new Error("Second argument given to Cycle must be an object with at least one driver function declared as a property.");var r=ka(t),n=e(r.sources);typeof window!="undefined"&&(window.Cyclejs=window.Cyclejs||{},window.Cyclejs.sinks=n);function o(){var i=r.run(n);return function(){i(),r.dispose()}}return{sinks:n,sources:r.sources,run:o}}function ka(e){if(typeof e!="object"||e===null)throw new Error("Argument given to setupReusable must be an object with driver functions as properties.");if(sn(e))throw new Error("Argument given to setupReusable must be an object with at least one driver function declared as a property.");var t=Ea(e),r=Na(e,t),n=Pa(r);function o(a){return Ia(a,t)}function i(){Ta(n),Ca(t)}return{sources:n,run:o,dispose:i}}function xa(e,t){var r=Da(e,t);return typeof window!="undefined"&&window.CyclejsDevTool_startGraphSerializer&&window.CyclejsDevTool_startGraphSerializer(r.sinks),r.run()}function Ma(e,t){return document.createElement(e,t)}function ja(e,t,r){return document.createElementNS(e,t,r)}function La(){return document.createDocumentFragment()}function Fa(e){return document.createTextNode(e)}function Ra(e){return document.createComment(e)}function Ba(e,t,r){e.insertBefore(t,r)}function Ua(e,t){e.removeChild(t)}function Wa(e,t){e.appendChild(t)}function qa(e){return e.parentNode}function Ga(e){return e.nextSibling}function za(e){return e.tagName}function Ha(e,t){e.textContent=t}function Va(e){return e.textContent}function Ka(e){return e.nodeType===1}function Ja(e){return e.nodeType===3}function Ya(e){return e.nodeType===8}function Xa(e){return e.nodeType===11}const un={createElement:Ma,createElementNS:ja,createTextNode:Fa,createDocumentFragment:La,createComment:Ra,insertBefore:Ba,removeChild:Ua,appendChild:Wa,parentNode:qa,nextSibling:Ga,tagName:za,setTextContent:Ha,getTextContent:Va,isElement:Ka,isText:Ja,isComment:Ya,isDocumentFragment:Xa};function Z(e,t,r,n,o){const i=t===void 0?void 0:t.key;return{sel:e,data:t,children:r,text:n,elm:o,key:i}}const $e=Array.isArray;function Ht(e){return typeof e=="string"||typeof e=="number"||e instanceof String||e instanceof Number}function he(e){return e===void 0}function z(e){return e!==void 0}const ve=Z("",{},[],void 0,void 0);function It(e,t){var r,n;const o=e.key===t.key,i=((r=e.data)===null||r===void 0?void 0:r.is)===((n=t.data)===null||n===void 0?void 0:n.is);return e.sel===t.sel&&o&&i}function Za(){throw new Error("The document fragment is not supported on this platform.")}function Qa(e,t){return e.isElement(t)}function ts(e,t){return e.isDocumentFragment(t)}function es(e,t,r){var n;const o={};for(let i=t;i<=r;++i){const a=(n=e[i])===null||n===void 0?void 0:n.key;a!==void 0&&(o[a]=i)}return o}const rs=["create","update","remove","destroy","pre","post"];function ns(e,t,r){const n={create:[],update:[],remove:[],destroy:[],pre:[],post:[]},o=t!==void 0?t:un;for(const f of rs)for(const d of e){const y=d[f];y!==void 0&&n[f].push(y)}function i(f){const d=f.id?"#"+f.id:"",y=f.getAttribute("class"),v=y?"."+y.split(" ").join("."):"";return Z(o.tagName(f).toLowerCase()+d+v,{},[],void 0,f)}function a(f){return Z(void 0,{},[],void 0,f)}function s(f,d){return function(){if(--d===0){const v=o.parentNode(f);o.removeChild(v,f)}}}function u(f,d){var y,v,A,b;let _,w=f.data;if(w!==void 0){const O=(y=w.hook)===null||y===void 0?void 0:y.init;z(O)&&(O(f),w=f.data)}const $=f.children,E=f.sel;if(E==="!")he(f.text)&&(f.text=""),f.elm=o.createComment(f.text);else if(E!==void 0){const O=E.indexOf("#"),N=E.indexOf(".",O),P=O>0?O:E.length,T=N>0?N:E.length,D=O!==-1||N!==-1?E.slice(0,Math.min(P,T)):E,M=f.elm=z(w)&&z(_=w.ns)?o.createElementNS(_,D,w):o.createElement(D,w);for(P<T&&M.setAttribute("id",E.slice(P+1,T)),N>0&&M.setAttribute("class",E.slice(T+1).replace(/\./g," ")),_=0;_<n.create.length;++_)n.create[_](ve,f);if($e($))for(_=0;_<$.length;++_){const et=$[_];et!=null&&o.appendChild(M,u(et,d))}else Ht(f.text)&&o.appendChild(M,o.createTextNode(f.text));const tt=f.data.hook;z(tt)&&((v=tt.create)===null||v===void 0||v.call(tt,ve,f),tt.insert&&d.push(f))}else if(((A=r==null?void 0:r.experimental)===null||A===void 0?void 0:A.fragments)&&f.children){const O=f.children;for(f.elm=((b=o.createDocumentFragment)!==null&&b!==void 0?b:Za)(),_=0;_<n.create.length;++_)n.create[_](ve,f);for(_=0;_<O.length;++_){const N=O[_];N!=null&&o.appendChild(f.elm,u(N,d))}}else f.elm=o.createTextNode(f.text);return f.elm}function l(f,d,y,v,A,b){for(;v<=A;++v){const _=y[v];_!=null&&o.insertBefore(f,u(_,b),d)}}function p(f){var d,y;const v=f.data;if(v!==void 0){(y=(d=v==null?void 0:v.hook)===null||d===void 0?void 0:d.destroy)===null||y===void 0||y.call(d,f);for(let A=0;A<n.destroy.length;++A)n.destroy[A](f);if(f.children!==void 0)for(let A=0;A<f.children.length;++A){const b=f.children[A];b!=null&&typeof b!="string"&&p(b)}}}function c(f,d,y,v){for(var A,b;y<=v;++y){let _,w;const $=d[y];if($!=null)if(z($.sel)){p($),_=n.remove.length+1,w=s($.elm,_);for(let O=0;O<n.remove.length;++O)n.remove[O]($,w);const E=(b=(A=$==null?void 0:$.data)===null||A===void 0?void 0:A.hook)===null||b===void 0?void 0:b.remove;z(E)?E($,w):w()}else o.removeChild(f,$.elm)}}function h(f,d,y,v){let A=0,b=0,_=d.length-1,w=d[0],$=d[_],E=y.length-1,O=y[0],N=y[E],P,T,D,M;for(;A<=_&&b<=E;)w==null?w=d[++A]:$==null?$=d[--_]:O==null?O=y[++b]:N==null?N=y[--E]:It(w,O)?(g(w,O,v),w=d[++A],O=y[++b]):It($,N)?(g($,N,v),$=d[--_],N=y[--E]):It(w,N)?(g(w,N,v),o.insertBefore(f,w.elm,o.nextSibling($.elm)),w=d[++A],N=y[--E]):It($,O)?(g($,O,v),o.insertBefore(f,$.elm,w.elm),$=d[--_],O=y[++b]):(P===void 0&&(P=es(d,A,_)),T=P[O.key],he(T)?o.insertBefore(f,u(O,v),w.elm):(D=d[T],D.sel!==O.sel?o.insertBefore(f,u(O,v),w.elm):(g(D,O,v),d[T]=void 0,o.insertBefore(f,D.elm,w.elm))),O=y[++b]);b<=E&&(M=y[E+1]==null?null:y[E+1].elm,l(f,M,y,b,E,v)),A<=_&&c(f,d,A,_)}function g(f,d,y){var v,A,b,_,w,$,E,O;const N=(v=d.data)===null||v===void 0?void 0:v.hook;(A=N==null?void 0:N.prepatch)===null||A===void 0||A.call(N,f,d);const P=d.elm=f.elm,T=f.children,D=d.children;if(f!==d){if(d.data!==void 0||z(d.text)&&d.text!==f.text){(b=d.data)!==null&&b!==void 0||(d.data={}),(_=f.data)!==null&&_!==void 0||(f.data={});for(let M=0;M<n.update.length;++M)n.update[M](f,d);(E=($=(w=d.data)===null||w===void 0?void 0:w.hook)===null||$===void 0?void 0:$.update)===null||E===void 0||E.call($,f,d)}he(d.text)?z(T)&&z(D)?T!==D&&h(P,T,D,y):z(D)?(z(f.text)&&o.setTextContent(P,""),l(P,null,D,0,D.length-1,y)):z(T)?c(P,T,0,T.length-1):z(f.text)&&o.setTextContent(P,""):f.text!==d.text&&(z(T)&&c(P,T,0,T.length-1),o.setTextContent(P,d.text)),(O=N==null?void 0:N.postpatch)===null||O===void 0||O.call(N,f,d)}}return function(d,y){let v,A,b;const _=[];for(v=0;v<n.pre.length;++v)n.pre[v]();for(Qa(o,d)?d=i(d):ts(o,d)&&(d=a(d)),It(d,y)?g(d,y,_):(A=d.elm,b=o.parentNode(A),u(y,_),b!==null&&(o.insertBefore(b,y.elm,o.nextSibling(A)),c(b,[d],0,0))),v=0;v<_.length;++v)_[v].data.hook.insert(_[v]);for(v=0;v<n.post.length;++v)n.post[v]();return y}}function Le(e,t,r){if(e.ns="http://www.w3.org/2000/svg",r!=="foreignObject"&&t!==void 0)for(let n=0;n<t.length;++n){const o=t[n];if(typeof o=="string")continue;const i=o.data;i!==void 0&&Le(i,o.children,o.sel)}}function at(e,t,r){let n={},o,i,a;if(r!==void 0?(t!==null&&(n=t),$e(r)?o=r:Ht(r)?i=r.toString():r&&r.sel&&(o=[r])):t!=null&&($e(t)?o=t:Ht(t)?i=t.toString():t&&t.sel?o=[t]:n=t),o!==void 0)for(a=0;a<o.length;++a)Ht(o[a])&&(o[a]=Z(void 0,void 0,void 0,o[a],void 0));return e[0]==="s"&&e[1]==="v"&&e[2]==="g"&&(e.length===3||e[3]==="."||e[3]==="#")&&Le(n,o,e),Z(e,n,o,i,void 0)}function Ee(e,t){const r=t!==void 0?t:un;let n;if(r.isElement(e)){const o=e.id?"#"+e.id:"",i=e.getAttribute("class"),a=i?"."+i.split(" ").join("."):"",s=r.tagName(e).toLowerCase()+o+a,u={},l={},p={},c=[];let h,g,f;const d=e.attributes,y=e.childNodes;for(g=0,f=d.length;g<f;g++)h=d[g].nodeName,h[0]==="d"&&h[1]==="a"&&h[2]==="t"&&h[3]==="a"&&h[4]==="-"?l[h.slice(5)]=d[g].nodeValue||"":h!=="id"&&h!=="class"&&(u[h]=d[g].nodeValue);for(g=0,f=y.length;g<f;g++)c.push(Ee(y[g],t));return Object.keys(u).length>0&&(p.attrs=u),Object.keys(l).length>0&&(p.datasets=l),s[0]==="s"&&s[1]==="v"&&s[2]==="g"&&(s.length===3||s[3]==="."||s[3]==="#")&&Le(p,c,s),Z(s,p,c,void 0,e)}else return r.isText(e)?(n=r.getTextContent(e),Z(void 0,void 0,void 0,n,e)):r.isComment(e)?(n=r.getTextContent(e),Z("!",{},[],n,e)):Z("",{},[],void 0,e)}const os="http://www.w3.org/1999/xlink",is="http://www.w3.org/XML/1998/namespace",lr=58,as=120;function pr(e,t){let r;const n=t.elm;let o=e.data.attrs,i=t.data.attrs;if(!(!o&&!i)&&o!==i){o=o||{},i=i||{};for(r in i){const a=i[r];o[r]!==a&&(a===!0?n.setAttribute(r,""):a===!1?n.removeAttribute(r):r.charCodeAt(0)!==as?n.setAttribute(r,a):r.charCodeAt(3)===lr?n.setAttributeNS(is,r,a):r.charCodeAt(5)===lr?n.setAttributeNS(os,r,a):n.setAttribute(r,a))}for(r in o)r in i||n.removeAttribute(r)}}const ss={create:pr,update:pr};function dr(e,t){let r,n;const o=t.elm;let i=e.data.class,a=t.data.class;if(!(!i&&!a)&&i!==a){i=i||{},a=a||{};for(n in i)i[n]&&!Object.prototype.hasOwnProperty.call(a,n)&&o.classList.remove(n);for(n in a)r=a[n],r!==i[n]&&o.classList[r?"add":"remove"](n)}}const us={create:dr,update:dr},hr=/[A-Z]/g;function vr(e,t){const r=t.elm;let n=e.data.dataset,o=t.data.dataset,i;if(!n&&!o||n===o)return;n=n||{},o=o||{};const a=r.dataset;for(i in n)o[i]||(a?i in a&&delete a[i]:r.removeAttribute("data-"+i.replace(hr,"-$&").toLowerCase()));for(i in o)n[i]!==o[i]&&(a?a[i]=o[i]:r.setAttribute("data-"+i.replace(hr,"-$&").toLowerCase(),o[i]))}const fs={create:vr,update:vr};function yr(e,t){let r,n,o;const i=t.elm;let a=e.data.props,s=t.data.props;if(!(!a&&!s)&&a!==s){a=a||{},s=s||{};for(r in s)n=s[r],o=a[r],o!==n&&(r!=="value"||i[r]!==n)&&(i[r]=n)}}const cs={create:yr,update:yr},mr=typeof window!="undefined"&&window.requestAnimationFrame.bind(window)||setTimeout,ls=function(e){mr(function(){mr(e)})};let Ne=!1;function ps(e,t,r){ls(function(){e[t]=r})}function gr(e,t){let r,n;const o=t.elm;let i=e.data.style,a=t.data.style;if(!i&&!a||i===a)return;i=i||{},a=a||{};const s="delayed"in i;for(n in i)a[n]||(n[0]==="-"&&n[1]==="-"?o.style.removeProperty(n):o.style[n]="");for(n in a)if(r=a[n],n==="delayed"&&a.delayed)for(const u in a.delayed)r=a.delayed[u],(!s||r!==i.delayed[u])&&ps(o.style,u,r);else n!=="remove"&&r!==i[n]&&(n[0]==="-"&&n[1]==="-"?o.style.setProperty(n,r):o.style[n]=r)}function ds(e){let t,r;const n=e.elm,o=e.data.style;if(!(!o||!(t=o.destroy)))for(r in t)n.style[r]=t[r]}function hs(e,t){const r=e.data.style;if(!r||!r.remove){t();return}Ne||(e.elm.offsetLeft,Ne=!0);let n;const o=e.elm;let i=0;const a=r.remove;let s=0;const u=[];for(n in a)u.push(n),o.style[n]=a[n];const p=getComputedStyle(o)["transition-property"].split(", ");for(;i<p.length;++i)u.indexOf(p[i])!==-1&&s++;o.addEventListener("transitionend",function(c){c.target===o&&--s,s===0&&t()})}function vs(){Ne=!1}const ys={pre:vs,create:gr,update:gr,destroy:ds,remove:hs};function te(e,t,r,n,o){r===void 0&&(r=!1),n===void 0&&(n=!1),o===void 0&&(o=!1);var i=null;return Q.create({start:function(s){n?i=function(l){cn(l,n),s.next(l)}:i=function(l){s.next(l)},e.addEventListener(t,i,{capture:r,passive:o})},stop:function(){e.removeEventListener(t,i,r),i=null}})}function fn(e,t){for(var r=Object.keys(e),n=r.length,o=0;o<n;o++){var i=r[o];if(typeof e[i]=="object"&&typeof t[i]=="object"){if(!fn(e[i],t[i]))return!1}else if(e[i]!==t[i])return!1}return!0}function cn(e,t){if(t)if(typeof t=="boolean")e.preventDefault();else if(ms(t))t(e)&&e.preventDefault();else if(typeof t=="object")fn(t,e)&&e.preventDefault();else throw new Error("preventDefault has to be either a boolean, predicate function or object")}function ms(e){return typeof e=="function"}var gs=function(){function e(t){this._name=t}return e.prototype.select=function(t){return this},e.prototype.elements=function(){var t=H(S.of([document]));return t._isCycleSource=this._name,t},e.prototype.element=function(){var t=H(S.of(document));return t._isCycleSource=this._name,t},e.prototype.events=function(t,r,n){r===void 0&&(r={});var o;o=te(document,t,r.useCapture,r.preventDefault);var i=H(o);return i._isCycleSource=this._name,i},e}(),bs=function(){function e(t){this._name=t}return e.prototype.select=function(t){return this},e.prototype.elements=function(){var t=H(S.of([document.body]));return t._isCycleSource=this._name,t},e.prototype.element=function(){var t=H(S.of(document.body));return t._isCycleSource=this._name,t},e.prototype.events=function(t,r,n){r===void 0&&(r={});var o;o=te(document.body,t,r.useCapture,r.preventDefault);var i=H(o);return i._isCycleSource=this._name,i},e}();function _s(e){var t=1,r=11;return typeof HTMLElement=="object"?e instanceof HTMLElement||e instanceof DocumentFragment:e&&typeof e=="object"&&e!==null&&(e.nodeType===t||e.nodeType===r)&&typeof e.nodeName=="string"}function ws(e){return e.length>1&&(e[0]==="."||e[0]==="#")}function Ss(e){return e.nodeType===11}function Os(e){if(typeof e!="string"&&!_s(e))throw new Error("Given container is not a DOM element neither a selector string.")}function As(e){var t=typeof e=="string"?document.querySelector(e):e;if(typeof e=="string"&&t===null)throw new Error("Cannot render into unknown element `"+e+"`");return t}function ln(e){for(var t="",r=e.length-1;r>=0&&e[r].type==="selector";r--)t=e[r].scope+" "+t;return t.trim()}function Fe(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==t[r].type||e[r].scope!==t[r].scope)return!1;return!0}var pn=function(){function e(t,r){this.namespace=t,this.isolateModule=r,this._namespace=t.filter(function(n){return n.type!=="selector"})}return e.prototype.isDirectlyInScope=function(t){var r=this.isolateModule.getNamespace(t);if(!r||this._namespace.length>r.length||!Fe(this._namespace,r.slice(0,this._namespace.length)))return!1;for(var n=this._namespace.length;n<r.length;n++)if(r[n].type==="total")return!1;return!0},e}();function $s(e){return Array.prototype.slice.call(e)}var dn=function(){function e(t,r){this.namespace=t,this.isolateModule=r}return e.prototype.call=function(){var t=this.namespace,r=ln(t),n=new pn(t,this.isolateModule),o=this.isolateModule.getElement(t.filter(function(i){return i.type!=="selector"}));return o===void 0?[]:r===""?[o]:$s(o.querySelectorAll(r)).filter(n.isDirectlyInScope,n).concat(o.matches(r)?[o]:[])},e}(),kt=globalThis&&globalThis.__assign||function(){return kt=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},kt.apply(this,arguments)};function Es(e){return function(t,r){return r===":root"?t:t.map(function(n){if(!n)return n;var o=hn(r),i=kt({},n,{data:kt({},n.data,{isolate:!n.data||!Array.isArray(n.data.isolate)?e.concat([o]):n.data.isolate})});return kt({},i,{key:i.key!==void 0?i.key:JSON.stringify(i.data.isolate)})})}}function hn(e){return{type:ws(e)?"sibling":"total",scope:e}}var Ns=function(){function e(t,r,n,o,i,a){n===void 0&&(n=[]),this._rootElement$=t,this._sanitation$=r,this._namespace=n,this._isolateModule=o,this._eventDelegator=i,this._name=a,this.isolateSource=function(s,u){return new e(s._rootElement$,s._sanitation$,s._namespace.concat(hn(u)),s._isolateModule,s._eventDelegator,s._name)},this.isolateSink=Es(this._namespace)}return e.prototype._elements=function(){if(this._namespace.length===0)return this._rootElement$.map(function(r){return[r]});var t=new dn(this._namespace,this._isolateModule);return this._rootElement$.map(function(){return t.call()})},e.prototype.elements=function(){var t=H(this._elements().remember());return t._isCycleSource=this._name,t},e.prototype.element=function(){var t=H(this._elements().filter(function(r){return r.length>0}).map(function(r){return r[0]}).remember());return t._isCycleSource=this._name,t},Object.defineProperty(e.prototype,"namespace",{get:function(){return this._namespace},enumerable:!0,configurable:!0}),e.prototype.select=function(t){if(typeof t!="string")throw new Error("DOM driver's select() expects the argument to be a string as a CSS selector");if(t==="document")return new gs(this._name);if(t==="body")return new bs(this._name);var r=t===":root"?[]:this._namespace.concat({type:"selector",scope:t.trim()});return new e(this._rootElement$,this._sanitation$,r,this._isolateModule,this._eventDelegator,this._name)},e.prototype.events=function(t,r,n){if(r===void 0&&(r={}),typeof t!="string")throw new Error("DOM driver's events() expects argument to be a string representing the event type to listen for.");var o=this._eventDelegator.addEventListener(t,this._namespace,r,n),i=H(o);return i._isCycleSource=this._name,i},e.prototype.dispose=function(){this._sanitation$.shamefullySendNext(null)},e}(),Ot={},Ps=K&&K.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),o=0,t=0;t<r;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.SampleCombineOperator=Ot.SampleCombineListener=void 0;var Is=G,st={},vn=function(){function e(t,r){this.i=t,this.p=r,r.ils[t]=this}return e.prototype._n=function(t){var r=this.p;r.out!==st&&r.up(t,this.i)},e.prototype._e=function(t){this.p._e(t)},e.prototype._c=function(){this.p.down(this.i,this)},e}();Ot.SampleCombineListener=vn;var yn=function(){function e(t,r){this.type="sampleCombine",this.ins=t,this.others=r,this.out=st,this.ils=[],this.Nn=0,this.vals=[]}return e.prototype._start=function(t){this.out=t;for(var r=this.others,n=this.Nn=r.length,o=this.vals=new Array(n),i=0;i<n;i++)o[i]=st,r[i]._add(new vn(i,this));this.ins._add(this)},e.prototype._stop=function(){var t=this.others,r=t.length,n=this.ils;this.ins._remove(this);for(var o=0;o<r;o++)t[o]._remove(n[o]);this.out=st,this.vals=[],this.ils=[]},e.prototype._n=function(t){var r=this.out;r!==st&&(this.Nn>0||r._n(Ps([t],this.vals)))},e.prototype._e=function(t){var r=this.out;r!==st&&r._e(t)},e.prototype._c=function(){var t=this.out;t!==st&&t._c()},e.prototype.up=function(t,r){var n=this.vals[r];this.Nn>0&&n===st&&this.Nn--,this.vals[r]=t},e.prototype.down=function(t,r){this.others[t]._remove(r)},e}();Ot.SampleCombineOperator=yn;var mn;mn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return function(o){return new Is.Stream(new yn(o,t))}};var Cs=Ot.default=mn;globalThis&&globalThis.__assign;function gn(e){if(!e.sel)return{tagName:"",id:"",className:""};var t=e.sel,r=t.indexOf("#"),n=t.indexOf(".",r),o=r>0?r:t.length,i=n>0?n:t.length,a=r!==-1||n!==-1?t.slice(0,Math.min(o,i)):t,s=o<i?t.slice(o+1,i):void 0,u=n>0?t.slice(i+1).replace(/\./g," "):void 0;return{tagName:a,id:s,className:u}}function Ts(e){var t=gn(e).className,r=t===void 0?"":t;if(!e.data)return r;var n=e.data,o=n.class,i=n.props;if(o){var a=Object.keys(o).filter(function(s){return o[s]});r+=" "+a.join(" ")}return i&&i.className&&(r+=" "+i.className),r&&r.trim()}var Tt;typeof self!="undefined"?Tt=self:typeof window!="undefined"?Tt=window:typeof global!="undefined"?Tt=global:Tt=Function("return this")();var br=Tt.Symbol;typeof br=="function"&&br("parent");var Ds=function(){function e(t){this.rootElement=t}return e.prototype.call=function(t){if(Ss(this.rootElement))return this.wrapDocFrag(t===null?[]:[t]);if(t===null)return this.wrap([]);var r=gn(t),n=r.tagName,o=r.id,i=Ts(t),a=t.data||{},s=a.props||{},u=s.id,l=u===void 0?o:u,p=typeof l=="string"&&l.toUpperCase()===this.rootElement.id.toUpperCase()&&n.toUpperCase()===this.rootElement.tagName.toUpperCase()&&i.toUpperCase()===this.rootElement.className.toUpperCase();return p?t:this.wrap([t])},e.prototype.wrapDocFrag=function(t){return Z("",{isolate:[]},t,void 0,this.rootElement)},e.prototype.wrap=function(t){var r=this.rootElement,n=r.tagName,o=r.id,i=r.className,a=o?"#"+o:"",s=i?"."+i.split(" ").join("."):"",u=at(""+n.toLowerCase()+a+s,{},t);return u.data=u.data||{},u.data.isolate=u.data.isolate||[],u},e}(),ks=[ys,us,cs,ss,fs],bn=function(){function e(t){this.mapper=t,this.tree=[void 0,{}]}return e.prototype.set=function(t,r,n){for(var o=this.tree,i=n!==void 0?n:t.length,a=0;a<i;a++){var s=this.mapper(t[a]),u=o[1][s];u||(u=[void 0,{}],o[1][s]=u),o=u}o[0]=r},e.prototype.getDefault=function(t,r,n){return this.get(t,r,n)},e.prototype.get=function(t,r,n){for(var o=this.tree,i=n!==void 0?n:t.length,a=0;a<i;a++){var s=this.mapper(t[a]),u=o[1][s];if(!u)if(r)u=[void 0,{}],o[1][s]=u;else return;o=u}return r&&!o[0]&&(o[0]=r()),o[0]},e.prototype.delete=function(t){for(var r=this.tree,n=0;n<t.length-1;n++){var o=r[1][this.mapper(t[n])];if(!o)return;r=o}delete r[1][this.mapper(t[t.length-1])]},e}(),xs=function(){function e(){this.namespaceTree=new bn(function(t){return t.scope}),this.namespaceByElement=new Map,this.vnodesBeingRemoved=[]}return e.prototype.setEventDelegator=function(t){this.eventDelegator=t},e.prototype.insertElement=function(t,r){this.namespaceByElement.set(r,t),this.namespaceTree.set(t,r)},e.prototype.removeElement=function(t){this.namespaceByElement.delete(t);var r=this.getNamespace(t);r&&this.namespaceTree.delete(r)},e.prototype.getElement=function(t,r){return this.namespaceTree.get(t,void 0,r)},e.prototype.getRootElement=function(t){if(this.namespaceByElement.has(t))return t;for(var r=t;!this.namespaceByElement.has(r);)if(r=r.parentNode,r){if(r.tagName==="HTML")throw new Error("No root element found, this should not happen at all")}else return;return r},e.prototype.getNamespace=function(t){var r=this.getRootElement(t);if(!!r)return this.namespaceByElement.get(r)},e.prototype.createModule=function(){var t=this;return{create:function(r,n){var o=n.elm,i=n.data,a=i===void 0?{}:i,s=a.isolate;Array.isArray(s)&&t.insertElement(s,o)},update:function(r,n){var o=r.elm,i=r.data,a=i===void 0?{}:i,s=n.elm,u=n.data,l=u===void 0?{}:u,p=a.isolate,c=l.isolate;Fe(p,c)||Array.isArray(p)&&t.removeElement(o),Array.isArray(c)&&t.insertElement(c,s)},destroy:function(r){t.vnodesBeingRemoved.push(r)},remove:function(r,n){t.vnodesBeingRemoved.push(r),n()},post:function(){for(var r=t.vnodesBeingRemoved,n=r.length-1;n>=0;n--){var o=r[n],i=o.data!==void 0?o.data.isolation:void 0;i!==void 0&&t.removeElement(i),t.eventDelegator.removeElement(o.elm,i)}t.vnodesBeingRemoved=[]}}},e}(),Ms=function(){function e(){this.arr=[],this.prios=[]}return e.prototype.add=function(t,r){for(var n=0;n<this.arr.length;n++)if(this.prios[n]<r){this.arr.splice(n,0,t),this.prios.splice(n,0,r);return}this.arr.push(t),this.prios.push(r)},e.prototype.forEach=function(t){for(var r=0;r<this.arr.length;r++)t(this.arr[r],r,this.arr)},e.prototype.delete=function(t){for(var r=0;r<this.arr.length;r++)if(this.arr[r]===t){this.arr.splice(r,1),this.prios.splice(r,1);return}},e}(),ee=globalThis&&globalThis.__assign||function(){return ee=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},ee.apply(this,arguments)},js=["blur","canplay","canplaythrough","durationchange","emptied","ended","focus","load","loadeddata","loadedmetadata","mouseenter","mouseleave","pause","play","playing","ratechange","reset","scroll","seeked","seeking","stalled","submit","suspend","timeupdate","unload","volumechange","waiting"],Ls=function(){function e(t,r){var n=this;this.rootElement$=t,this.isolateModule=r,this.virtualListeners=new bn(function(o){return o.scope}),this.nonBubblingListenersToAdd=new Set,this.virtualNonBubblingListener=[],this.isolateModule.setEventDelegator(this),this.domListeners=new Map,this.domListenersToAdd=new Map,this.nonBubblingListeners=new Map,t.addListener({next:function(o){n.origin!==o&&(n.origin=o,n.resetEventListeners(),n.domListenersToAdd.forEach(function(i,a){return n.setupDOMListener(a,i)}),n.domListenersToAdd.clear()),n.nonBubblingListenersToAdd.forEach(function(i){n.setupNonBubblingListener(i)})}})}return e.prototype.addEventListener=function(t,r,n,o){var i=S.never(),a,s=new pn(r,this.isolateModule),u=o===void 0?js.indexOf(t)===-1:o;if(u)return this.domListeners.has(t)||this.setupDOMListener(t,!!n.passive),a=this.insertListener(i,s,t,n),i;var l=[];this.nonBubblingListenersToAdd.forEach(function(w){return l.push(w)});for(var p=void 0,c=0,h=l.length,g=function(w){w[0];var $=w[1],E=w[2];return w[3],t===$&&Fe(E.namespace,r)};!p&&c<h;){var f=l[c];p=g(f)?f:p,c++}var d=p,y;if(d){var A=d[0];y=A}else{var v=new dn(r,this.isolateModule);a=this.insertListener(i,s,t,n),d=[i,t,v,a],y=i,this.nonBubblingListenersToAdd.add(d),this.setupNonBubblingListener(d)}var b=this,_=null;return S.create({start:function(w){_=y.subscribe(w)},stop:function(){d[0];var w=d[1],$=d[2];d[3];var E=$.call();E.forEach(function(O){var N=O.subs;N&&N[w]&&(N[w].unsubscribe(),delete N[w])}),b.nonBubblingListenersToAdd.delete(d),_.unsubscribe()}})},e.prototype.removeElement=function(t,r){r!==void 0&&this.virtualListeners.delete(r);var n=[];this.nonBubblingListeners.forEach(function(a,s){if(a.has(t)){n.push([s,t]);var u=t.subs;u&&Object.keys(u).forEach(function(l){u[l].unsubscribe()})}});for(var o=0;o<n.length;o++){var i=this.nonBubblingListeners.get(n[o][0]);!i||(i.delete(n[o][1]),i.size===0?this.nonBubblingListeners.delete(n[o][0]):this.nonBubblingListeners.set(n[o][0],i))}},e.prototype.insertListener=function(t,r,n,o){var i=[],a=r._namespace,s=a.length;do i.push(this.getVirtualListeners(n,a,!0,s)),s--;while(s>=0&&a[s].type!=="total");for(var u=ee({},o,{scopeChecker:r,subject:t,bubbles:!!o.bubbles,useCapture:!!o.useCapture,passive:!!o.passive}),l=0;l<i.length;l++)i[l].add(u,a.length);return u},e.prototype.getVirtualListeners=function(t,r,n,o){n===void 0&&(n=!1);var i=o!==void 0?o:r.length;if(!n)for(var a=i-1;a>=0;a--){if(r[a].type==="total"){i=a+1;break}i=a}var s=this.virtualListeners.getDefault(r,function(){return new Map},i);return s.has(t)||s.set(t,new Ms),s.get(t)},e.prototype.setupDOMListener=function(t,r){var n=this;if(this.origin){var o=te(this.origin,t,!1,!1,r).subscribe({next:function(i){return n.onEvent(t,i,r)},error:function(){},complete:function(){}});this.domListeners.set(t,{sub:o,passive:r})}else this.domListenersToAdd.set(t,r)},e.prototype.setupNonBubblingListener=function(t){t[0];var r=t[1],n=t[2],o=t[3];if(!!this.origin){var i=n.call();if(i.length){var a=this;i.forEach(function(s){var u,l=s.subs;if(!l||!l[r]){var p=te(s,r,!1,!1,o.passive).subscribe({next:function(h){return a.onEvent(r,h,!!o.passive,!1)},error:function(){},complete:function(){}});a.nonBubblingListeners.has(r)||a.nonBubblingListeners.set(r,new Map);var c=a.nonBubblingListeners.get(r);if(!c)return;c.set(s,{sub:p,destination:o}),s.subs=ee({},l,(u={},u[r]=p,u))}})}}},e.prototype.resetEventListeners=function(){for(var t=this.domListeners.entries(),r=t.next();!r.done;){var n=r.value,o=n[0],i=n[1],a=i.sub,s=i.passive;a.unsubscribe(),this.setupDOMListener(o,s),r=t.next()}},e.prototype.putNonBubblingListener=function(t,r,n,o){var i=this.nonBubblingListeners.get(t);if(!!i){var a=i.get(r);a&&a.destination.passive===o&&a.destination.useCapture===n&&(this.virtualNonBubblingListener[0]=a.destination)}},e.prototype.onEvent=function(t,r,n,o){o===void 0&&(o=!0);var i=this.patchEvent(r),a=this.isolateModule.getRootElement(r.target);if(o){var s=this.isolateModule.getNamespace(r.target);if(!s)return;var u=this.getVirtualListeners(t,s);this.bubble(t,r.target,a,i,u,s,s.length-1,!0,n),this.bubble(t,r.target,a,i,u,s,s.length-1,!1,n)}else this.putNonBubblingListener(t,r.target,!0,n),this.doBubbleStep(t,r.target,a,i,this.virtualNonBubblingListener,!0,n),this.putNonBubblingListener(t,r.target,!1,n),this.doBubbleStep(t,r.target,a,i,this.virtualNonBubblingListener,!1,n),r.stopPropagation()},e.prototype.bubble=function(t,r,n,o,i,a,s,u,l){!u&&!o.propagationHasBeenStopped&&this.doBubbleStep(t,r,n,o,i,u,l);var p=n,c=s;if(r===n)if(s>=0&&a[s].type==="sibling")p=this.isolateModule.getElement(a,s),c--;else return;r.parentNode&&p&&this.bubble(t,r.parentNode,p,o,i,a,c,u,l),u&&!o.propagationHasBeenStopped&&this.doBubbleStep(t,r,n,o,i,u,l)},e.prototype.doBubbleStep=function(t,r,n,o,i,a,s){!n||(this.mutateEventCurrentTarget(o,r),i.forEach(function(u){if(u.passive===s&&u.useCapture===a){var l=ln(u.scopeChecker.namespace);!o.propagationHasBeenStopped&&u.scopeChecker.isDirectlyInScope(r)&&(l!==""&&r.matches(l)||l===""&&r===n)&&(cn(o,u.preventDefault),u.subject.shamefullySendNext(o))}}))},e.prototype.patchEvent=function(t){var r=t;r.propagationHasBeenStopped=!1;var n=r.stopPropagation;return r.stopPropagation=function(){n.call(this),this.propagationHasBeenStopped=!0},r},e.prototype.mutateEventCurrentTarget=function(t,r){try{Object.defineProperty(t,"currentTarget",{value:r,configurable:!0})}catch{console.log("please use event.ownerTarget")}t.ownerTarget=r},e}();function Fs(e){if(!Array.isArray(e))throw new Error("Optional modules option must be an array for snabbdom modules")}function Rs(e){if(!e||typeof e.addListener!="function"||typeof e.fold!="function")throw new Error("The DOM driver function expects as input a Stream of virtual DOM elements")}function Bs(e){return S.merge(e,S.never())}function Us(e){return e.elm}function Ws(e){(console.error||console.log)(e)}function qs(){return S.create({start:function(e){document.readyState==="loading"?document.addEventListener("readystatechange",function(){var t=document.readyState;(t==="interactive"||t==="complete")&&(e.next(null),e.complete())}):(e.next(null),e.complete())},stop:function(){}})}function Gs(e){return e.data=e.data||{},e.data.isolate=[],e}function zs(e,t){t===void 0&&(t={}),Os(e);var r=t.modules||ks;Fs(r);var n=new xs,o=t&&t.snabbdomOptions||void 0,i=ns([n.createModule()].concat(r),void 0,o),a=qs(),s,u,l=S.create({start:function(c){u=new MutationObserver(function(){return c.next(null)})},stop:function(){u.disconnect()}});function p(c,h){h===void 0&&(h="DOM"),Rs(c);var g=S.create(),f=a.map(function(){var b=As(e)||document.body;return s=new Ds(b),b}),d=c.remember();d.addListener({}),l.addListener({});var y=f.map(function(b){return S.merge(d.endWhen(g),g).map(function(_){return s.call(_)}).startWith(Gs(Ee(b))).fold(i,Ee(b)).drop(1).map(Us).startWith(b).map(function(_){return u.observe(_,{childList:!0,attributes:!0,characterData:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0}),_}).compose(Bs)}).flatten(),v=Zt(a,l).endWhen(g).compose(Cs(y)).map(function(b){return b[1]}).remember();v.addListener({error:t.reportSnabbdomError||Ws});var A=new Ls(v,n);return new Ns(v,g,[],n,A,h)}return p}function Hs(e){return typeof e=="string"&&e.length>0}function Vs(e){return Hs(e)&&(e[0]==="."||e[0]==="#")}function _n(e){return function(r,n,o){var i=typeof r!="undefined",a=typeof n!="undefined",s=typeof o!="undefined";return Vs(r)?a&&s?at(e+r,n,o):a?at(e+r,n):at(e+r,{}):s?at(e+r,n,o):a?at(e,r,n):i?at(e,r):at(e,{})}}var Ks=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","colorProfile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotlight","feTile","feTurbulence","filter","font","fontFace","fontFaceFormat","fontFaceName","fontFaceSrc","fontFaceUri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missingGlyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Js=_n("svg");Ks.forEach(function(e){Js[e]=_n(e)});var Ys=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","dd","del","details","dfn","dir","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","meta","nav","noscript","object","ol","optgroup","option","p","param","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","u","ul","video"];Ys.forEach(function(e){});function Xs(e){var t=new EventTarget;return e.subscribe({next:function(n){return t.dispatchEvent(new CustomEvent("data",{detail:n}))}}),{select:function(n){var o=!n,i=Array.isArray(n)?n:[n],a,s=S.create({start:function(l){a=function(c){var h=c.detail,g=h&&h.data||null;(o||i.includes(h.type))&&l.next(g)},t.addEventListener("data",a)},stop:function(l){return t.removeEventListener("data",a)}});return H(s)}}}function Zs(e){e.addListener({next:function(r){console.log(r)}})}function _r(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),r.push.apply(r,n)}return r}function wr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_r(Object(r),!0).forEach(function(n){Qs(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_r(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Qs(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tu(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.mountPoint,o=n===void 0?"#root":n,i=r.fragments,a=i===void 0?!0:i,s=Wi(e,"STATE"),u={EVENTS:Xs,DOM:zs(o,{snabbdomOptions:{experimental:{fragments:a}}}),LOG:Zs},l=wr(wr({},u),t);return xa(s,l)}function Sr(e,t){return nu(e)||ru(e,t)||wn(e,t)||eu()}function eu(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ru(e,t){var r=e==null?null:typeof Symbol!="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n=[],o=!0,i=!1,a,s;try{for(r=r.call(e);!(o=(a=r.next()).done)&&(n.push(a.value),!(t&&n.length===t));o=!0);}catch(u){i=!0,s=u}finally{try{!o&&r.return!=null&&r.return()}finally{if(i)throw s}}return n}}function nu(e){if(Array.isArray(e))return e}function Pe(e){return Pe=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(e)}function ye(e){return au(e)||iu(e)||wn(e)||ou()}function ou(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wn(e,t){if(!!e){if(typeof e=="string")return Ie(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ie(e,t)}}function iu(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function au(e){if(Array.isArray(e))return Ie(e)}function Ie(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function su(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(function(n,o){return typeof o=="string"&&!n.includes(o)?n.push.apply(n,ye(On(o))):Array.isArray(o)?n.push.apply(n,ye(uu(o))):Pe(o)==="object"&&n.push.apply(n,ye(fu(o))),n},[]).join(" ")}function Sn(e){return/^[a-zA-Z0-9-_]+$/.test(e)}function On(e){if(typeof e!="string")throw new Error("Class name must be a string");return e.trim().split(" ").reduce(function(t,r){if(r.trim().length===0)return t;if(!Sn(r))throw new Error("".concat(r," is not a valid CSS class name"));return t.push(r),t},[])}function uu(e){return e.map(On).flat()}function fu(e){var t=Object.entries(e).filter(function(r){var n=Sr(r,2);n[0];var o=n[1];return typeof o=="function"?o():!!o}).map(function(r){var n=Sr(r,2),o=n[0];n[1];var i=o.trim();if(!Sn(i))throw new Error("".concat(i," is not a valid CSS class name"));return i});return t}var An={};Object.defineProperty(An,"__esModule",{value:!0});var cu=G,lu=function(){function e(t,r){this.dt=t,this.ins=r,this.type="throttle",this.out=null,this.id=null}return e.prototype._start=function(t){this.out=t,this.ins._add(this)},e.prototype._stop=function(){this.ins._remove(this),this.out=null,this.id=null},e.prototype.clearInterval=function(){var t=this.id;t!==null&&clearInterval(t),this.id=null},e.prototype._n=function(t){var r=this,n=this.out;!n||this.id||(n._n(t),this.id=setInterval(function(){r.clearInterval()},this.dt))},e.prototype._e=function(t){var r=this.out;!r||(this.clearInterval(),r._e(t))},e.prototype._c=function(){var t=this.out;!t||(this.clearInterval(),t._c())},e}();function pu(e){return function(r){return new cu.Stream(new lu(e,r))}}An.default=pu;function Ce(e){return Ce=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ce(e)}var du=function(t){return t===void 0},hu=function(t){return typeof t=="number"},vu=function(t){return typeof t=="string"},$n=function(t){return vu(t)||hu(t)},yu=function(t){return Array.isArray(t)},mu=function(t){return Ce(t)==="object"&&t!==null},gu=function(t){return typeof t=="function"},bu=function(t){return mu(t)&&"sel"in t&&"data"in t&&"children"in t&&"text"in t},_u={svg:1,circle:1,ellipse:1,line:1,polygon:1,polyline:1,rect:1,g:1,path:1,text:1},wu=function(t){return t.sel in _u},Vt=Object.prototype.hasOwnProperty,En=Object.prototype.toString,Or=Object.defineProperty,Ar=Object.getOwnPropertyDescriptor,$r=function(t){return typeof Array.isArray=="function"?Array.isArray(t):En.call(t)==="[object Array]"},Er=function(t){if(!t||En.call(t)!=="[object Object]")return!1;var r=Vt.call(t,"constructor"),n=t.constructor&&t.constructor.prototype&&Vt.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!r&&!n)return!1;var o;for(o in t);return typeof o=="undefined"||Vt.call(t,o)},Nr=function(t,r){Or&&r.name==="__proto__"?Or(t,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):t[r.name]=r.newValue},Pr=function(t,r){if(r==="__proto__")if(Vt.call(t,r)){if(Ar)return Ar(t,r).value}else return;return t[r]},Nn=function e(){var t,r,n,o,i,a,s=arguments[0],u=1,l=arguments.length,p=!1;for(typeof s=="boolean"&&(p=s,s=arguments[1]||{},u=2),(s==null||typeof s!="object"&&typeof s!="function")&&(s={});u<l;++u)if(t=arguments[u],t!=null)for(r in t)n=Pr(s,r),o=Pr(t,r),s!==o&&(p&&o&&(Er(o)||(i=$r(o)))?(i?(i=!1,a=n&&$r(n)?n:[]):a=n&&Er(n)?n:{},Nr(s,{name:r,newValue:e(p,a,o)})):typeof o!="undefined"&&Nr(s,{name:r,newValue:o}));return s};function Kt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Te=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Nn.apply(void 0,[!0].concat(r))},Su=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Nn.apply(void 0,[!1].concat(r))},Ou=function e(t,r,n){for(var o=n,i=0;i<t.length;i++){var a=t[i];yu(a)?o=e(a,r,o):o=r(o,a)}return o},Re=function(t,r){return Object.keys(t).map(function(n){return r(n,t[n])}).reduce(function(n,o){return Te(n,o)},{})},Au=function(t,r){return Re(t,function(n,o){var i=n.indexOf("-");if(i>-1&&r[n.slice(0,i)]!==void 0){var a=Kt({},n.slice(i+1),o);return Kt({},n.slice(0,i),a)}return Kt({},n,o)})},Ir=function(t,r){return Re(r,function(n,o){return n!==t?Kt({},n,o):{}})};function qt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var $u=function(t){return $n(t)?{text:t,sel:void 0,data:void 0,children:void 0,elm:void 0,key:void 0}:void 0},Pn=function e(t){return wu(t)?Su(t,{data:Ir("props",Te(t.data,{ns:"http://www.w3.org/2000/svg",attrs:Ir("className",Te(t.data.props,{class:t.data.props?t.data.props.className:void 0}))}))},{children:du(t.children)?void 0:t.children.map(function(r){return e(r)})}):t},lt={for:"attrs",role:"attrs",tabindex:"attrs","aria-*":"attrs",key:null},Eu=function(t,r){return Re(t,function(n,o){var i=qt({},n,o);if(lt[n]&&r[lt[n]]!==void 0)return qt({},lt[n],i);if(lt[n]===null)return{};for(var a=Object.keys(lt),s=0;s<a.length;s++){var u=a[s];if(u.charAt(u.length-1)==="*"&&n.indexOf(u.slice(0,-1))===0&&r[lt[u]]!==void 0)return qt({},lt[u],i)}return r[n]!==void 0?qt({},r[n]?r[n]:n,o):r.props!==void 0?{props:i}:i})},Nu=function(t,r){return Pn(Eu(Au(t,r),r))},Pu=function(t){return t.length>1||!$n(t[0])?void 0:t[0].toString()},Iu=function(t){return Ou(t,function(r,n){var o=bu(n)?n:$u(n);return r.push(o),r},[])},Cu={attrs:"",props:"",class:"",data:"dataset",style:"",hook:"",on:""},Tu=function(t){return function(r,n){typeof r=="undefined"&&(r="UNDEFINED",cnosole.error("JSX Error: Capitalized HTML element without corresponding Sygnal factory.  Components with names where the first letter is capital MUST be defined or included at the parent component's file scope."));for(var o=arguments.length,i=new Array(o>2?o-2:0),a=2;a<o;a++)i[a-2]=arguments[a];if(gu(r)){if(r.name==="Fragment")return r(n||{},i);var s=r;r=r.name||"sygnal-factory",n||(n={}),n.sygnalFactory=s}var u=Pu(i);return Pn({sel:r,data:n?Nu(n,t):{},children:typeof u!="undefined"?void 0:Iu(i),text:u,elm:void 0,key:n?n.key:void 0})}},W=Tu(Cu);let Du=0;function ku(e){const t=new Array(16).fill().map((l,p)=>p),r=e.filter(l=>!l.deleted).map(l=>l.row*4+l.column),n=t.filter(l=>!r.includes(l));if(n.length===0)return e;const o=Math.floor(Math.random()*n.length),i=n[o],a=i%4,s=Math.floor(i/4),u=Math.ceil(Math.random()*1e3)<900?2:4;return[...e,{id:Du++,value:u,row:s,column:a,new:!0}]}function De(e,t){let r,n,o,i,a;t=="UP"||t=="DOWN"?(r="column",n="row"):(r="row",n="column"),t=="UP"||t=="LEFT"?(o=0,i=3,a=1):(o=3,i=0,a=-1);const s=e.filter(p=>!p.deleted),u=[];let l=!1;for(let p=0;p<=3;p++){let c=null,h=o;for(let g=o;a==1?g<=i:g>=i;g+=a){const f=s.find(d=>d[r]===p&&d[n]===g);if(f){const d=f[n];if(f[n]=h,c!==null&&!c.merged&&f.value===c.value){const v=f.value*2;f.value=v,c.value=v,f[n]-=a,f.merged=!0,l=!0}else l=l||h!==d,h+=a;const y={id:f.id,value:f.value,row:f.row,column:f.column,merged:f.merged};c=y,u.push(y)}}}if(l){const p=e.map(c=>u.find(h=>h.id===c.id)||c);return p.forEach(c=>{c.deleted=c.deleted||c.merged,delete c.merged}),p}return!1}function xu(e){const t=e.map(o=>vt({},o));let r=De(t,"UP"),n=De(t,"LEFT");return!(!r&&!n)}const Cr=100;var Mu=en({name:"TILE",model:{DELETE:e=>{}},intent:({STATE:e})=>({DELETE:e.stream.filter(n=>n.deleted&&!n.hidden).compose(Se(Cr))}),view:({state:e})=>{const{id:t,value:r,row:n,column:o,hidden:i,deleted:a}=e,s=su("tile",`tile-${t}`,{new:!!e.new}),u=Math.log2(e.value||0),l=Math.floor(50*u/11+30),p={"--row":`       ${n}`,"--col":`       ${o}`,"--tile-color":`${l}%`,"--duration":`${Cr}ms`,zIndex:a?10:1,display:i?"none":"inherit"};return W("div",{className:s,id:`tile-${t}`,style:p},r)}});const ju="ArrowUp",Lu="ArrowDown",Fu="ArrowLeft",Ru="ArrowRight",Bu=120,Tr={tiles:[],over:!1,max:2,score:0,locked:!1};var Uu=en({name:"BOARD",initialState:Tr,calculated:{max:e=>e.tiles.filter(t=>t&&!t.deleted).reduce((t,r)=>t>r.value?t:r.value,0),lost:e=>!e.over&&e.tiles.filter(t=>!t.deleted).length===16&&!xu(e.tiles)},model:{RESTART:(e,t,r)=>(r("ADD_TILE"),r("ADD_TILE"),vt({},Tr)),MOVE:(e,t,r)=>{if(e.locked||e.over)return Qt;const n=De(e.tiles,t);if(!n)return Qt;const o=n.filter(i=>i.deleted).reduce((i,a)=>i+a.value,0);return setTimeout(i=>{r("ADD_TILE")},Bu),Ft(vt({},e),{tiles:n,score:e.score+o,locked:!0})},ADD_TILE:(e,t)=>{const r=ku(e.tiles);return Ft(vt({},e),{tiles:r,locked:!1})},GAME_OVER:(e,t)=>Ft(vt({},e),{over:!0,won:t})},intent:({STATE:e,DOM:t})=>{const r=t.select("document").events("keydown").map(f=>f.key),n=f=>d=>d===f,o=r.filter(n(ju)).mapTo("UP"),i=r.filter(n(Lu)).mapTo("DOWN"),a=r.filter(n(Fu)).mapTo("LEFT"),s=r.filter(n(Ru)).mapTo("RIGHT"),u=S.merge(o,i,a,s),l=e.stream.filter(f=>!f.over&&f.max===2048).mapTo(!0),p=e.stream.filter(f=>f.lost===!0).mapTo(!1),c=S.merge(l,p),h=t.select(".restart, .gameover").events("click"),g=S.fromArray([1,2]);return{RESTART:h,GAME_OVER:c,MOVE:u,ADD_TILE:g}},view:({state:e,tiles:t})=>{const{score:r,max:n,over:o,won:i}=e;return W("div",{className:"container"},W("h1",null,"Sygnal 2048"),W("div",{className:"info"},W("div",{className:"largest"},"Largest: ",n),W("div",{className:"score"},"Score: ",r)),W("div",{className:"board-container"},W("div",{className:"slot-board"},Array(16).fill().map(a=>W("div",{className:"slot"}))),W("collection",{of:Mu,for:"tiles",className:"tile-board"}),o&&i&&W("div",{className:"gameover won"},W("span",{className:"won-message"},"YOU WON!!")),o&&!i&&W("div",{className:"gameover lost"},W("span",{className:"lost-message"},"GAME OVER"))),W("div",{className:"restart-container"},W("input",{type:"button",className:"restart",value:"Start Over"})))}});tu(Uu);
